"use strict";(self.webpackChunkapp=self.webpackChunkapp||[]).push([[4999],{4999:(S,f,r)=>{r.r(f),r.d(f,{HomePageModule:()=>N});var _=r(6814),l=r(7027),h=r(95),v=r(4482),e=r(6689),x=r(5861);let y=(()=>{var t;class o{constructor(){this.isConnected=!0,this.isMatched=!1,this.UserColor="abcdef",this.CurrentConnected=0,this.messages=[{system:"\uc11c\ubc84\uc5d0 \uc5f0\uacb0\uc911\uc785\ub2c8\ub2e4.."}],this.last_message={}}get_address(){var s=this;return(0,x.Z)(function*(){try{let c=yield(yield fetch("https://is2you2.github.io/assets/data/WSAddress.txt")).blob();s.SocketServerAddress=yield c.text(),s.ConnectToServer()}catch{s.isConnected=!1,s.isMatched=!0}})()}ConnectToServer(){var s=this;try{this.client=new WebSocket(`wss://${this.SocketServerAddress}:12011`),this.client.onopen=()=>{this.last_message={text:"\uc0c8\ub85c\uc6b4 \ub300\ud654 \uc0c1\ub300\ub97c \ucc3e\uc2b5\ub2c8\ub2e4..."},this.messages.push({system:"\uc0c8\ub85c\uc6b4 \ub300\ud654 \uc0c1\ub300\ub97c \ucc3e\uc2b5\ub2c8\ub2e4..."}),this.UserColor="";for(let c=0;c<6;c++)this.UserColor+="6789abc".charAt(Math.floor(7*Math.random()))},this.client.onmessage=function(){var n=(0,x.Z)(function*(c){try{let d=yield c.data.text();try{let a=JSON.parse(d);if("number"==typeof a)throw"Received PeerId";a.target=a.pid==s.pid?"\ub098: ":"\uc0c1\ub300\ubc29: ",s.last_message=a;let g=a.text.indexOf("http://");if(g<0&&(g=a.text.indexOf("https://")),g>=0){let C=a.text.substring(0,g),p=a.text.substring(g),m=p.indexOf(" "),b=p.substring(0,m),T=p.substring(m);a.text=[],C&&a.text.push({text:C}),b&&a.text.push({text:b,href:!0}),T&&a.text.push({text:T,href:-1==m})}else a.text=[{text:a.text}];s.messages.push(a),s.Received_CallBack&&s.Received_CallBack()}catch{if(0==d.indexOf("Current"))s.CurrentConnected=Number(d.split(":")[1]);else switch(d){case"GOT_MATCHED":s.isMatched=!0,s.last_message={text:"\uc784\uc758\uc758 \uc0ac\ub78c\uacfc \uc5f0\uacb0\ub418\uc5c8\uc2b5\ub2c8\ub2e4"},s.messages=[{system:"\uc784\uc758\uc758 \uc0ac\ub78c\uacfc \uc5f0\uacb0\ub418\uc5c8\uc2b5\ub2c8\ub2e4"}],s.Received_CallBack&&s.Received_CallBack();break;case"PARTNER_OUT":s.last_message={text:"\ub300\ud654\uac00 \uc885\ub8cc\ub418\uc5c8\uc2b5\ub2c8\ub2e4"},s.messages.push({system:"\ub300\ud654\uac00 \uc885\ub8cc\ub418\uc5c8\uc2b5\ub2c8\ub2e4"}),s.Received_CallBack&&s.Received_CallBack();break;default:s.pid=d}}}catch(u){console.log("\uba54\uc2dc\uc9c0 \ubc1b\uae30 \ubc0f \ucc98\ub9ac \uc624\ub958: ",u)}});return function(c){return n.apply(this,arguments)}}(),this.client.onclose=()=>{this.isConnected=!1,this.isMatched=!1}}catch(n){console.log("\uc5f0\uacb0 \uc2e4\ud328: ",n),this.isConnected=!1,this.isMatched=!1}}RequestRegrouping(){try{this.client.send("REQ_REGROUPING"),this.last_message={text:"\uc0c8\ub85c\uc6b4 \ub300\ud654 \uc0c1\ub300\ub97c \ucc3e\uc2b5\ub2c8\ub2e4..."},this.messages.push({system:"\uc0c8\ub85c\uc6b4 \ub300\ud654 \uc0c1\ub300\ub97c \ucc3e\uc2b5\ub2c8\ub2e4..."}),this.Received_CallBack&&this.Received_CallBack(),this.isMatched=!1}catch(s){console.log("\ub9e4\uce6d \uc694\uccad \ubc1c\uc1a1 \uc624\ub958: ",s),this.isConnected=!1,this.isMatched=!1,this.last_message={text:"\ub9e4\uce6d \uc694\uccad\uc744 \ubc1c\uc1a1\ud558\uc9c0 \ubabb\ud588\uc2b5\ub2c8\ub2e4"},this.messages.push({system:"\ub9e4\uce6d \uc694\uccad\uc744 \ubc1c\uc1a1\ud558\uc9c0 \ubabb\ud588\uc2b5\ub2c8\ub2e4"}),this.Received_CallBack&&this.Received_CallBack()}}send(s){try{this.client.send(s)}catch(n){console.log("\uba54\uc2dc\uc9c0 \ubc1c\uc1a1 \uc624\ub958: ",n),this.isConnected=!1,this.isMatched=!1}}}return(t=o).\u0275fac=function(s){return new(s||t)},t.\u0275prov=e.Yz7({token:t,factory:t.\u0275fac,providedIn:"root"}),o})();const k=["input_message"];function Z(t,o){1&t&&(e.TgZ(0,"div",14)(1,"div",15),e._UZ(2,"ion-icon",16),e.TgZ(3,"div")(4,"ion-label",17),e._uU(5,"\uc11c\ubc84 \uc5f0\uacb0 \ub04a\uae40"),e.qZA()()()())}function H(t,o){if(1&t&&(e.TgZ(0,"span",21)(1,"b"),e._uU(2),e.qZA()()),2&t){const i=e.oxw().$implicit;e.Akn("color: #"+i.color),e.xp6(2),e.Oqu(i.target)}}function P(t,o){if(1&t&&(e.TgZ(0,"span",25),e._uU(1),e.qZA()),2&t){const i=e.oxw().$implicit;e.xp6(1),e.Oqu(i.system)}}function w(t,o){if(1&t&&(e.TgZ(0,"span"),e._uU(1),e.qZA()),2&t){const i=e.oxw().$implicit;e.xp6(1),e.Oqu(i.text)}}function M(t,o){if(1&t&&(e.TgZ(0,"a",27),e._uU(1),e.qZA()),2&t){const i=e.oxw().$implicit;e.Q6J("href",i.text,e.LSH),e.xp6(1),e.Oqu(i.text)}}function A(t,o){if(1&t&&(e.TgZ(0,"span",21),e.YNc(1,w,2,1,"span",24),e.YNc(2,M,2,2,"a",26),e.qZA()),2&t){const i=o.$implicit;e.xp6(1),e.Q6J("ngIf",!i.href),e.xp6(1),e.Q6J("ngIf",i.href)}}function R(t,o){if(1&t&&(e.TgZ(0,"span"),e.YNc(1,A,3,2,"span",20),e.qZA()),2&t){const i=e.oxw().$implicit;e.xp6(1),e.Q6J("ngForOf",i.text)}}function O(t,o){if(1&t&&(e.TgZ(0,"div",21),e.YNc(1,H,3,3,"span",22),e.YNc(2,P,2,1,"span",23),e.YNc(3,R,2,1,"span",24),e.qZA()),2&t){const i=o.$implicit;e.xp6(1),e.Q6J("ngIf",i.target),e.xp6(1),e.Q6J("ngIf",i.system),e.xp6(1),e.Q6J("ngIf",i.text)}}function B(t,o){if(1&t&&(e.TgZ(0,"div",18)(1,"div",19),e.YNc(2,O,4,3,"div",20),e.qZA()()),2&t){const i=e.oxw();e.xp6(2),e.Q6J("ngForOf",i.client.messages)}}function J(t,o){if(1&t&&(e.TgZ(0,"span")(1,"b"),e._uU(2),e.qZA()()),2&t){const i=e.oxw(2);e.Akn("color: #"+i.client.last_message.color),e.xp6(2),e.Oqu(i.client.last_message.target)}}function I(t,o){if(1&t){const i=e.EpF();e.TgZ(0,"div",28),e.NdJ("click",function(){e.CHM(i);const n=e.oxw();return e.KtG(n.clickMessageThumbnail())}),e.YNc(1,J,3,3,"span",29),e.TgZ(2,"span"),e._uU(3),e.qZA()()}if(2&t){const i=e.oxw();e.xp6(1),e.Q6J("ngIf",i.client.last_message.target),e.xp6(2),e.Oqu(i.client.last_message.text)}}const Q=[{path:"",component:(()=>{var t;class o{constructor(s){this.client=s,this.show_last_message_thumbnail=!1}ionViewDidEnter(){this.client.get_address(),this.ContentsDiv=document.getElementById("contents"),this.client.Received_CallBack=()=>{setTimeout(()=>{this.ContentsDiv.scrollHeight<this.ContentsDiv.scrollTop+this.ContentsDiv.clientHeight+120?this.ContentsDiv.scrollTo({behavior:"smooth",top:this.ContentsDiv.scrollHeight}):this.show_last_message_thumbnail=!0},0)}}RequestOrReconnect(){try{this.client.RequestRegrouping(),this.client.Received_CallBack&&this.client.Received_CallBack()}catch{this.client.ConnectToServer()}}clickMessageThumbnail(){this.ContentsDiv.scrollTo({behavior:"smooth",top:this.ContentsDiv.scrollHeight}),this.show_last_message_thumbnail=!1,this.input_message.setFocus()}send_message(){let s=this.userInput.trim();s&&this.client.isMatched&&this.client.send(JSON.stringify({pid:this.client.pid,color:this.client.UserColor,text:s})),setTimeout(()=>{this.userInput=""},0),this.input_message.setFocus()}}return(t=o).\u0275fac=function(s){return new(s||t)(e.Y36(y))},t.\u0275cmp=e.Xpm({type:t,selectors:[["app-home"]],viewQuery:function(s,n){if(1&s&&e.Gf(k,5),2&s){let c;e.iGM(c=e.CRH())&&(n.input_message=c.first)}},decls:22,vars:10,consts:[[3,"translucent"],["slot","end"],[3,"fullscreen"],["class","disconnected",4,"ngIf"],["id","contents","style","height: 100%; position: relative; overflow-y: scroll;",4,"ngIf"],["class","new_message",3,"click",4,"ngIf"],["id","input_table",2,"width","100%"],["fill","clear",1,"ion-text-center",3,"disabled","click"],["name","refresh-outline"],[2,"width","100%","vertical-align","bottom"],["type","text","placeholder","\uba54\uc2dc\uc9c0 \uc785\ub825...",3,"disabled","ngModel","keyup.enter","ngModelChange"],["input_message",""],["fill","clear","expand","block",3,"disabled","click"],["name","send"],[1,"disconnected"],[1,"disconnect_info"],["color","medium","name","chatbubble-ellipses-outline",2,"width","60px","height","60px"],["color","medium"],["id","contents",2,"height","100%","position","relative","overflow-y","scroll"],[1,"full_screen"],["class","line_height",4,"ngFor","ngForOf"],[1,"line_height"],["class","line_height",3,"style",4,"ngIf"],["style","color: gray;","class","line_height",4,"ngIf"],[4,"ngIf"],[1,"line_height",2,"color","gray"],["target","_system",3,"href",4,"ngIf"],["target","_system",3,"href"],[1,"new_message",3,"click"],[3,"style",4,"ngIf"]],template:function(s,n){1&s&&(e.TgZ(0,"ion-header",0)(1,"ion-toolbar")(2,"ion-title"),e._uU(3," \ub79c\ub364\ucc44\ud305 "),e.qZA(),e.TgZ(4,"ion-title",1),e._uU(5),e.qZA()()(),e.TgZ(6,"ion-content",2),e.YNc(7,Z,6,0,"div",3),e.YNc(8,B,3,1,"div",4),e.qZA(),e.TgZ(9,"ion-footer"),e.YNc(10,I,4,2,"div",5),e.TgZ(11,"table",6)(12,"tr")(13,"td")(14,"ion-button",7),e.NdJ("click",function(){return n.RequestOrReconnect()}),e._UZ(15,"ion-icon",8),e.qZA()(),e.TgZ(16,"td",9)(17,"ion-input",10,11),e.NdJ("keyup.enter",function(){return n.send_message()})("ngModelChange",function(u){return n.userInput=u}),e.qZA()(),e.TgZ(19,"td")(20,"ion-button",12),e.NdJ("click",function(){return n.send_message()}),e._UZ(21,"ion-icon",13),e.qZA()()()()()),2&s&&(e.Q6J("translucent",!0),e.xp6(5),e.hij(" ","\ub3d9\uc2dc \uc811\uc18d: "+n.client.CurrentConnected+"\uba85"," "),e.xp6(1),e.Q6J("fullscreen",!0),e.xp6(1),e.Q6J("ngIf",!n.client.isConnected),e.xp6(1),e.Q6J("ngIf",n.client.isConnected),e.xp6(2),e.Q6J("ngIf",n.show_last_message_thumbnail),e.xp6(4),e.Q6J("disabled",!n.client.isConnected||!n.client.isMatched),e.xp6(3),e.Q6J("disabled",!n.client.isConnected)("ngModel",n.userInput),e.xp6(3),e.Q6J("disabled",!n.client.isConnected||!n.client.isMatched))},dependencies:[_.sg,_.O5,h.JJ,h.On,l.YG,l.W2,l.fr,l.Gu,l.gu,l.pK,l.Q$,l.wd,l.sr,l.j9],styles:[".disconnected[_ngcontent-%COMP%]{width:100%;height:100%}.disconnect_info[_ngcontent-%COMP%]{text-align:center;position:absolute;top:50%;left:50%;transform:translate(-50%) translateY(-50%)}.full_screen[_ngcontent-%COMP%]{width:100%;max-height:100%;padding:16px;position:absolute;bottom:0}.line_height[_ngcontent-%COMP%]{padding-bottom:8px}.TextAreaInput[_ngcontent-%COMP%]{width:100%;height:36px;max-height:156px;resize:none;padding:6px;margin-top:5px;border:0;overflow:hidden;background-color:var(--chatroom-input-background)}.new_message[_ngcontent-%COMP%]{width:100%;height:-moz-fit-content;height:fit-content;background-color:var(--text-thumbnail-background);position:absolute;transform:translateY(-100%);vertical-align:middle;padding:8px}"]}),o})()}];let q=(()=>{var t;class o{}return(t=o).\u0275fac=function(s){return new(s||t)},t.\u0275mod=e.oAB({type:t}),t.\u0275inj=e.cJS({imports:[v.Bz.forChild(Q),v.Bz]}),o})(),N=(()=>{var t;class o{}return(t=o).\u0275fac=function(s){return new(s||t)},t.\u0275mod=e.oAB({type:t}),t.\u0275inj=e.cJS({imports:[_.ez,h.u5,l.Pc,q]}),o})()}}]);