"use strict";(self.webpackChunkapp=self.webpackChunkapp||[]).push([[8975],{8975:(S,m,g)=>{g.r(m),g.d(m,{HomePageModule:()=>Q});var u=g(6814),r=g(7027),_=g(95),v=g(4482),e=g(6689),x=g(5861);let b=(()=>{var t;class a{constructor(i){this.platform=i,this.WebNoties={}}initialize(){"Notification"in window||console.error("Notification \ubbf8\uc9c0\uc6d0 \ube0c\ub77c\uc6b0\uc800\uc785\ub2c8\ub2e4"),Notification.requestPermission().then(i=>{"granted"!=i&&console.log("\uc54c\ub9bc \uac70\uc808",i)},i=>{console.error("\uc9c0\uc6d0\ud558\uc9c0 \uc54a\ub294 \ube0c\ub77c\uc6b0\uc800:",i)})}PushLocal(i){let n;if(n=this.platform.is("desktop")?"DesktopPWA":"MobilePWA","DesktopPWA"==n||"MobilePWA"==n){if(document.hasFocus())return;const c={badge:i.badge,body:i.body,icon:"assets/icon/favicon.png",lang:i.lang};let d=(new Date).getTime();"DesktopPWA"==n?(this.WebNoties[`${d}`]=new Notification("Project: \ub79c\ub364\ucc44\ud305",{...c}),this.WebNoties[`${d}`].onclick=()=>{window.focus();let l=Object.keys(this.WebNoties);for(let o=0,h=l.length;o<h;o++)this.WebNoties[l[o]].close(),delete this.WebNoties[l[o]]}):window.swReg&&window.swReg.active&&(this.WebNoties[`${d}`]=window.swReg.showNotification("Project: \ub79c\ub364\ucc44\ud305",{...c}),this.WebNoties[`${d}`].onclick=()=>{window.focus();let l=Object.keys(this.WebNoties);for(let o=0,h=l.length;o<h;o++)this.WebNoties[l[o]].close(),delete this.WebNoties[l[o]]})}}}return(t=a).\u0275fac=function(i){return new(i||t)(e.LFG(r.t4))},t.\u0275prov=e.Yz7({token:t,factory:t.\u0275fac,providedIn:"root"}),a})(),P=(()=>{var t;class a{constructor(i){this.noti=i,this.isConnected=!0,this.isMatched=!1,this.UserColor="abcdef",this.CurrentConnected=0,this.messages=[{system:"\uc11c\ubc84\uc5d0 \uc5f0\uacb0\uc911\uc785\ub2c8\ub2e4.."}],this.last_message={}}get_address(){var i=this;return(0,x.Z)(function*(){try{let c=yield(yield fetch("https://is2you2.github.io/assets/data/WSAddress.txt")).blob();i.SocketServerAddress=yield c.text(),i.ConnectToServer()}catch{i.isConnected=!1,i.isMatched=!0}})()}ConnectToServer(){var i=this;try{this.client=new WebSocket(`wss://${this.SocketServerAddress}:12011`),this.client.onopen=()=>{this.last_message={text:"\uc0c8\ub85c\uc6b4 \ub300\ud654 \uc0c1\ub300\ub97c \ucc3e\uc2b5\ub2c8\ub2e4..."},this.noti.PushLocal({body:"\uc0c8\ub85c\uc6b4 \ub300\ud654 \uc0c1\ub300\ub97c \ucc3e\uc2b5\ub2c8\ub2e4..."}),this.messages.push({system:"\uc0c8\ub85c\uc6b4 \ub300\ud654 \uc0c1\ub300\ub97c \ucc3e\uc2b5\ub2c8\ub2e4..."}),this.UserColor="";for(let c=0;c<6;c++)this.UserColor+="6789abc".charAt(Math.floor(7*Math.random()))},this.client.onmessage=function(){var n=(0,x.Z)(function*(c){try{let l=yield c.data.text();try{let o=JSON.parse(l);if("number"==typeof o)throw"Received PeerId";o.target=o.pid==i.pid?"\ub098: ":"\uc0c1\ub300\ubc29: ",i.last_message=o,i.noti.PushLocal({body:"\uc0c1\ub300\ubc29: "+o.text});let h=o.text.indexOf("http://");if(h<0&&(h=o.text.indexOf("https://")),h>=0){let C=o.text.substring(0,h),p=o.text.substring(h),f=p.indexOf(" "),y=p.substring(0,f),w=p.substring(f);o.text=[],C&&o.text.push({text:C}),y&&o.text.push({text:y,href:!0}),w&&o.text.push({text:w,href:-1==f})}else o.text=[{text:o.text}];i.messages.push(o),i.Received_CallBack&&i.Received_CallBack()}catch{if(0==l.indexOf("Current"))i.CurrentConnected=Number(l.split(":")[1]);else switch(l){case"GOT_MATCHED":i.isMatched=!0,i.last_message={text:"\uc784\uc758\uc758 \uc0ac\ub78c\uacfc \uc5f0\uacb0\ub418\uc5c8\uc2b5\ub2c8\ub2e4"},i.noti.PushLocal({body:"\uc784\uc758\uc758 \uc0ac\ub78c\uacfc \uc5f0\uacb0\ub418\uc5c8\uc2b5\ub2c8\ub2e4"}),i.messages=[{system:"\uc784\uc758\uc758 \uc0ac\ub78c\uacfc \uc5f0\uacb0\ub418\uc5c8\uc2b5\ub2c8\ub2e4"}],i.Received_CallBack&&i.Received_CallBack();break;case"PARTNER_OUT":i.last_message={text:"\ub300\ud654\uac00 \uc885\ub8cc\ub418\uc5c8\uc2b5\ub2c8\ub2e4"},i.noti.PushLocal({body:"\ub300\ud654\uac00 \uc885\ub8cc\ub418\uc5c8\uc2b5\ub2c8\ub2e4"}),i.messages.push({system:"\ub300\ud654\uac00 \uc885\ub8cc\ub418\uc5c8\uc2b5\ub2c8\ub2e4"}),i.Received_CallBack&&i.Received_CallBack();break;default:i.pid=l}}}catch(d){console.log("\uba54\uc2dc\uc9c0 \ubc1b\uae30 \ubc0f \ucc98\ub9ac \uc624\ub958: ",d)}});return function(c){return n.apply(this,arguments)}}(),this.client.onclose=()=>{this.isConnected=!1,this.isMatched=!1}}catch(n){console.log("\uc5f0\uacb0 \uc2e4\ud328: ",n),this.isConnected=!1,this.isMatched=!1}}RequestRegrouping(){try{this.client.send("REQ_REGROUPING"),this.last_message={text:"\uc0c8\ub85c\uc6b4 \ub300\ud654 \uc0c1\ub300\ub97c \ucc3e\uc2b5\ub2c8\ub2e4..."},this.noti.PushLocal({body:"\uc0c8\ub85c\uc6b4 \ub300\ud654 \uc0c1\ub300\ub97c \ucc3e\uc2b5\ub2c8\ub2e4..."}),this.messages.push({system:"\uc0c8\ub85c\uc6b4 \ub300\ud654 \uc0c1\ub300\ub97c \ucc3e\uc2b5\ub2c8\ub2e4..."}),this.Received_CallBack&&this.Received_CallBack(),this.isMatched=!1}catch(i){console.log("\ub9e4\uce6d \uc694\uccad \ubc1c\uc1a1 \uc624\ub958: ",i),this.isConnected=!1,this.isMatched=!1,this.last_message={text:"\ub9e4\uce6d \uc694\uccad\uc744 \ubc1c\uc1a1\ud558\uc9c0 \ubabb\ud588\uc2b5\ub2c8\ub2e4"},this.noti.PushLocal({body:"\ub9e4\uce6d \uc694\uccad\uc744 \ubc1c\uc1a1\ud558\uc9c0 \ubabb\ud588\uc2b5\ub2c8\ub2e4"}),this.messages.push({system:"\ub9e4\uce6d \uc694\uccad\uc744 \ubc1c\uc1a1\ud558\uc9c0 \ubabb\ud588\uc2b5\ub2c8\ub2e4"}),this.Received_CallBack&&this.Received_CallBack()}}send(i){try{this.client.send(i)}catch(n){console.log("\uba54\uc2dc\uc9c0 \ubc1c\uc1a1 \uc624\ub958: ",n),this.isConnected=!1,this.isMatched=!1}}}return(t=a).\u0275fac=function(i){return new(i||t)(e.LFG(b))},t.\u0275prov=e.Yz7({token:t,factory:t.\u0275fac,providedIn:"root"}),a})();const T=["input_message"];function k(t,a){1&t&&(e.TgZ(0,"div",14)(1,"div",15),e._UZ(2,"ion-icon",16),e.TgZ(3,"div")(4,"ion-label",17),e._uU(5,"\uc11c\ubc84 \uc5f0\uacb0 \ub04a\uae40"),e.qZA()()()())}function Z(t,a){if(1&t&&(e.TgZ(0,"span",21)(1,"b"),e._uU(2),e.qZA()()),2&t){const s=e.oxw().$implicit;e.Akn("color: #"+s.color),e.xp6(2),e.Oqu(s.target)}}function H(t,a){if(1&t&&(e.TgZ(0,"span",25),e._uU(1),e.qZA()),2&t){const s=e.oxw().$implicit;e.xp6(1),e.Oqu(s.system)}}function A(t,a){if(1&t&&(e.TgZ(0,"span"),e._uU(1),e.qZA()),2&t){const s=e.oxw().$implicit;e.xp6(1),e.Oqu(s.text)}}function N(t,a){if(1&t&&(e.TgZ(0,"a",27),e._uU(1),e.qZA()),2&t){const s=e.oxw().$implicit;e.Q6J("href",s.text,e.LSH),e.xp6(1),e.Oqu(s.text)}}function M(t,a){if(1&t&&(e.TgZ(0,"span",21),e.YNc(1,A,2,1,"span",24),e.YNc(2,N,2,2,"a",26),e.qZA()),2&t){const s=a.$implicit;e.xp6(1),e.Q6J("ngIf",!s.href),e.xp6(1),e.Q6J("ngIf",s.href)}}function R(t,a){if(1&t&&(e.TgZ(0,"span"),e.YNc(1,M,3,2,"span",20),e.qZA()),2&t){const s=e.oxw().$implicit;e.xp6(1),e.Q6J("ngForOf",s.text)}}function O(t,a){if(1&t&&(e.TgZ(0,"div",21),e.YNc(1,Z,3,3,"span",22),e.YNc(2,H,2,1,"span",23),e.YNc(3,R,2,1,"span",24),e.qZA()),2&t){const s=a.$implicit;e.xp6(1),e.Q6J("ngIf",s.target),e.xp6(1),e.Q6J("ngIf",s.system),e.xp6(1),e.Q6J("ngIf",s.text)}}function B(t,a){if(1&t&&(e.TgZ(0,"div",18)(1,"div",19),e.YNc(2,O,4,3,"div",20),e.qZA()()),2&t){const s=e.oxw();e.xp6(2),e.Q6J("ngForOf",s.client.messages)}}function I(t,a){if(1&t&&(e.TgZ(0,"span")(1,"b"),e._uU(2),e.qZA()()),2&t){const s=e.oxw(2);e.Akn("color: #"+s.client.last_message.color),e.xp6(2),e.Oqu(s.client.last_message.target)}}function J(t,a){if(1&t){const s=e.EpF();e.TgZ(0,"div",28),e.NdJ("click",function(){e.CHM(s);const n=e.oxw();return e.KtG(n.clickMessageThumbnail())}),e.YNc(1,I,3,3,"span",29),e.TgZ(2,"span"),e._uU(3),e.qZA()()}if(2&t){const s=e.oxw();e.xp6(1),e.Q6J("ngIf",s.client.last_message.target),e.xp6(2),e.Oqu(s.client.last_message.text)}}const W=[{path:"",component:(()=>{var t;class a{constructor(i,n){this.client=i,this.noti=n,this.show_last_message_thumbnail=!1}ionViewDidEnter(){this.client.get_address(),this.noti.initialize(),this.ContentsDiv=document.getElementById("contents"),this.client.Received_CallBack=()=>{setTimeout(()=>{this.ContentsDiv.scrollHeight<this.ContentsDiv.scrollTop+this.ContentsDiv.clientHeight+120?this.ContentsDiv.scrollTo({behavior:"smooth",top:this.ContentsDiv.scrollHeight}):this.show_last_message_thumbnail=!0},0)}}RequestOrReconnect(){try{this.client.RequestRegrouping(),this.client.Received_CallBack&&this.client.Received_CallBack()}catch{this.client.ConnectToServer()}}clickMessageThumbnail(){this.ContentsDiv.scrollTo({behavior:"smooth",top:this.ContentsDiv.scrollHeight}),this.show_last_message_thumbnail=!1,this.input_message.setFocus()}send_message(){let i=this.userInput.trim();i&&this.client.isMatched&&this.client.send(JSON.stringify({pid:this.client.pid,color:this.client.UserColor,text:i})),setTimeout(()=>{this.userInput=""},0),this.input_message.setFocus()}}return(t=a).\u0275fac=function(i){return new(i||t)(e.Y36(P),e.Y36(b))},t.\u0275cmp=e.Xpm({type:t,selectors:[["app-home"]],viewQuery:function(i,n){if(1&i&&e.Gf(T,5),2&i){let c;e.iGM(c=e.CRH())&&(n.input_message=c.first)}},decls:22,vars:10,consts:[[3,"translucent"],["slot","end"],[3,"fullscreen"],["class","disconnected",4,"ngIf"],["id","contents","style","height: 100%; position: relative; overflow-y: scroll;",4,"ngIf"],["class","new_message",3,"click",4,"ngIf"],["id","input_table",2,"width","100%"],["fill","clear",1,"ion-text-center",3,"disabled","click"],["name","refresh-outline"],[2,"width","100%","vertical-align","bottom"],["type","text","placeholder","\uba54\uc2dc\uc9c0 \uc785\ub825...",3,"disabled","ngModel","keyup.enter","ngModelChange"],["input_message",""],["fill","clear","expand","block",3,"disabled","click"],["name","send"],[1,"disconnected"],[1,"disconnect_info"],["color","medium","name","chatbubble-ellipses-outline",2,"width","60px","height","60px"],["color","medium"],["id","contents",2,"height","100%","position","relative","overflow-y","scroll"],[1,"full_screen"],["class","line_height",4,"ngFor","ngForOf"],[1,"line_height"],["class","line_height",3,"style",4,"ngIf"],["style","color: gray;","class","line_height",4,"ngIf"],[4,"ngIf"],[1,"line_height",2,"color","gray"],["target","_system",3,"href",4,"ngIf"],["target","_system",3,"href"],[1,"new_message",3,"click"],[3,"style",4,"ngIf"]],template:function(i,n){1&i&&(e.TgZ(0,"ion-header",0)(1,"ion-toolbar")(2,"ion-title"),e._uU(3," \ub79c\ub364\ucc44\ud305 "),e.qZA(),e.TgZ(4,"ion-title",1),e._uU(5),e.qZA()()(),e.TgZ(6,"ion-content",2),e.YNc(7,k,6,0,"div",3),e.YNc(8,B,3,1,"div",4),e.qZA(),e.TgZ(9,"ion-footer"),e.YNc(10,J,4,2,"div",5),e.TgZ(11,"table",6)(12,"tr")(13,"td")(14,"ion-button",7),e.NdJ("click",function(){return n.RequestOrReconnect()}),e._UZ(15,"ion-icon",8),e.qZA()(),e.TgZ(16,"td",9)(17,"ion-input",10,11),e.NdJ("keyup.enter",function(){return n.send_message()})("ngModelChange",function(d){return n.userInput=d}),e.qZA()(),e.TgZ(19,"td")(20,"ion-button",12),e.NdJ("click",function(){return n.send_message()}),e._UZ(21,"ion-icon",13),e.qZA()()()()()),2&i&&(e.Q6J("translucent",!0),e.xp6(5),e.hij(" ","\ub3d9\uc2dc \uc811\uc18d: "+n.client.CurrentConnected+"\uba85"," "),e.xp6(1),e.Q6J("fullscreen",!0),e.xp6(1),e.Q6J("ngIf",!n.client.isConnected),e.xp6(1),e.Q6J("ngIf",n.client.isConnected),e.xp6(2),e.Q6J("ngIf",n.show_last_message_thumbnail),e.xp6(4),e.Q6J("disabled",!n.client.isConnected||!n.client.isMatched),e.xp6(3),e.Q6J("disabled",!n.client.isConnected)("ngModel",n.userInput),e.xp6(3),e.Q6J("disabled",!n.client.isConnected||!n.client.isMatched))},dependencies:[u.sg,u.O5,_.JJ,_.On,r.YG,r.W2,r.fr,r.Gu,r.gu,r.pK,r.Q$,r.wd,r.sr,r.j9],styles:[".disconnected[_ngcontent-%COMP%]{width:100%;height:100%}.disconnect_info[_ngcontent-%COMP%]{text-align:center;position:absolute;top:50%;left:50%;transform:translate(-50%) translateY(-50%)}.full_screen[_ngcontent-%COMP%]{width:100%;max-height:100%;padding:16px;position:absolute;bottom:0}.line_height[_ngcontent-%COMP%]{padding-bottom:8px}.TextAreaInput[_ngcontent-%COMP%]{width:100%;height:36px;max-height:156px;resize:none;padding:6px;margin-top:5px;border:0;overflow:hidden;background-color:var(--chatroom-input-background)}.new_message[_ngcontent-%COMP%]{width:100%;height:-moz-fit-content;height:fit-content;background-color:var(--text-thumbnail-background);position:absolute;transform:translateY(-100%);vertical-align:middle;padding:8px}"]}),a})()}];let q=(()=>{var t;class a{}return(t=a).\u0275fac=function(i){return new(i||t)},t.\u0275mod=e.oAB({type:t}),t.\u0275inj=e.cJS({imports:[v.Bz.forChild(W),v.Bz]}),a})(),Q=(()=>{var t;class a{}return(t=a).\u0275fac=function(i){return new(i||t)},t.\u0275mod=e.oAB({type:t}),t.\u0275inj=e.cJS({imports:[u.ez,_.u5,r.Pc,q]}),a})()}}]);