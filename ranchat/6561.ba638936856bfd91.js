"use strict";(self.webpackChunkapp=self.webpackChunkapp||[]).push([[6561],{6561:(z,R,f)=>{f.r(R),f.d(R,{HomePageModule:()=>G});var y=f(6814),g=f(7027),w=f(95),I=f(4482),h=f(5861);const P=(0,f(2726).fo)("LocalNotifications",{web:()=>f.e(3850).then(f.bind(f,3850)).then(n=>new n.LocalNotificationsWeb)});var t=f(6689),_="";let A=(()=>{var n;class c{constructor(e){this.platform=e,this.isBackgroundMode=!1}initialize(){var e=this;return(0,h.Z)(function*(){e.platform.is("desktop")&&(_="DesktopPWA"),e.platform.is("mobileweb")&&(_="MobilePWA"),"MobilePWA"==_?"granted"!=(yield P.checkPermissions()).display&&(yield P.requestPermissions()):"Notification"in window?Notification.requestPermission().then(i=>{"granted"!=i&&console.log("\uc54c\ub9bc \uac70\uc808",i)},i=>{console.error("\uc9c0\uc6d0\ud558\uc9c0 \uc54a\ub294 \ube0c\ub77c\uc6b0\uc800:",i)}):console.error("Notification \ubbf8\uc9c0\uc6d0 \ube0c\ub77c\uc6b0\uc800\uc785\ub2c8\ub2e4"),document.addEventListener("pause",()=>{e.isBackgroundMode=!0},!1),document.addEventListener("resume",()=>{e.isBackgroundMode=!1},!1)})()}PushLocal(e){var i=this;return(0,h.Z)(function*(){if("DesktopPWA"==_||"MobilePWA"==_){if(document.hasFocus())return;const s={badge:e.badge,body:e.body,icon:"assets/icon/favicon.png",lang:e.lang};try{i.WebNoties.close()}catch{}"DesktopPWA"==_?(i.WebNoties=new Notification("Project: \ub79c\ub364\ucc44\ud305",{...s}),i.WebNoties.onclick=()=>{window.focus(),i.WebNoties.close()}):window.swReg&&window.swReg.active&&(i.WebNoties=window.swReg.showNotification("Project: \ub79c\ub364\ucc44\ud305",{...s}),i.WebNoties.onclick=()=>{window.focus(),i.WebNoties.close()})}else"MobilePWA"==_&&i.isBackgroundMode&&P.schedule({notifications:[{id:13,title:"\ub79c\ub364\ucc44\ud305",body:e.body,iconColor:"#bbbbbb",smallIcon:"simplechat"}]})})()}}return(n=c).\u0275fac=function(e){return new(e||n)(t.LFG(g.t4))},n.\u0275prov=t.Yz7({token:n,factory:n.\u0275fac,providedIn:"root"}),c})();var b=f(2156);let O=(()=>{var n;class c{constructor(){this.isCallable=!1,this.isConnected=!1,this.JoinInited=!1,this.ReceivedOfferPart="",this.ReceivedAnswerPart="",this.IceCandidates=[],this.servers={iceServers:[{username:"pjcone",credential:"1z2x3c4v",urls:["stun:www.razorbacky.com:3478","turn:www.razorbacky.com:3478"]}]},this.dataChannel={},this.dataChannelOpenAct={},this.dataChannelOnMsgAct={},this.dataChannelOnCloseAct={}}initialize(e,i){var s=this;return(0,h.Z)(function*(){if(yield s.close_webrtc(),s.TypeIn=e,"data"!=e)try{var r,d;s.localMedia||(s.localMedia=document.createElement(e),s.localMedia.id="webrtc_video",s.localMedia.style.width=(window.innerWidth-40)/2+"px",s.localMedia.style.maxWidth="450px",s.localMedia.style.height="fit-contents",s.localMedia.style.objectFit="cover",s.localMedia.autoplay=!0,"video"==e&&(s.localMedia.playsInline=!0),s.localMedia.muted=!0,s.localMedia.style.borderRadius="16px",document.getElementById("my_video").appendChild(s.localMedia)),s.remoteMedia||(s.remoteMedia=document.createElement(e),s.remoteMedia.id="webrtc_video_remote",s.remoteMedia.style.width=(window.innerWidth-40)/2+"px",s.remoteMedia.style.maxWidth="450px",s.remoteMedia.style.height="fit-contents",s.remoteMedia.style.objectFit="cover",s.remoteMedia.autoplay=!0,"video"==e&&(s.remoteMedia.playsInline=!0),s.remoteMedia.style.borderRadius="16px",document.getElementById("your_video").appendChild(s.remoteMedia));let l,m,a=yield s.getDeviceList(),v=Number(null!==(r=localStorage.getItem("VideoInputDev"))&&void 0!==r?r:NaN),p=Number(null!==(d=localStorage.getItem("AudioInputDev"))&&void 0!==d?d:NaN);for(let u=0,C=a.length,T=0,x=0;u<C&&(!l||!m);u++)!l&&"audioinput"==a[u].kind&&(Number.isNaN(p)?(l=a[u].deviceId,localStorage.setItem("AudioInputDev",`${x}`)):x==p&&(l=a[u].deviceId),x++),!m&&"videoinput"==a[u].kind&&(Number.isNaN(v)?(m=a[u].deviceId,localStorage.setItem("AudioInputDev",`${T}`)):T==v&&(m=a[u].deviceId),T++);i||(i={},"video"==e?(i.video=!0,m&&(i.video={deviceId:m})):i.video=!1,i.audio=!0,l&&(i.audio={deviceId:l})),s.localStream||(s.localStream=yield navigator.mediaDevices.getUserMedia(i),s.localMedia.srcObject=s.localStream),s.isCallable=!0}catch(a){console.log("navigator.getUserMedia error: ",a),yield s.close_webrtc()}})()}getDeviceList(){return(0,h.Z)(function*(){return yield navigator.mediaDevices.enumerateDevices()})()}createCall(){var e=this;return(0,h.Z)(function*(){e.ReceivedOfferPart="",e.ReceivedAnswerPart="",e.isCallable=!1,e.isConnected=!0,e.startTime=window.performance.now(),e.PeerConnection=new RTCPeerConnection(e.servers),e.PeerConnection.addEventListener("icecandidate",i=>e.handleConnection(i)),e.PeerConnection.addEventListener("connectionstatechange",function(){var i=(0,h.Z)(function*(s){switch(s.target.connectionState){case"failed":case"disconnected":yield e.close_webrtc();break;case"connected":console.log("connected");break;default:console.log("\uc5f0\uacb0 \uc0c1\ud0dc \ubcc0\uacbd\ub428: ",s.target.connectionState)}});return function(s){return i.apply(this,arguments)}}()),"data"!=e.TypeIn&&(e.PeerConnection.addStream(e.localStream),e.PeerConnection.addEventListener("addstream",i=>{e.remoteMedia.srcObject=i.stream})),e.PeerConnection.addEventListener("datachannel",i=>{e.dataChannel[i.channel.label]=i.channel,e.createDataChannelListener(i.channel.label)}),e.PeerConnection.addEventListener("negotiationneeded",function(){var i=(0,h.Z)(function*(s){if(e.JoinInited&&(yield e.PeerConnection.createOffer({offerToReceiveVideo:1}).then(r=>e.createdOffer(r)).catch(r=>e.setSessionDescriptionError(r)),"data"!=e.TypeIn)){let d=JSON.stringify(e.LocalOffer).match(/(.{1,250})/g);for(let a=0,l=d.length;a<l;a++)e.WebsocketSendingFunc(JSON.stringify({webrtc:"WEBRTC_NEGOCIATENEEDED",data:d[a]})),yield new Promise(m=>setTimeout(m,70));e.WebsocketSendingFunc(JSON.stringify({webrtc:"WEBRTC_NEGOCIATENEEDED",data:"EOL"}))}});return function(s){return i.apply(this,arguments)}}())})()}createDataChannel(e,i){this.dataChannel[e]=this.PeerConnection.createDataChannel(e,i),this.createDataChannelListener(e)}createDataChannelListener(e){this.dataChannel[e].addEventListener("open",i=>{this.dataChannelOpenAct[e]&&this.dataChannelOpenAct[e]()}),this.dataChannel[e].addEventListener("close",i=>{this.dataChannelOnCloseAct[e]&&this.dataChannelOnCloseAct[e]()}),this.dataChannel[e].addEventListener("message",i=>{this.dataChannelOnMsgAct[e]&&this.dataChannelOnMsgAct[e](i.data)})}send(e,i){try{this.dataChannel[e].send(i)}catch(s){console.log("WebRTC \uba54\uc2dc\uc9c0 \ubc1c\uc1a1 \uc2e4\ud328: ",s)}}CreateOfffer(){var e=this;return(0,h.Z)(function*(){yield e.PeerConnection.createOffer({offerToReceiveVideo:1}).then(i=>e.createdOffer(i)).catch(i=>e.setSessionDescriptionError(i))})()}handleConnection(e){let i=e.candidate;i&&this.IceCandidates.push(new RTCIceCandidate(i))}ReceiveIceCandidate(e){var i=this;this.ReplyIceCandidate&&clearTimeout(this.ReplyIceCandidate),this.ReplyIceCandidate=setTimeout((0,h.Z)(function*(){if("data"!=i.TypeIn)for(let s=0,r=i.IceCandidates.length;s<r;s++)i.WebsocketSendingFunc(JSON.stringify({webrtc:"WEBRTC_ICE_CANDIDATES",data:i.IceCandidates[s]})),yield new Promise(d=>setTimeout(d,70));i.IceCandidates.length=0}),800),this.PeerConnection.addIceCandidate(e).then(()=>{console.log("Success to add new ice candidate")}).catch(s=>{console.error("failed to add ice candidate: ",s)})}createdOffer(e){this.LocalOffer=e,this.PeerConnection.setLocalDescription(e).then(()=>{this.setLocalDescriptionSuccess(this.PeerConnection)}).catch(i=>this.setSessionDescriptionError(i))}createRemoteOfferFromAnswer(e){this.PeerConnection.setRemoteDescription(e).then(()=>{this.setRemoteDescriptionSuccess(this.PeerConnection)}).catch(i=>this.setSessionDescriptionError(i))}CreateAnswer(){this.PeerConnection.createAnswer().then(e=>this.createdAnswer(e)).catch(e=>this.setSessionDescriptionError(e))}setLocalDescriptionSuccess(e){this.setDescriptionSuccess(e,"setLocalDescription")}setRemoteDescriptionSuccess(e){this.setDescriptionSuccess(e,"setRemoteDescription")}createdAnswer(e){var i=this;return(0,h.Z)(function*(){if(i.LocalAnswer=e,i.PeerConnection.setLocalDescription(e).then(()=>{i.setLocalDescriptionSuccess(i.PeerConnection)}).catch(s=>i.setSessionDescriptionError(s)),"data"!=i.TypeIn){let r=JSON.stringify(e).match(/(.{1,250})/g);for(let d=0,a=r.length;d<a;d++)i.WebsocketSendingFunc(JSON.stringify({webrtc:"WEBRTC_RECEIVE_ANSWER",data:r[d]})),yield new Promise(l=>setTimeout(l,70));i.WebsocketSendingFunc(JSON.stringify({webrtc:"WEBRTC_RECEIVE_ANSWER",data:"EOL"}))}i.JoinInited=!0})()}ReceiveRemoteAnswer(e){var i=this;return(0,h.Z)(function*(){if(i.PeerConnection.setRemoteDescription(e).then(()=>{i.setRemoteDescriptionSuccess(i.PeerConnection)}).catch(s=>i.setSessionDescriptionError(s)),"data"!=i.TypeIn){for(let s=0,r=i.IceCandidates.length;s<r;s++)i.WebsocketSendingFunc(JSON.stringify({webrtc:"WEBRTC_ICE_CANDIDATES",data:i.IceCandidates[s]})),yield new Promise(d=>setTimeout(d,70));i.IceCandidates.length=0}})()}setSessionDescriptionError(e){console.error(`Failed to create session description: ${e}.`)}setDescriptionSuccess(e,i){console.log(`Local ${i} complete.`)}close_webrtc(){var e=this;return(0,h.Z)(function*(){e.PeerConnection&&e.PeerConnection.close(),e.PeerConnection=void 0,e.isCallable=!1,e.isConnected=!1,e.dataChannelOpenAct={},e.dataChannelOnCloseAct={},e.dataChannelOnMsgAct={},e.dataChannel={},e.ReceivedOfferPart="",e.ReceivedAnswerPart="",e.JoinInited=!1,e.IceCandidates.length=0})()}}return(n=c).\u0275fac=function(e){return new(e||n)},n.\u0275prov=t.Yz7({token:n,factory:n.\u0275fac,providedIn:"root"}),c})(),N=(()=>{var n;class c{constructor(e,i){this.noti=e,this.webrtc=i,this.isConnected=!0,this.isMatched=!1,this.UserColor="abcdef",this.CurrentConnected=0,this.messages=[{system:"\uc11c\ubc84\uc5d0 \uc5f0\uacb0\uc911\uc785\ub2c8\ub2e4.."}],this.last_message={}}get_address(){var e=this;return(0,h.Z)(function*(){try{let s=yield(yield fetch("https://is2you2.github.io/assets/data/WSAddress.txt")).blob();e.SocketServerAddress=yield s.text(),yield e.webrtc.initialize("video"),e.webrtc.WebsocketSendingFunc=r=>{e.send(r)},e.ConnectToServer()}catch{e.isConnected=!1,e.isMatched=!0}})()}ConnectToServer(){var e=this;try{this.client=new WebSocket(`wss://${this.SocketServerAddress}:12011`),this.client.onopen=()=>{this.last_message={text:"\uc0c8\ub85c\uc6b4 \ub300\ud654 \uc0c1\ub300\ub97c \ucc3e\uc2b5\ub2c8\ub2e4..."},this.noti.PushLocal({body:"\uc0c8\ub85c\uc6b4 \ub300\ud654 \uc0c1\ub300\ub97c \ucc3e\uc2b5\ub2c8\ub2e4..."}),this.messages.push({system:"\uc0c8\ub85c\uc6b4 \ub300\ud654 \uc0c1\ub300\ub97c \ucc3e\uc2b5\ub2c8\ub2e4..."}),this.UserColor="";for(let s=0;s<6;s++)this.UserColor+="6789abc".charAt(Math.floor(7*Math.random()))},this.client.onmessage=function(){var i=(0,h.Z)(function*(s){try{let d=yield s.data.text();try{let a=JSON.parse(d);if("number"==typeof a)throw"Received PeerId";if(a.pid){e.pid||(e.pid=a.pid),a.target=a.pid==e.pid?"\ub098: ":"\uc0c1\ub300\ubc29: ",e.last_message=a,e.noti.PushLocal({body:"\uc0c1\ub300\ubc29: "+a.text});let l=a.text.indexOf("http://");if(l<0&&(l=a.text.indexOf("https://")),l>=0){let m=a.text.substring(0,l),v=a.text.substring(l),p=v.indexOf(" "),u=v.substring(0,p),C=v.substring(p);a.text=[],m&&a.text.push({text:m}),u&&a.text.push({text:u,href:!0}),C&&a.text.push({text:C,href:-1==p})}else a.text=[{text:a.text}];e.messages.push(a)}else if(a.webrtc){let l=a.data;switch(a.webrtc){case"WEBRTC_INIT_REQ_SIGNAL":{console.log("init \uc694\uccad \ubc1b\uc74c"),yield e.webrtc.CreateOfffer(),e.messages.push({system:"\uc601\uc0c1\ud1b5\ud654 \uc0dd\uc131\uc911..."});let v=JSON.stringify(e.webrtc.LocalOffer).match(/(.{1,250})/g);for(let p=0,u=v.length;p<u;p++)e.send(JSON.stringify({webrtc:"WEBRTC_REPLY_INIT_SIGNAL",data:v[p]})),yield new Promise(C=>setTimeout(C,70));e.send(JSON.stringify({webrtc:"WEBRTC_REPLY_INIT_SIGNAL",data:"EOL"}))}break;case"WEBRTC_REPLY_INIT_SIGNAL":"EOL"==l?(e.messages.push({system:"\uc601\uc0c1 \ud1b5\ud654 \uc815\ubcf4 \ub2f5\uc7a5\uc911..."}),e.webrtc.createRemoteOfferFromAnswer(JSON.parse(e.webrtc.ReceivedOfferPart)),e.webrtc.ReceivedOfferPart="",e.webrtc.CreateAnswer(),e.SetContentDivHeight()):e.webrtc.ReceivedOfferPart+=l;break;case"WEBRTC_RECEIVE_ANSWER":"EOL"==l?(e.messages.push({system:"\uc601\uc0c1 \ud1b5\ud654 \uc815\ubcf4 \uc218\uc2e0\uc911..."}),e.webrtc.ReceiveRemoteAnswer(JSON.parse(e.webrtc.ReceivedAnswerPart)),e.webrtc.ReceivedAnswerPart="",e.SetContentDivHeight()):e.webrtc.ReceivedAnswerPart+=l;break;case"WEBRTC_ICE_CANDIDATES":console.log("ICE \ud6c4\ubcf4\uc790 \uc815\ubcf4 \uc218\uc2e0\uc911..."),e.webrtc.ReceiveIceCandidate(l),e.SetContentDivHeight();break;case"WEBRTC_NEGOCIATENEEDED":"EOL"==l?(e.messages.push({system:"\uc601\uc0c1 \ud1b5\ud654 \uc815\ubcf4 \ubcc0\uacbd \ubc18\uc601\uc911..."}),e.webrtc.createRemoteOfferFromAnswer(JSON.parse(e.webrtc.ReceivedOfferPart)),e.webrtc.ReceivedOfferPart="",e.webrtc.CreateAnswer()):e.webrtc.ReceivedOfferPart+=l;break;default:throw console.error("\uad6c\uc131\ub41c \uc801 \uc5c6\ub294 WebRTC \uc790\ub8cc\ud615: ",a),"\uad6c\uc131\ub41c \uc801 \uc5c6\ub294 WEBRTC \uc790\ub8cc\ud615"}}e.Received_CallBack&&e.Received_CallBack()}catch{if(0==d.indexOf("Current"))e.CurrentConnected=Number(d.split(":")[1]);else switch(d){case"GOT_MATCHED":e.isMatched=!0,e.last_message={text:"\uc784\uc758\uc758 \uc0ac\ub78c\uacfc \uc5f0\uacb0\ub418\uc5c8\uc2b5\ub2c8\ub2e4"},e.noti.PushLocal({body:"\uc784\uc758\uc758 \uc0ac\ub78c\uacfc \uc5f0\uacb0\ub418\uc5c8\uc2b5\ub2c8\ub2e4"}),e.messages=[{system:"\uc784\uc758\uc758 \uc0ac\ub78c\uacfc \uc5f0\uacb0\ub418\uc5c8\uc2b5\ub2c8\ub2e4"}],e.Received_CallBack&&e.Received_CallBack(),e.webrtc.createCall();break;case"PARTNER_OUT":e.last_message={text:"\ub300\ud654\uac00 \uc885\ub8cc\ub418\uc5c8\uc2b5\ub2c8\ub2e4"},e.noti.PushLocal({body:"\ub300\ud654\uac00 \uc885\ub8cc\ub418\uc5c8\uc2b5\ub2c8\ub2e4"}),e.messages.push({system:"\ub300\ud654\uac00 \uc885\ub8cc\ub418\uc5c8\uc2b5\ub2c8\ub2e4"}),yield e.webrtc.close_webrtc(),e.Received_CallBack&&e.Received_CallBack()}}}catch(r){console.log("\uba54\uc2dc\uc9c0 \ubc1b\uae30 \ubc0f \ucc98\ub9ac \uc624\ub958: ",r)}});return function(s){return i.apply(this,arguments)}}(),this.client.onclose=()=>{this.isConnected=!1,this.isMatched=!1}}catch(i){console.log("\uc5f0\uacb0 \uc2e4\ud328: ",i),this.isConnected=!1,this.isMatched=!1}}RequestRegrouping(){var e=this;return(0,h.Z)(function*(){try{yield e.webrtc.close_webrtc(),e.client.send("REQ_REGROUPING"),e.last_message={text:"\uc0c8\ub85c\uc6b4 \ub300\ud654 \uc0c1\ub300\ub97c \ucc3e\uc2b5\ub2c8\ub2e4..."},e.noti.PushLocal({body:"\uc0c8\ub85c\uc6b4 \ub300\ud654 \uc0c1\ub300\ub97c \ucc3e\uc2b5\ub2c8\ub2e4..."}),e.messages.push({system:"\uc0c8\ub85c\uc6b4 \ub300\ud654 \uc0c1\ub300\ub97c \ucc3e\uc2b5\ub2c8\ub2e4..."}),e.Received_CallBack&&e.Received_CallBack(),e.isMatched=!1}catch(i){console.log("\ub9e4\uce6d \uc694\uccad \ubc1c\uc1a1 \uc624\ub958: ",i),e.isConnected=!1,e.isMatched=!1,e.last_message={text:"\ub9e4\uce6d \uc694\uccad\uc744 \ubc1c\uc1a1\ud558\uc9c0 \ubabb\ud588\uc2b5\ub2c8\ub2e4"},e.noti.PushLocal({body:"\ub9e4\uce6d \uc694\uccad\uc744 \ubc1c\uc1a1\ud558\uc9c0 \ubabb\ud588\uc2b5\ub2c8\ub2e4"}),e.messages.push({system:"\ub9e4\uce6d \uc694\uccad\uc744 \ubc1c\uc1a1\ud558\uc9c0 \ubabb\ud588\uc2b5\ub2c8\ub2e4"}),e.Received_CallBack&&e.Received_CallBack()}})()}send(e){try{this.client.send(e)}catch(i){console.log("\uba54\uc2dc\uc9c0 \ubc1c\uc1a1 \uc624\ub958: ",i),this.isConnected=!1,this.isMatched=!1}}}return(n=c).\u0275fac=function(e){return new(e||n)(t.LFG(A),t.LFG(O))},n.\u0275prov=t.Yz7({token:n,factory:n.\u0275fac,providedIn:"root"}),c})();const M=["input_message"];function D(n,c){1&n&&(t.TgZ(0,"div",14)(1,"div",15),t._UZ(2,"ion-icon",16),t.TgZ(3,"div")(4,"ion-label",17),t._uU(5,"\uc11c\ubc84 \uc5f0\uacb0 \ub04a\uae40"),t.qZA()()()())}function Z(n,c){if(1&n&&(t.TgZ(0,"span",25)(1,"b"),t._uU(2),t.qZA()()),2&n){const o=t.oxw().$implicit;t.Akn("color: #"+o.color),t.xp6(2),t.Oqu(o.target)}}function k(n,c){if(1&n&&(t.TgZ(0,"span",29),t._uU(1),t.qZA()),2&n){const o=t.oxw().$implicit;t.xp6(1),t.Oqu(o.system)}}function L(n,c){if(1&n&&(t.TgZ(0,"span"),t._uU(1),t.qZA()),2&n){const o=t.oxw().$implicit;t.xp6(1),t.Oqu(o.text)}}function H(n,c){if(1&n&&(t.TgZ(0,"a",31),t._uU(1),t.qZA()),2&n){const o=t.oxw().$implicit;t.Q6J("href",o.text,t.LSH),t.xp6(1),t.Oqu(o.text)}}function B(n,c){if(1&n&&(t.TgZ(0,"span",25),t.YNc(1,L,2,1,"span",28),t.YNc(2,H,2,2,"a",30),t.qZA()),2&n){const o=c.$implicit;t.xp6(1),t.Q6J("ngIf",!o.href),t.xp6(1),t.Q6J("ngIf",o.href)}}function J(n,c){if(1&n&&(t.TgZ(0,"span"),t.YNc(1,B,3,2,"span",24),t.qZA()),2&n){const o=t.oxw().$implicit;t.xp6(1),t.Q6J("ngForOf",o.text)}}function W(n,c){if(1&n&&(t.TgZ(0,"div",25),t.YNc(1,Z,3,3,"span",26),t.YNc(2,k,2,1,"span",27),t.YNc(3,J,2,1,"span",28),t.qZA()),2&n){const o=c.$implicit;t.xp6(1),t.Q6J("ngIf",o.target),t.xp6(1),t.Q6J("ngIf",o.system),t.xp6(1),t.Q6J("ngIf",o.text)}}function F(n,c){if(1&n&&(t.TgZ(0,"div",18)(1,"div",19)(2,"div",20)(3,"table")(4,"tr"),t._UZ(5,"td",21)(6,"td",22),t.qZA()()(),t.TgZ(7,"div",23),t.YNc(8,W,4,3,"div",24),t.qZA()()()),2&n){const o=t.oxw();t.xp6(8),t.Q6J("ngForOf",o.client.messages)}}function Q(n,c){if(1&n&&(t.TgZ(0,"span")(1,"b"),t._uU(2),t.qZA()()),2&n){const o=t.oxw(2);t.Akn("color: #"+o.client.last_message.color),t.xp6(2),t.Oqu(o.client.last_message.target)}}function Y(n,c){if(1&n&&(t.TgZ(0,"span"),t._uU(1),t.qZA()),2&n){const o=c.$implicit;t.xp6(1),t.Oqu(o.text)}}function U(n,c){if(1&n){const o=t.EpF();t.TgZ(0,"div",32),t.NdJ("click",function(){t.CHM(o);const i=t.oxw();return t.KtG(i.clickMessageThumbnail())}),t.YNc(1,Q,3,3,"span",33),t.YNc(2,Y,2,1,"span",34),t.qZA()}if(2&n){const o=t.oxw();t.xp6(1),t.Q6J("ngIf",o.client.last_message.target),t.xp6(1),t.Q6J("ngForOf",o.client.last_message.text)}}const q=[{path:"",component:(()=>{var n;class c{constructor(e,i){this.client=e,this.noti=i,this.isMobileApp=!1,this.show_last_message_thumbnail=!1}ionViewDidEnter(){var e=this;return(0,h.Z)(function*(){yield e.noti.initialize(),e.isMobileApp="DesktopPWA"!=_,yield new Promise(i=>setTimeout(i,200)),e.ContentsDiv=document.getElementById("contents"),e.ContentsDiv.onscroll=i=>{e.ContentsDiv.scrollHeight==e.ContentsDiv.scrollTop+e.ContentsDiv.clientHeight&&e.clickMessageThumbnail()},e.client.Received_CallBack=()=>{setTimeout(()=>{e.ContentsDiv.scrollHeight<e.ContentsDiv.scrollTop+e.ContentsDiv.clientHeight+120?e.ContentsDiv.scrollTo({behavior:"smooth",top:e.ContentsDiv.scrollHeight}):e.show_last_message_thumbnail=!0},0)},e.client.SetContentDivHeight=()=>{e.setContentHeight()},yield e.show_banner(),yield e.client.get_address(),yield new Promise(i=>setTimeout(i,200)),e.setContentHeight()})()}setContentHeight(){let e=document.getElementById("logScreen"),i=document.getElementById("webrtc_video"),s=document.getElementById("webrtc_video_remote"),r=Math.max(i.clientHeight,s.clientHeight);this.ContentsDiv.style.height=e.clientHeight-r-40+"px"}RequestOrReconnect(){try{this.client.client?(this.client.RequestRegrouping(),this.client.Received_CallBack&&this.client.Received_CallBack()):this.client.ConnectToServer()}catch{this.client.ConnectToServer()}}clickMessageThumbnail(){this.ContentsDiv.scrollTo({behavior:"smooth",top:this.ContentsDiv.scrollHeight}),this.show_last_message_thumbnail=!1,"DesktopPWA"==_&&this.input_message.setFocus()}send_message(){let e=this.userInput.trim();e&&this.client.isMatched&&this.client.send(JSON.stringify({pid:this.client.pid,color:this.client.UserColor,text:e})),setTimeout(()=>{this.userInput=""},0),this.input_message.setFocus()}show_banner(){return(0,h.Z)(function*(){b.TQ.addListener(b.Wp.SizeChanged,i=>{document.querySelector("ion-router-outlet").style.marginBottom=i.height+"px"});const e={adId:"ca-app-pub-6577630868247944/9751342875",adSize:b.ci.BANNER,margin:0};yield b.TQ.showBanner(e)})()}}return(n=c).\u0275fac=function(e){return new(e||n)(t.Y36(N),t.Y36(A))},n.\u0275cmp=t.Xpm({type:n,selectors:[["app-home"]],viewQuery:function(e,i){if(1&e&&t.Gf(M,5),2&e){let s;t.iGM(s=t.CRH())&&(i.input_message=s.first)}},decls:22,vars:10,consts:[[3,"translucent"],["slot","end"],[3,"fullscreen"],["class","disconnected",4,"ngIf"],["style","height: 100%; position: relative;",4,"ngIf"],["class","new_message",3,"click",4,"ngIf"],["id","input_table",2,"width","100%"],["fill","clear",1,"ion-text-center",3,"disabled","click"],["name","refresh-outline"],[2,"width","100%","vertical-align","bottom"],["type","text","placeholder","\uba54\uc2dc\uc9c0 \uc785\ub825...",3,"disabled","ngModel","keyup.enter","ngModelChange"],["input_message",""],["fill","clear","expand","block",3,"disabled","click"],["name","send"],[1,"disconnected"],[1,"disconnect_info"],["color","medium","name","chatbubble-ellipses-outline",2,"width","60px","height","60px"],["color","medium"],[2,"height","100%","position","relative"],["id","logScreen",1,"full_screen",2,"height","100%"],[2,"padding","16px"],["id","my_video",1,"video_center"],["id","your_video",1,"video_center",2,"padding-left","8px"],["id","contents",2,"height","100%","overflow-y","scroll","padding","8px 0px 0px 8px"],["class","line_height",4,"ngFor","ngForOf"],[1,"line_height"],["class","line_height",3,"style",4,"ngIf"],["style","color: gray;","class","line_height",4,"ngIf"],[4,"ngIf"],[1,"line_height",2,"color","gray"],["target","_system",3,"href",4,"ngIf"],["target","_system",3,"href"],[1,"new_message",3,"click"],[3,"style",4,"ngIf"],[4,"ngFor","ngForOf"]],template:function(e,i){1&e&&(t.TgZ(0,"ion-header",0)(1,"ion-toolbar")(2,"ion-title"),t._uU(3," \ub79c\ub364\ucc44\ud305 "),t.qZA(),t.TgZ(4,"ion-title",1),t._uU(5),t.qZA()()(),t.TgZ(6,"ion-content",2),t.YNc(7,D,6,0,"div",3),t.YNc(8,F,9,1,"div",4),t.qZA(),t.TgZ(9,"ion-footer"),t.YNc(10,U,3,2,"div",5),t.TgZ(11,"table",6)(12,"tr")(13,"td")(14,"ion-button",7),t.NdJ("click",function(){return i.RequestOrReconnect()}),t._UZ(15,"ion-icon",8),t.qZA()(),t.TgZ(16,"td",9)(17,"ion-input",10,11),t.NdJ("keyup.enter",function(){return i.send_message()})("ngModelChange",function(r){return i.userInput=r}),t.qZA()(),t.TgZ(19,"td")(20,"ion-button",12),t.NdJ("click",function(){return i.send_message()}),t._UZ(21,"ion-icon",13),t.qZA()()()()()),2&e&&(t.Q6J("translucent",!0),t.xp6(5),t.hij(" ","\ub3d9\uc2dc \uc811\uc18d: "+i.client.CurrentConnected+"\uba85"," "),t.xp6(1),t.Q6J("fullscreen",!0),t.xp6(1),t.Q6J("ngIf",!i.client.isConnected),t.xp6(1),t.Q6J("ngIf",i.client.isConnected),t.xp6(2),t.Q6J("ngIf",i.show_last_message_thumbnail),t.xp6(4),t.Q6J("disabled",i.client.client&&(!i.client.isConnected||!i.client.isMatched)),t.xp6(3),t.Q6J("disabled",!i.client.isConnected)("ngModel",i.userInput),t.xp6(3),t.Q6J("disabled",!i.client.isConnected||!i.client.isMatched))},dependencies:[y.sg,y.O5,w.JJ,w.On,g.YG,g.W2,g.fr,g.Gu,g.gu,g.pK,g.Q$,g.wd,g.sr,g.j9],styles:[".disconnected[_ngcontent-%COMP%]{width:100%;height:100%}.disconnect_info[_ngcontent-%COMP%]{text-align:center;position:absolute;top:50%;left:50%;transform:translate(-50%) translateY(-50%)}.full_screen[_ngcontent-%COMP%]{width:100%;max-height:100%;position:absolute;bottom:0}.video_center[_ngcontent-%COMP%]{vertical-align:middle}.line_height[_ngcontent-%COMP%]{padding-bottom:8px}.TextAreaInput[_ngcontent-%COMP%]{width:100%;height:36px;max-height:156px;resize:none;padding:6px;margin-top:5px;border:0;overflow:hidden;background-color:var(--chatroom-input-background)}.new_message[_ngcontent-%COMP%]{width:100%;height:-moz-fit-content;height:fit-content;background-color:var(--text-thumbnail-background);position:absolute;transform:translateY(-100%);vertical-align:middle;padding:8px}"]}),c})()}];let j=(()=>{var n;class c{}return(n=c).\u0275fac=function(e){return new(e||n)},n.\u0275mod=t.oAB({type:n}),n.\u0275inj=t.cJS({imports:[I.Bz.forChild(q),I.Bz]}),c})(),G=(()=>{var n;class c{}return(n=c).\u0275fac=function(e){return new(e||n)},n.\u0275mod=t.oAB({type:n}),n.\u0275inj=t.cJS({imports:[y.ez,w.u5,g.Pc,j]}),c})()}}]);