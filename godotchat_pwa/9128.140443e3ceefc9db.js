"use strict";(self.webpackChunkapp=self.webpackChunkapp||[]).push([[9128],{9128:(H,C,r)=>{r.r(C),r.d(C,{SubscribesPageModule:()=>W});var v=r(177),$=r(4341),h=r(5374),P=r(9858),k=r(467),S=r(9349),R=r(3483),F=r(9543),e=r(3953),G=r(3656),j=r(4237),M=r(8065),I=r(4234),O=r(482),X=r(755),D=r(9347);const T=()=>[0,1,2];function A(o,l){if(1&o){const n=e.RV6();e.j41(0,"ion-item",8),e.bIt("click",function(){e.eBV(n);const i=e.XpG().$implicit,a=e.XpG(2);return e.Njj(a.check_notifications(i))}),e.j41(1,"ion-label"),e.EFF(2),e.k0s()()}if(2&o){const n=e.XpG().$implicit,t=e.XpG(2);e.R7$(2),e.JRh(t.nakama.notifications_rearrange[n].request)}}function B(o,l){if(1&o&&(e.j41(0,"div"),e.DNE(1,A,3,1,"ion-item",17),e.k0s()),2&o){const n=l.$implicit,t=e.XpG(2);e.R7$(),e.Y8G("ngIf",t.nakama.notifications_rearrange.length>n)}}function U(o,l){if(1&o&&(e.j41(0,"ion-accordion-group",12,0)(2,"ion-accordion",13)(3,"ion-item",14)(4,"ion-label"),e.EFF(5),e.k0s()(),e.j41(6,"div",15),e.DNE(7,B,2,1,"div",16),e.k0s()()()),2&o){const n=e.XpG();e.Y8G("value",!1),e.R7$(5),e.JRh(n.lang.text.Subscribes.has_noties),e.R7$(2),e.Y8G("ngForOf",e.lJ4(3,T))}}function E(o,l){if(1&o&&e.nrm(0,"div",27),2&o){const n=e.XpG().$implicit,t=e.XpG(2);e.Aen("background-color: "+t.statusBar.colors[n.status||"offline"])}}function w(o,l){if(1&o&&e.nrm(0,"div",28),2&o){const n=e.XpG().$implicit;e.Aen("background-image: linear-gradient(to right, #0000, #"+(n.color||"abcdef")+"44)")}}function K(o,l){if(1&o&&(e.j41(0,"td",29),e.EFF(1),e.k0s()),2&o){const n=e.XpG().$implicit,t=e.XpG(2);e.R7$(),e.SpI(" ","("+(n.local?t.lang.text.AddGroup.UseLocalStorage:n.server.name||n.server.target)+")"," ")}}function N(o,l){if(1&o){const n=e.RV6();e.j41(0,"ion-item",19),e.bIt("click",function(){const i=e.eBV(n).$implicit,a=e.XpG(2);return e.Njj(a.go_to_chatroom(i))})("contextmenu",function(){const i=e.eBV(n).$implicit,a=e.XpG(2);return e.Njj(a.ChannelContextMenu(i))}),e.j41(1,"div",20),e.nrm(2,"img",21),e.DNE(3,E,1,2,"div",22),e.k0s(),e.DNE(4,w,1,2,"div",23),e.j41(5,"ion-label")(6,"div",24)(7,"table")(8,"tr")(9,"td"),e.EFF(10),e.k0s(),e.DNE(11,K,2,1,"td",25),e.k0s()()(),e.j41(12,"div",26),e.EFF(13),e.k0s()()()}if(2&o){const n=l.$implicit,t=e.XpG(2);e.R7$(2),e.Aen("online"==n.status||n.redirect&&3==n.redirect.type&&"pending"==n.status?"filter: grayscale(0) contrast(1)":"filter: grayscale(.9) contrast(1.4)"),e.Y8G("src",n.info&&n.info.img||(n.local||n.info&&1==n.info.max_count?"assets/data/local.svg":"assets/data/channel.svg"),e.B4B),e.R7$(),e.Y8G("ngIf",!n.local),e.R7$(),e.Y8G("ngIf",n.is_new),e.R7$(6),e.SpI(" ",n.info?n.info.name||n.info.display_name||t.lang.text.ChatRoom.noname_chatroom:n.title||t.lang.text.ChatRoom.noname_chatroom," "),e.R7$(),e.Y8G("ngIf",t.nakama.showServer),e.R7$(2),e.SpI(" ",n.last_comment||n.noti||t.lang.text.Subscribes.noMessageHistory," ")}}function Y(o,l){if(1&o&&(e.j41(0,"div")(1,"ion-item-divider")(2,"ion-label"),e.EFF(3),e.k0s()(),e.DNE(4,N,14,8,"ion-item",18),e.k0s()),2&o){const n=e.XpG();e.R7$(3),e.JRh(n.lang.text.Subscribes.JoinedChannels),e.R7$(),e.Y8G("ngForOf",n.nakama.channels)}}function J(o,l){if(1&o){const n=e.RV6();e.j41(0,"div")(1,"div",30),e.bIt("click",function(){e.eBV(n);const i=e.XpG();return e.Njj(i.add_new_group())}),e.nrm(2,"ion-icon",31),e.j41(3,"div")(4,"ion-label",32),e.EFF(5),e.k0s()()()()}if(2&o){const n=e.XpG();e.R7$(5),e.JRh(n.lang.text.Subscribes.NoChat)}}const V=[{path:"",component:(()=>{var o;class l{constructor(t,i,a,c,u,d,g,f,s,_){this.modalCtrl=t,this.nakama=i,this.statusBar=a,this.lang=c,this.global=u,this.navCtrl=d,this.indexed=g,this.alertCtrl=f,this.loadingCtrl=s,this.client=_,this.cant_dedicated=!1,this.lock_chatroom=!1}ngOnInit(){this.indexed.loadTextFromUserPath("servers/self/profile.img",(t,i)=>{t&&i&&(this.nakama.users.self.img=i.replace(/"|=|\\/g,""))})}open_link(t){window.open(t,"_system")}try_add_shortcut(){this.global.p5key&&this.global.p5key.KeyShortCut?this.AddShortcut():setTimeout(()=>{this.try_add_shortcut()},100)}AddShortcut(){this.global.p5key.KeyShortCut.Backquote=()=>{this.go_to_page("group-server")},this.global.p5key.KeyShortCut.Digit=t=>{this.nakama.channels.length>t?this.go_to_chatroom(this.nakama.channels[t]):this.add_new_group()},this.global.p5key.KeyShortCut.AddAct||(this.global.p5key.KeyShortCut.AddAct=()=>{this.add_new_group()})}ChannelContextMenu(t){var i=this;let a=t.server.isOfficial,c=t.server.target,u=t.title;switch(u=2==t.redirect.type?u||this.lang.text.Profile.noname_user:u||this.lang.text.ChatRoom.noname_chatroom,t.redirect.type){case 3:if("online"==t.status||"pending"==t.status){this.modalCtrl.create({component:F.k,componentProps:{info:this.nakama.groups[a][c][t.group_id],server:{isOfficial:a,target:c}}}).then(d=>{let g=this.global.p5key.KeyShortCut;this.global.p5key.KeyShortCut={},d.onDidDismiss().then(()=>{this.global.p5key.KeyShortCut=g}),d.present()});break}case 2:"online"==t.status||"pending"==t.status?this.alertCtrl.create({header:u,message:this.lang.text.ChatRoom.UnlinkChannel,buttons:[{text:this.lang.text.ChatRoom.LogOut,handler:(d=(0,k.A)(function*(){try{yield i.nakama.servers[a][c].socket.leaveChat(t.id),i.nakama.channels_orig[a][c][t.id].status="missing"}catch(g){console.error("\ucc44\ub110\uc5d0\uc11c \ub098\uc624\uae30 \uc2e4\ud328: ",g)}i.nakama.rearrange_channels()}),function(){return d.apply(this,arguments)}),cssClass:"redfont"}]}).then(d=>d.present()):this.alertCtrl.create({header:u,message:this.lang.text.ChatRoom.RemoveChannelLogs,buttons:[{text:this.lang.text.ChatRoom.Delete,handler:function(){var d=(0,k.A)(function*(){let g=yield i.loadingCtrl.create({message:i.lang.text.TodoDetail.WIP});g.present(),yield i.nakama.remove_group_list(i.nakama.groups[a][c][t.group_id],a,c,!0),delete i.nakama.channels_orig[a][c][t.id],i.nakama.remove_channel_files(a,c,t.id);try{let s=localStorage.getItem("fallback_fs");if(!s)throw"\uc0ac\uc6a9\uc790 \uc9c0\uc815 \uc11c\ubc84 \uc5c6\uc74c";let _=s.split("://"),m=_.pop().split(":"),p=_.pop();p?p+=":":p=m[0].replace(/(\b25[0-5]|\b2[0-4][0-9]|\b[01]?[0-9][0-9]?)(\.(25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)){3}/g,"")?"https:":"http:";let x=`${p}//${m[0]}:${m[1]||9002}/`,b=`${t.id}_${i.nakama.users.self.display_name}`;try{b=`${t.info.id}_${i.nakama.servers[a][c].session.user_id}`}catch{}i.global.remove_files_from_storage_with_key(x,b)}catch{}try{i.global.remove_files_from_storage_with_key(`${[t.info.server.useSSL?"https:":"http:"]}//${t.info.server.address}:9002/`,`${t.info.id}_${i.nakama.servers[a][c].session.user_id}`)}catch{}let f=yield i.indexed.GetFileListFromDB(`servers/${a}/${c}/channels/${t.id}`);for(let s=0,_=f.length;s<_;s++)g.message=`${i.lang.text.UserFsDir.DeleteFile}: ${_-s}`,yield i.indexed.removeFileFromUserPath(f[s]);g.dismiss(),i.nakama.rearrange_channels()});return function(){return d.apply(this,arguments)}}(),cssClass:"redfont"}]}).then(d=>d.present());break;case 0:this.alertCtrl.create({header:u,message:this.lang.text.ChatRoom.RemoveChannelLogs,buttons:[{text:this.lang.text.ChatRoom.Delete,handler:function(){var d=(0,k.A)(function*(){let g=yield i.loadingCtrl.create({message:i.lang.text.TodoDetail.WIP});g.present(),delete i.nakama.channels_orig[a][c][t.id];try{yield i.indexed.removeFileFromUserPath(`servers/${a}/${c}/groups/${t.id}.img`)}catch(s){console.log("\uadf8\ub8f9 \uc774\ubbf8\uc9c0 \uc0ad\uc81c \uc624\ub958: ",s)}i.nakama.save_groups_with_less_info();try{let s=localStorage.getItem("fallback_fs");if(!s)throw"\uc0ac\uc6a9\uc790 \uc9c0\uc815 \uc11c\ubc84 \uc5c6\uc74c";let _=s.split("://"),m=_.pop().split(":"),p=_.pop();p?p+=":":p=m[0].replace(/(\b25[0-5]|\b2[0-4][0-9]|\b[01]?[0-9][0-9]?)(\.(25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)){3}/g,"")?"https:":"http:";let x=`${p}//${m[0]}:${m[1]||9002}/`,b=`${t.id}_${i.nakama.users.self.display_name}`;try{b=`${t.info.id}_${i.nakama.servers[a][c].session.user_id}`}catch{}i.global.remove_files_from_storage_with_key(x,b)}catch{}let f=yield i.indexed.GetFileListFromDB(`servers/${a}/${c}/channels/${t.id}`);for(let s=0,_=f.length;s<_;s++)g.message=`${i.lang.text.UserFsDir.DeleteFile}: ${_-s}`,yield i.indexed.removeFileFromUserPath(f[s]);g.dismiss(),i.nakama.rearrange_channels()});return function(){return d.apply(this,arguments)}}(),cssClass:"redfont"}]}).then(d=>d.present())}var d;return!1}ionViewDidEnter(){this.nakama.subscribe_lock=!0,("DesktopPWA"==S.aH||"MobilePWA"==S.aH)&&(this.cant_dedicated=!0),this.try_add_shortcut()}go_to_page(t){this.navCtrl.navigateForward(`portal/settings/${t}`)}JoinSmallTalk(){"online"!=this.statusBar.settings.dedicated_groupchat&&"certified"!=this.statusBar.settings.dedicated_groupchat&&(this.statusBar.settings.dedicated_groupchat="pending"),this.client.RejoinGroupChat()}go_to_chatroom(t){this.lock_chatroom||(this.lock_chatroom=!0,this.nakama.go_to_chatroom_without_admob_act(t),("online"!=t.status||"pending"!=t.status)&&delete t.is_new,this.lock_chatroom=!1)}check_notifications(t){let i=this.nakama.notifications_rearrange[t].server;this.nakama.check_notifications(this.nakama.notifications_rearrange[t],i.isOfficial,i.target)}add_new_group(){this.modalCtrl.create({component:R.k}).then(t=>{let i=this.global.p5key.KeyShortCut;this.global.p5key.KeyShortCut={},t.onDidDismiss().then(()=>{this.global.p5key.KeyShortCut=i,this.try_add_shortcut()}),t.present()})}ionViewWillLeave(){this.nakama.subscribe_lock=!1,delete this.global.p5key.KeyShortCut.Backquote,delete this.global.p5key.KeyShortCut.Digit,delete this.global.p5key.KeyShortCut.AddAct}}return(o=l).\u0275fac=function(t){return new(t||o)(e.rXU(h.W3),e.rXU(j.X),e.rXU(M.j),e.rXU(I.y),e.rXU(O.z3),e.rXU(G.q9),e.rXU(X.n),e.rXU(h.hG),e.rXU(h.Xi),e.rXU(D.z))},o.\u0275cmp=e.VBU({type:o,selectors:[["app-subscribes"]],decls:21,vars:11,consts:[["accordionGroup",""],[1,"ion-no-border"],[1,"dedi_chat",3,"click"],["button","","name","chatbubbles-outline",2,"width","24px","height","24px"],[1,"add_group",3,"click"],["button","","name","add-circle-outline",2,"width","24px","height","24px"],[1,"header_online_circle",3,"click"],["value","colors","expand","inset",3,"value",4,"ngIf"],["button","",3,"click"],[1,"additional_form","bg_img_form"],[1,"profile_img",3,"src"],[4,"ngIf"],["value","colors","expand","inset",3,"value"],["value","colors"],["slot","header"],["slot","content"],[4,"ngFor","ngForOf"],["button","",3,"click",4,"ngIf"],["button","",3,"click","contextmenu",4,"ngFor","ngForOf"],["button","",3,"click","contextmenu"],[1,"channel_image","channel_image_div"],["alt","ch_img",1,"channel_image",3,"src"],["class","status_circle",3,"style",4,"ngIf"],["class","additional_form new_bg_form",3,"style",4,"ngIf"],[1,"channel_text_form","header"],["class","server_target",4,"ngIf"],[1,"channel_text_form","content"],[1,"status_circle"],[1,"additional_form","new_bg_form"],[1,"server_target"],[1,"disconnect_info",3,"click"],["color","medium","name","chatbubble-ellipses-outline",2,"width","60px","height","60px"],["color","medium"]],template:function(t,i){1&t&&(e.j41(0,"ion-header",1)(1,"ion-toolbar")(2,"ion-title"),e.EFF(3),e.k0s(),e.j41(4,"div",2),e.bIt("click",function(){return i.JoinSmallTalk()}),e.nrm(5,"ion-icon",3),e.k0s(),e.j41(6,"div",4),e.bIt("click",function(){return i.add_new_group()}),e.nrm(7,"ion-icon",5),e.k0s(),e.j41(8,"div",6),e.bIt("click",function(){return i.nakama.toggle_all_session()}),e.k0s()()(),e.j41(9,"ion-content"),e.DNE(10,U,8,4,"ion-accordion-group",7),e.j41(11,"ion-item-divider")(12,"ion-label"),e.EFF(13),e.k0s()(),e.j41(14,"ion-item",8),e.bIt("click",function(){return i.go_to_page("group-server")}),e.j41(15,"div",9),e.nrm(16,"img",10),e.k0s(),e.j41(17,"ion-label"),e.EFF(18),e.k0s()(),e.DNE(19,Y,5,2,"div",11)(20,J,6,1,"div",11),e.k0s()),2&t&&(e.R7$(3),e.JRh(i.lang.text.Subscribes.Title),e.R7$(5),e.Aen("background-color: "+i.statusBar.colors[i.statusBar.settings.groupServer]+"; cursor: pointer;"),e.R7$(2),e.Y8G("ngIf",i.nakama.notifications_rearrange.length),e.R7$(3),e.JRh(i.lang.text.Subscribes.myProfile),e.R7$(3),e.Aen(i.nakama.users.self.online?"filter: grayscale(0) contrast(1);":"filter: grayscale(.9) contrast(1.4);"),e.Y8G("src",i.nakama.users.self.img,e.B4B),e.R7$(2),e.JRh(i.nakama.users.self.display_name||i.lang.text.Profile.noname_user),e.R7$(),e.Y8G("ngIf",i.nakama.channels.length),e.R7$(),e.Y8G("ngIf",!i.nakama.channels.length))},dependencies:[v.Sq,v.bT,h.xk,h.YH,h.W9,h.eU,h.iq,h.uz,h.Dg,h.he,h.BC,h.ai],styles:[".advertise_banner[_ngcontent-%COMP%]{width:100%;max-height:150px}.header[_ngcontent-%COMP%]{padding-bottom:4px}.content[_ngcontent-%COMP%]{color:#888;height:24px;line-height:24px;vertical-align:middle;overflow:hidden}.channel_image_div[_ngcontent-%COMP%]{position:absolute}.channel_image[_ngcontent-%COMP%]{width:52px;height:52px;border-radius:64px;object-fit:cover}.status_bar[_ngcontent-%COMP%]{width:5px;height:76%}.channel_text_form[_ngcontent-%COMP%]{margin-left:64px}.status_circle[_ngcontent-%COMP%]{position:relative;top:-56px;left:38px;width:12px;height:12px;border-radius:12px}.md[_ngcontent-%COMP%]   .qr_code_scan[_ngcontent-%COMP%]{position:absolute;right:164px;top:16px;cursor:pointer}.ios[_ngcontent-%COMP%]   .qr_code_scan[_ngcontent-%COMP%]{position:absolute;right:164px;top:10px;cursor:pointer}.md[_ngcontent-%COMP%]   .dedi_chat[_ngcontent-%COMP%]{position:absolute;right:116px;top:16px;cursor:pointer}.ios[_ngcontent-%COMP%]   .dedi_chat[_ngcontent-%COMP%]{position:absolute;right:116px;top:10px;cursor:pointer}.md[_ngcontent-%COMP%]   .add_group[_ngcontent-%COMP%]{position:absolute;right:68px;top:16px;cursor:pointer}.ios[_ngcontent-%COMP%]   .add_group[_ngcontent-%COMP%]{position:absolute;right:68px;top:10px;cursor:pointer}"]}),l})()},{path:"chat-room",loadChildren:()=>Promise.all([r.e(2076),r.e(6134)]).then(r.bind(r,6134)).then(o=>o.ChatRoomPageModule)}];let L=(()=>{var o;class l{}return(o=l).\u0275fac=function(t){return new(t||o)},o.\u0275mod=e.$C({type:o}),o.\u0275inj=e.G2t({imports:[P.iI.forChild(V),P.iI]}),l})(),W=(()=>{var o;class l{}return(o=l).\u0275fac=function(t){return new(t||o)},o.\u0275mod=e.$C({type:o}),o.\u0275inj=e.G2t({imports:[v.MD,$.YN,h.bv,L]}),l})()}}]);