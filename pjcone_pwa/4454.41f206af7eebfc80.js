"use strict";(self.webpackChunkapp=self.webpackChunkapp||[]).push([[4454],{4454:(T,d,o)=>{o.r(d),o.d(d,{WsclientPageModule:()=>v});var c=o(9808),r=o(4182),i=o(3996),u=o(9705),h=o(655),t=o(9863),m=o(5742),p=o(4606);function _(s,l){if(1&s){const e=t.EpF();t.TgZ(0,"ion-item")(1,"ion-input",11),t.NdJ("ngModelChange",function(a){return t.CHM(e),t.oxw().send_msg=a})("keydown.enter",function(){return t.CHM(e),t.oxw().send()}),t.qZA(),t.TgZ(2,"ion-button",12),t.NdJ("click",function(){return t.CHM(e),t.oxw().send()}),t._uU(3),t.qZA()()}if(2&s){const e=t.oxw();t.xp6(1),t.Q6J("ngModel",e.send_msg)("placeholder",e.lang.text.WSClient.inputmsg),t.xp6(2),t.hij(" ",e.lang.text.WSClient.send," ")}}function f(s,l){if(1&s&&(t.TgZ(0,"div"),t._uU(1),t.qZA()),2&s){const e=l.$implicit;t.Akn("color: "+e.color),t.xp6(1),t.AsE(" ",e.time," ",e.text," ")}}const W=[{path:"",component:(()=>{class s{constructor(e,n){this.lang=e,this.statusBar=n,this.status="offline",this.logs=[]}ngOnInit(){this.logsDiv=document.getElementById("logs")}scroll_down(){setTimeout(()=>{this.logsDiv.scrollTo({top:this.logsDiv.scrollHeight,behavior:"smooth"})},0)}connect_to_server(){"offline"===this.status?(this.client&&this.client.close(),this.status="pending",this.client=new WebSocket(this.address),this.client.onopen=()=>{this.status="online",this.logs.push({text:`${this.lang.text.WSClient.Connected}: ${this.address}`,time:this.createTimestamp(),color:"#34aa43"}),this.scroll_down()},this.client.onmessage=e=>(0,h.mG)(this,void 0,void 0,function*(){try{let n;n="string"==typeof e.data?e.data:yield e.data.text(),this.logs.push({text:`${this.lang.text.WSClient.Received}: ${n}`,time:this.createTimestamp()}),this.scroll_down()}catch(n){this.logs.push({text:`${this.lang.text.WSClient.RecvError}: ${n}`,time:this.createTimestamp(),color:this.statusBar.colors.missing}),this.scroll_down()}}),this.client.onerror=e=>{console.log(e),this.logs.push({text:`${this.lang.text.WSClient.SocketError}: ${e.message||e}`,time:this.createTimestamp(),color:this.statusBar.colors.missing}),this.scroll_down()},this.client.onclose=()=>{this.logs.push({text:this.lang.text.WSClient.button_missing,time:this.createTimestamp(),color:this.statusBar.colors.missing}),this.scroll_down(),this.status="missing",setTimeout(()=>{this.status="offline"},500)}):this.client.close()}send(){this.client.send(this.send_msg),this.send_msg=""}createTimestamp(){let e=new Date;return`[${("0"+e.getHours()).slice(-2)}:${("0"+e.getMinutes()).slice(-2)}:${("0"+e.getSeconds()).slice(-2)}]`}ngOnDestroy(){this.client&&this.client.close()}}return s.\u0275fac=function(e){return new(e||s)(t.Y36(m.b),t.Y36(p.g))},s.\u0275cmp=t.Xpm({type:s,selectors:[["app-wsclient"]],decls:24,vars:12,consts:[["slot","start"],["defaultHref","portal/settings"],["button","",3,"disabled"],[1,"additional_form","status_bar_single"],[1,"form_margin"],["placeholder","ws://127.0.0.1:0000",1,"ion-text-end",3,"ngModel","ngModelChange"],["button","",3,"disabled","click"],[1,"ion-text-center"],[4,"ngIf"],["id","logs"],[3,"style",4,"ngFor","ngForOf"],[3,"ngModel","placeholder","ngModelChange","keydown.enter"],[3,"click"]],template:function(e,n){1&e&&(t.TgZ(0,"ion-header")(1,"ion-toolbar")(2,"ion-title"),t._uU(3),t.qZA(),t.TgZ(4,"ion-buttons",0),t._UZ(5,"ion-back-button",1),t.qZA()()(),t.TgZ(6,"ion-content")(7,"ion-item-divider")(8,"ion-label"),t._uU(9),t.qZA()(),t.TgZ(10,"ion-item",2),t._UZ(11,"div",3),t.TgZ(12,"ion-label",4),t._uU(13),t.qZA(),t.TgZ(14,"ion-input",5),t.NdJ("ngModelChange",function(g){return n.address=g}),t.qZA()(),t.TgZ(15,"ion-item",6),t.NdJ("click",function(){return n.connect_to_server()}),t.TgZ(16,"ion-label",7),t._uU(17),t.qZA()(),t.YNc(18,_,4,3,"ion-item",8),t.TgZ(19,"ion-item-divider")(20,"ion-label"),t._uU(21),t.qZA()(),t.TgZ(22,"div",9),t.YNc(23,f,2,4,"div",10),t.qZA()()),2&e&&(t.xp6(3),t.Oqu(n.lang.text.Settings.WSClient),t.xp6(6),t.Oqu(n.lang.text.WSClient.connInfo),t.xp6(1),t.Q6J("disabled","offline"!=n.status),t.xp6(1),t.Akn("background-color: "+n.statusBar.colors[n.status]),t.xp6(2),t.Oqu(n.lang.text.WSClient.address),t.xp6(1),t.Q6J("ngModel",n.address),t.xp6(1),t.Q6J("disabled","pending"==n.status||"missing"==n.status),t.xp6(2),t.Oqu(n.lang.text.WSClient["button_"+n.status]),t.xp6(1),t.Q6J("ngIf","online"==n.status),t.xp6(3),t.Oqu(n.lang.text.WSClient.logs),t.xp6(2),t.Q6J("ngForOf",n.logs))},directives:[i.Gu,i.sr,i.wd,i.Sm,i.oU,i.cs,i.W2,i.rH,i.Q$,i.Ie,i.pK,i.j9,r.JJ,r.On,c.O5,i.YG,c.sg],styles:["#logs[_ngcontent-%COMP%]{height:480px;overflow-y:scroll;background-color:var(--wsclient-logs-background);padding:8px}"]}),s})()}];let x=(()=>{class s{}return s.\u0275fac=function(e){return new(e||s)},s.\u0275mod=t.oAB({type:s}),s.\u0275inj=t.cJS({imports:[[u.Bz.forChild(W)],u.Bz]}),s})(),v=(()=>{class s{}return s.\u0275fac=function(e){return new(e||s)},s.\u0275mod=t.oAB({type:s}),s.\u0275inj=t.cJS({imports:[[c.ez,r.u5,i.Pc,x]]}),s})()}}]);