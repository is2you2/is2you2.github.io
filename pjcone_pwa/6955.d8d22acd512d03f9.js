"use strict";(self.webpackChunkapp=self.webpackChunkapp||[]).push([[6955],{6955:(P,h,s)=>{s.r(h),s.d(h,{GroupServerPageModule:()=>b});var p=s(9808),l=s(4182),a=s(3996),m=s(501),c=s(6505),e=s(2096),v=s(9912),_=s(3336),f=s(4606),k=s(3496),S=s(5742);function Z(i,d){if(1&i&&(e.TgZ(0,"ion-item-divider")(1,"ion-label"),e._uU(2),e.qZA()()),2&i){const t=e.oxw();e.xp6(2),e.Oqu(t.lang.text.GroupServer.JoinedServerList)}}function x(i,d){if(1&i){const t=e.EpF();e.TgZ(0,"ion-item",13),e.NdJ("click",function(){return e.CHM(t),e.oxw().link_group("official","default")}),e._UZ(1,"div",14),e.TgZ(2,"ion-label",15),e._uU(3),e.qZA(),e.TgZ(4,"ion-button",16),e.NdJ("click",function(){return e.CHM(t),e.oxw().remove_server("official","default")}),e._uU(5),e.qZA()()}if(2&i){const t=e.oxw();e.xp6(1),e.Akn("background-color: "+t.statusBar.colors[t.statusBar.groupServer.official.default]),e.xp6(2),e.Oqu(t.nakama.servers.official.default.info.name),e.xp6(2),e.hij(" ",t.lang.text.GroupServer.HideOfficialDefault," ")}}function T(i,d){if(1&i){const t=e.EpF();e.TgZ(0,"ion-item",13),e.NdJ("click",function(){const r=e.CHM(t).$implicit;return e.oxw().link_group(r.isOfficial,r.target)}),e._UZ(1,"div",14),e.TgZ(2,"ion-label",15)(3,"h2"),e._uU(4),e.qZA(),e.TgZ(5,"p"),e._uU(6),e.qZA()(),e.TgZ(7,"ion-button",16),e.NdJ("click",function(){const r=e.CHM(t).$implicit;return e.oxw().remove_server(r.isOfficial,r.target)}),e._uU(8),e.qZA()()}if(2&i){const t=d.$implicit,n=e.oxw();e.xp6(1),e.Akn("background-color: "+n.statusBar.colors[n.statusBar.groupServer[t.isOfficial][t.target]]),e.xp6(3),e.Oqu(t.name),e.xp6(2),e.AsE("",t.target," (",t.address,")"),e.xp6(2),e.hij(" ",n.lang.text.GroupServer.RemoveUnofficial," ")}}const G=[{path:"",component:(()=>{class i{constructor(t,n,o,r,u){this.nakama=t,this.p5toast=n,this.statusBar=o,this.indexed=r,this.lang=u,this.dedicated_info={name:void 0,address:void 0,target:void 0,port:void 0,useSSL:void 0,isOfficial:void 0,key:void 0},this.add_custom_tog=!1}ngOnInit(){new c(t=>{t.setup=()=>{t.loadStrings(`assets/data/infos/${this.lang.lang}/group-server.txt`,n=>{this.info=n.join("\n"),t.remove()},n=>{console.error("\uadf8\ub8f9\uc11c\ubc84 \uc124\uba85 \ud30c\uc77c \ubd88\ub7ec\uc624\uae30 \uc2e4\ud328: ",n),t.remove()})}}),this.servers=this.nakama.get_all_server_info()}link_group(t,n){"offline"==this.statusBar.groupServer[t][n]||"missing"==this.statusBar.groupServer[t][n]?(this.statusBar.groupServer[t][n]="pending",this.nakama.catch_group_server_header("pending"),this.nakama.users.self.online&&this.nakama.init_session(this.nakama.servers[t][n].info)):(this.statusBar.groupServer[t][n]="offline",this.nakama.catch_group_server_header("offline"),this.nakama.servers[t][n].session&&this.nakama.servers[t][n].client.sessionLogout(this.nakama.servers[t][n].session,this.nakama.servers[t][n].session.token,this.nakama.servers[t][n].session.refresh_token).then(o=>{o||console.warn("\ub85c\uadf8\uc544\uc6c3 \uc624\ub958 \uac80\ud1a0 \ud544\uc694"),this.nakama.noti_origin[t]&&this.nakama.noti_origin[t][n]&&delete this.nakama.noti_origin[t][n],this.nakama.rearrange_notifications()}),this.nakama.servers[t][n].socket&&this.nakama.servers[t][n].socket.disconnect(!0),this.nakama.channels_orig[t]&&this.nakama.channels_orig[t][n]&&Object.keys(this.nakama.channels_orig[t][n]).forEach(r=>{"missing"!=this.nakama.channels_orig[t][n][r].status&&delete this.nakama.channels_orig[t][n][r].status})),this.indexed.saveTextFileToUserPath(JSON.stringify(this.statusBar.groupServer),"servers/list.json")}add_custom_dedicated(){if(!this.add_custom_tog){if(!this.dedicated_info.name)return void this.p5toast.show({text:this.lang.text.GroupServer.NeedSetDIsplayName});this.add_custom_tog=!0,this.dedicated_info.port=this.dedicated_info.port||7350,this.dedicated_info.useSSL=this.dedicated_info.useSSL||!1,this.dedicated_info.key=this.dedicated_info.key||"defaultkey",this.nakama.add_group_server(this.dedicated_info,()=>{this.servers=this.nakama.get_all_server_info(),this.dedicated_info.name=void 0,this.dedicated_info.address=void 0,this.dedicated_info.target=void 0,this.dedicated_info.port=void 0,this.dedicated_info.useSSL=void 0,this.dedicated_info.isOfficial=void 0}),setTimeout(()=>{this.add_custom_tog=!1},1e3)}}remove_server(t,n){"online"==this.statusBar.groupServer[t][n]&&(this.nakama.servers[t][n].client.sessionLogout(this.nakama.servers[t][n].session,this.nakama.servers[t][n].session.token,this.nakama.servers[t][n].session.refresh_token),this.nakama.servers[t][n].socket&&this.nakama.servers[t][n].socket.disconnect(!0)),delete this.nakama.servers[t][n],this.nakama.noti_origin[t]&&this.nakama.noti_origin[t][n]&&delete this.nakama.noti_origin[t][n],this.nakama.rearrange_notifications(),this.nakama.channels_orig[t]&&this.nakama.channels_orig[t][n]&&Object.keys(this.nakama.channels_orig[t][n]).forEach(r=>{this.nakama.channels_orig[t][n][r].status="missing"}),this.nakama.rearrange_channels(),this.nakama.groups[t][n]&&Object.keys(this.nakama.groups[t][n]).forEach(r=>{this.nakama.groups[t][n][r].status="missing"}),this.servers=this.nakama.get_all_server_info(),delete this.statusBar.groupServer[t][n],this.indexed.saveTextFileToUserPath(JSON.stringify(this.statusBar.groupServer),"servers/list.json"),this.indexed.loadTextFromUserPath("servers/list_detail.csv",(o,r)=>{if(o){let u=r.split("\n");for(let g=0,J=u.length;g<J;g++)if(u[g].split(",")[3]==n){u.splice(g,1);break}this.indexed.saveTextFileToUserPath(u.join("\n"),"servers/list_detail.csv")}})}}return i.\u0275fac=function(t){return new(t||i)(e.Y36(v.a),e.Y36(_.F),e.Y36(f.g),e.Y36(k.H),e.Y36(S.b))},i.\u0275cmp=e.Xpm({type:i,selectors:[["app-group-server"]],decls:44,vars:32,consts:[["slot","start"],["defaultHref","settings"],["disabled","",1,"infobox",2,"height","250px",3,"ngModel","ngModelChange"],[4,"ngIf"],["button","",3,"click",4,"ngIf"],["button","",3,"click",4,"ngFor","ngForOf"],["button","",3,"disabled"],[1,"ion-text-right",3,"ngModel","placeholder","ngModelChange"],["disabled","",1,"ion-text-right",3,"ngModel","placeholder","ngModelChange"],["disabled","","type","number",1,"ion-text-right",3,"ngModel","placeholder","ngModelChange"],["button","",3,"disabled","click"],["slot","end",2,"pointer-events","none",3,"ngModel","ngModelChange"],[1,"ion-text-center"],["button","",3,"click"],[1,"additional_form","status_bar_single"],[1,"form_margin"],[3,"click"]],template:function(t,n){1&t&&(e.TgZ(0,"ion-header")(1,"ion-toolbar")(2,"ion-title"),e._uU(3),e.qZA(),e.TgZ(4,"ion-buttons",0),e._UZ(5,"ion-back-button",1),e.qZA()()(),e.TgZ(6,"ion-content")(7,"ion-item-divider")(8,"ion-label"),e._uU(9),e.qZA()(),e.TgZ(10,"textarea",2),e.NdJ("ngModelChange",function(r){return n.info=r}),e.qZA(),e.YNc(11,Z,3,1,"ion-item-divider",3),e.YNc(12,x,6,4,"ion-item",4),e.YNc(13,T,9,6,"ion-item",5),e.TgZ(14,"ion-item-divider")(15,"ion-label"),e._uU(16),e.qZA()(),e.TgZ(17,"ion-item",6)(18,"ion-label"),e._uU(19),e.qZA(),e.TgZ(20,"ion-input",7),e.NdJ("ngModelChange",function(r){return n.dedicated_info.name=r}),e.qZA()(),e.TgZ(21,"ion-item",6)(22,"ion-label"),e._uU(23),e.qZA(),e.TgZ(24,"ion-input",7),e.NdJ("ngModelChange",function(r){return n.dedicated_info.target=r}),e.qZA()(),e.TgZ(25,"ion-item",6)(26,"ion-label"),e._uU(27),e.qZA(),e.TgZ(28,"ion-input",7),e.NdJ("ngModelChange",function(r){return n.dedicated_info.address=r}),e.qZA()(),e.TgZ(29,"ion-item",6)(30,"ion-label"),e._uU(31),e.qZA(),e.TgZ(32,"ion-input",8),e.NdJ("ngModelChange",function(r){return n.dedicated_info.key=r}),e.qZA()(),e.TgZ(33,"ion-item",6)(34,"ion-label"),e._uU(35),e.qZA(),e.TgZ(36,"ion-input",9),e.NdJ("ngModelChange",function(r){return n.dedicated_info.port=r}),e.qZA()(),e.TgZ(37,"ion-item",10),e.NdJ("click",function(){return n.dedicated_info.useSSL=!n.dedicated_info.useSSL}),e.TgZ(38,"ion-label"),e._uU(39),e.qZA(),e.TgZ(40,"ion-toggle",11),e.NdJ("ngModelChange",function(r){return n.dedicated_info.useSSL=r}),e.qZA()(),e.TgZ(41,"ion-item",10),e.NdJ("click",function(){return n.add_custom_dedicated()}),e.TgZ(42,"ion-label",12),e._uU(43),e.qZA()()()),2&t&&(e.xp6(3),e.Oqu(n.lang.text.Settings.groupServer),e.xp6(6),e.Oqu(n.lang.text.GroupServer.AboutServerAndAccount),e.xp6(1),e.Q6J("ngModel",n.info),e.xp6(1),e.Q6J("ngIf",n.nakama.servers.official.default||n.servers.length),e.xp6(1),e.Q6J("ngIf",n.nakama.servers.official.default),e.xp6(1),e.Q6J("ngForOf",n.servers),e.xp6(3),e.Oqu(n.lang.text.GroupServer.RegisterServer),e.xp6(1),e.Q6J("disabled",n.add_custom_tog),e.xp6(2),e.Oqu(n.lang.text.GroupServer.DisplayName),e.xp6(1),e.Q6J("ngModel",n.dedicated_info.name)("placeholder",n.lang.text.GroupServer.DisplayName_placeholder),e.xp6(1),e.Q6J("disabled",n.add_custom_tog),e.xp6(2),e.Oqu(n.lang.text.GroupServer.DivisionName),e.xp6(1),e.Q6J("ngModel",n.dedicated_info.target)("placeholder",n.dedicated_info.name||n.lang.text.GroupServer.DivisionName_placeholder),e.xp6(1),e.Q6J("disabled",n.add_custom_tog),e.xp6(2),e.Oqu(n.lang.text.GroupServer.Address),e.xp6(1),e.Q6J("ngModel",n.dedicated_info.address)("placeholder","192.168.0.1"),e.xp6(1),e.Q6J("disabled",n.add_custom_tog),e.xp6(2),e.Oqu(n.lang.text.GroupServer.Key),e.xp6(1),e.Q6J("ngModel",n.dedicated_info.key)("placeholder","defaultkey"),e.xp6(1),e.Q6J("disabled",n.add_custom_tog),e.xp6(2),e.Oqu(n.lang.text.GroupServer.Port),e.xp6(1),e.Q6J("ngModel",n.dedicated_info.port)("placeholder","7350"),e.xp6(1),e.Q6J("disabled",n.add_custom_tog),e.xp6(2),e.Oqu(n.lang.text.GroupServer.isSSL),e.xp6(1),e.Q6J("ngModel",n.dedicated_info.useSSL),e.xp6(1),e.Q6J("disabled",n.add_custom_tog),e.xp6(2),e.Oqu(n.lang.text.GroupServer.submit))},directives:[a.Gu,a.sr,a.wd,a.Sm,a.oU,a.cs,a.W2,a.rH,a.Q$,l.Fj,l.JJ,l.On,p.O5,a.Ie,a.YG,p.sg,a.pK,a.j9,a.as,a.ho,a.w],styles:[""]}),i})()}];let M=(()=>{class i{}return i.\u0275fac=function(t){return new(t||i)},i.\u0275mod=e.oAB({type:i}),i.\u0275inj=e.cJS({imports:[[m.Bz.forChild(G)],m.Bz]}),i})(),b=(()=>{class i{}return i.\u0275fac=function(t){return new(t||i)},i.\u0275mod=e.oAB({type:i}),i.\u0275inj=e.cJS({imports:[[p.ez,l.u5,a.Pc,M]]}),i})()}}]);