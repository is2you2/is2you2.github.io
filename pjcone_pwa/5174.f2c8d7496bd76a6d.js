"use strict";(self.webpackChunkapp=self.webpackChunkapp||[]).push([[5174],{5174:(Z,u,l)=>{l.r(u),l.d(u,{WsclientPageModule:()=>C});var g=l(6814),d=l(95),o=l(1325),h=l(5877),m=l(5861),p=l(3641),t=l(9468),_=l(3857),f=l(7488);function v(n,a){if(1&n){const i=t.EpF();t.TgZ(0,"ion-item")(1,"ion-input",10),t.NdJ("ngModelChange",function(e){t.CHM(i);const c=t.oxw();return t.KtG(c.send_msg=e)})("keydown.enter",function(){t.CHM(i);const e=t.oxw();return t.KtG(e.send())}),t.qZA(),t.TgZ(2,"ion-button",11),t.NdJ("click",function(){t.CHM(i);const e=t.oxw();return t.KtG(e.send())}),t._uU(3),t.qZA()()}if(2&n){const i=t.oxw();t.xp6(1),t.Q6J("ngModel",i.send_msg)("placeholder",i.lang.text.WSClient.inputmsg),t.xp6(2),t.hij(" ",i.lang.text.WSClient.send," ")}}function W(n,a){if(1&n&&(t.TgZ(0,"div"),t._uU(1),t.qZA()),2&n){const i=a.$implicit;t.Akn("color: "+i.color),t.xp6(1),t.AsE(" ",i.time," ",i.text," ")}}const T=[{path:"",component:(()=>{var n;class a{constructor(s,e){this.lang=s,this.statusBar=e,this.status="offline",this.placeholder_address="ws://127.0.0.1:0000",this.logs=[]}ngOnInit(){this.logsDiv=document.getElementById("logs"),"https:"==window.location.protocol&&!p.bS&&(this.placeholder_address="wss://127.0.0.1:0000")}scroll_down(){setTimeout(()=>{this.logsDiv.scrollTo({top:this.logsDiv.scrollHeight,behavior:"smooth"})},0)}connect_to_server(){var s=this;"offline"===this.status?(this.client&&this.client.close(),this.status="pending",this.client=new WebSocket(this.address||this.placeholder_address),this.client.onopen=()=>{this.status="online",this.logs.push({text:`${this.lang.text.WSClient.Connected}: ${this.address||this.placeholder_address}`,time:this.createTimestamp(),color:"#34aa43"}),this.scroll_down()},this.client.onmessage=function(){var e=(0,m.Z)(function*(c){try{let r;r="string"==typeof c.data?c.data:yield c.data.text(),s.logs.push({text:`${s.lang.text.WSClient.Received}: ${r}`,time:s.createTimestamp()}),s.scroll_down()}catch(r){console.log("connect_to_server: ",r),s.logs.push({text:`${s.lang.text.WSClient.RecvError}: ${r}`,time:s.createTimestamp(),color:s.statusBar.colors.missing}),s.scroll_down()}});return function(c){return e.apply(this,arguments)}}(),this.client.onerror=e=>{console.log(e),this.logs.push({text:`${this.lang.text.WSClient.SocketError}: ${e.message||e}`,time:this.createTimestamp(),color:this.statusBar.colors.missing}),this.scroll_down()},this.client.onclose=()=>{this.logs.push({text:this.lang.text.WSClient.button_missing,time:this.createTimestamp(),color:this.statusBar.colors.missing}),this.scroll_down(),this.status="missing",setTimeout(()=>{this.status="offline"},500)}):this.client.close()}send(){this.client.send(this.send_msg),this.send_msg=""}createTimestamp(){let s=new Date;return`[${("0"+s.getHours()).slice(-2)}:${("0"+s.getMinutes()).slice(-2)}:${("0"+s.getSeconds()).slice(-2)}]`}ngOnDestroy(){this.client&&this.client.close()}}return(n=a).\u0275fac=function(s){return new(s||n)(t.Y36(_.b),t.Y36(f.g))},n.\u0275cmp=t.Xpm({type:n,selectors:[["app-wsclient"]],decls:22,vars:13,consts:[["slot","start"],["defaultHref","portal/settings"],["button","",3,"disabled"],[1,"additional_form","status_bar_single"],[1,"form_margin","ion-text-end",3,"label","placeholder","ngModel","ngModelChange"],["button","",3,"disabled","click"],[1,"ion-text-center"],[4,"ngIf"],["id","logs"],[3,"style",4,"ngFor","ngForOf"],[3,"ngModel","placeholder","ngModelChange","keydown.enter"],[3,"click"]],template:function(s,e){1&s&&(t.TgZ(0,"ion-header")(1,"ion-toolbar")(2,"ion-title"),t._uU(3),t.qZA(),t.TgZ(4,"ion-buttons",0),t._UZ(5,"ion-back-button",1),t.qZA()()(),t.TgZ(6,"ion-content")(7,"ion-item-divider")(8,"ion-label"),t._uU(9),t.qZA()(),t.TgZ(10,"ion-item",2),t._UZ(11,"div",3),t.TgZ(12,"ion-input",4),t.NdJ("ngModelChange",function(r){return e.address=r}),t.qZA()(),t.TgZ(13,"ion-item",5),t.NdJ("click",function(){return e.connect_to_server()}),t.TgZ(14,"ion-label",6),t._uU(15),t.qZA()(),t.YNc(16,v,4,3,"ion-item",7),t.TgZ(17,"ion-item-divider")(18,"ion-label"),t._uU(19),t.qZA()(),t.TgZ(20,"div",8),t.YNc(21,W,2,4,"div",9),t.qZA()()),2&s&&(t.xp6(3),t.Oqu(e.lang.text.Settings.WSClient),t.xp6(6),t.Oqu(e.lang.text.WSClient.connInfo),t.xp6(1),t.Q6J("disabled","offline"!=e.status),t.xp6(1),t.Akn("background-color: "+e.statusBar.colors[e.status]),t.xp6(1),t.Q6J("label",e.lang.text.WSClient.address)("placeholder",e.placeholder_address)("ngModel",e.address),t.xp6(1),t.Q6J("disabled","pending"==e.status||"missing"==e.status),t.xp6(2),t.Oqu(e.lang.text.WSClient["button_"+e.status]),t.xp6(1),t.Q6J("ngIf","online"==e.status),t.xp6(3),t.Oqu(e.lang.text.WSClient.logs),t.xp6(2),t.Q6J("ngForOf",e.logs))},dependencies:[g.sg,g.O5,d.JJ,d.On,o.oU,o.YG,o.Sm,o.W2,o.Gu,o.pK,o.Ie,o.rH,o.Q$,o.wd,o.sr,o.j9,o.cs],styles:["#logs[_ngcontent-%COMP%]{height:480px;overflow-y:scroll;background-color:var(--wsclient-logs-background);padding:8px}"]}),a})()}];let x=(()=>{var n;class a{}return(n=a).\u0275fac=function(s){return new(s||n)},n.\u0275mod=t.oAB({type:n}),n.\u0275inj=t.cJS({imports:[h.Bz.forChild(T),h.Bz]}),a})(),C=(()=>{var n;class a{}return(n=a).\u0275fac=function(s){return new(s||n)},n.\u0275mod=t.oAB({type:n}),n.\u0275inj=t.cJS({imports:[g.ez,d.u5,o.Pc,x]}),a})()}}]);