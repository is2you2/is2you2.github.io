"use strict";(self.webpackChunkapp=self.webpackChunkapp||[]).push([[488],{6069:(C,b,o)=>{o.d(b,{R:()=>T});var n=o(9863),d=o(3996),u=o(5742),x=o(9912),h=o(4182);let T=(()=>{class p{constructor(m,e,v,f){this.navParams=m,this.modalCtrl=e,this.lang=v,this.nakama=f,this.info="QR\ucf54\ub4dc \ub610\ub294 \ubc14\ucf54\ub4dc\ub97c \uc778\uc2dd\ud558\uc600\uc73c\ub098 \uc774 \uc571\uc5d0\uc11c \uc0ac\uc6a9\ud558\ub294 \uad6c\uc131\uc774 \uc544\ub2d9\ub2c8\ub2e4.",this.result={}}ngOnInit(){this.result=this.navParams.get("result"),this.nakama.removeBanner()}}return p.\u0275fac=function(m){return new(m||p)(n.Y36(d.X1),n.Y36(d.IN),n.Y36(u.b),n.Y36(x.a))},p.\u0275cmp=n.Xpm({type:p,selectors:[["app-qrelse"]],decls:22,vars:6,consts:[["slot","start",3,"click"],["defaultHref","subscribes"],["disabled","",1,"infobox",3,"ngModel","ngModelChange"]],template:function(m,e){1&m&&(n.TgZ(0,"ion-header")(1,"ion-toolbar")(2,"ion-title"),n._uU(3,"\ub0b4\uc6a9 \uc77d\uae30"),n.qZA(),n.TgZ(4,"ion-buttons",0),n.NdJ("click",function(){return e.modalCtrl.dismiss()}),n._UZ(5,"ion-back-button",1),n.qZA()()(),n.TgZ(6,"ion-content")(7,"ion-item-divider")(8,"ion-label"),n._uU(9),n.qZA()(),n.TgZ(10,"textarea",2),n.NdJ("ngModelChange",function(f){return e.lang.text.QRElse.info=f}),n.qZA(),n._UZ(11,"ion-item-divider"),n.TgZ(12,"ion-item")(13,"ion-label")(14,"p"),n._uU(15),n.qZA(),n.TgZ(16,"h2"),n._uU(17),n.qZA()()(),n.TgZ(18,"ion-item-divider")(19,"ion-label"),n._uU(20),n.qZA()(),n.TgZ(21,"textarea",2),n.NdJ("ngModelChange",function(f){return e.result.text=f}),n.qZA()()),2&m&&(n.xp6(9),n.Oqu(e.lang.text.QRElse.Title),n.xp6(1),n.Q6J("ngModel",e.lang.text.QRElse.info),n.xp6(5),n.Oqu(e.lang.text.QRElse.format),n.xp6(2),n.Oqu(e.result.format),n.xp6(3),n.Oqu(e.lang.text.QRElse.contents),n.xp6(1),n.Q6J("ngModel",e.result.text))},directives:[d.Gu,d.sr,d.wd,d.Sm,d.oU,d.cs,d.W2,d.rH,d.Q$,h.Fj,h.JJ,h.On,d.Ie],styles:[""]}),p})()},488:(C,b,o)=>{o.r(b),o.d(b,{SubscribesPageModule:()=>D});var n=o(9808),d=o(4182),u=o(3996),x=o(9705),h=o(5016),T=o(2722),p=o(8888),P=o(3041),m=o(6069),e=o(9863),v=o(9645),f=o(3336),k=o(4606);let A=(()=>{class s{constructor(t){this.statusBar=t,this.list={}}initialize(t,i,r,c){if(!this.statusBar.tools[t])throw new Error(`\uadf8\ub7f0 \ud234\uc740 \uc5c6\uc2b5\ub2c8\ub2e4: ${t}`);if(this.statusBar.tools[t]="pending","DesktopPWA"!=h.n$&&"MobilePWA"!=h.n$){if(null!=this.list[t])return void console.warn("\ub3d9\uc77c\ud55c \uc11c\ubc84 \uad6c\uc131\uc774 \uc774\ubbf8 \uc874\uc7ac\ud568: ",this.list);this.list[t]={},this.list[t].server||(this.list[t].server=cordova.plugins.wsserver),this.list[t].server.start(i,{onFailure:(l,g,_)=>{this.onServerClose(t)},onOpen:l=>{this.list[t].target==l.remoteAddr?this.list[t].users=l.uuid:(console.log("\ud5c8\uc6a9\ub418\uc9c0 \uc54a\uc740 \uc0ac\uc6a9\uc790: ",this.list[t].target,"/=",l.remoteAddr),this.list[t].server.close({uuid:l.uuid},4001,"\ud5c8\uc6a9\ub418\uc9c0 \uc54a\uc740 \uc0ac\uc6a9\uc790")),this.onClientConnected(t)},onMessage:(l,g)=>{try{let _=JSON.parse(g);c(_)}catch(_){console.error(`Tool-server_json \ubcc0\ud658 \uc624\ub958_${g}: ${_}`)}},onClose:(l,g,_,S)=>{this.stop(t)},origins:[],protocols:[],tcpNoDelay:!0},(l,g)=>{this.onServerOpen(t),r()},l=>{this.onServerClose(t)})}else this.onServerClose(t)}stop(t){"DesktopPWA"!=h.n$&&"MobilePWA"!=h.n$&&this.list[t].server.stop((i,r)=>{this.onServerClose(t),delete this.list[t]})}onServerOpen(t){console.log("test onServerOpen: ",t),this.statusBar.tools[t]="online"}onClientConnected(t){this.statusBar.tools[t]="certified"}onServerClose(t){this.statusBar.tools[t]="missing",setTimeout(()=>{this.statusBar.tools[t]="offline"},500)}check_addresses(t,i){"DesktopPWA"!=h.n$&&"MobilePWA"!=h.n$&&(this.list[t].server||(this.list[t].server=cordova.plugins.wsserver),this.list[t].server.getInterfaces(r=>{i(r)}))}send_to(t,i){let r=Object.keys(this.list[t].users)[0];this.list[t].server.send({uuid:r},i)}}return s.\u0275fac=function(t){return new(t||s)(e.LFG(k.g))},s.\u0275prov=e.Yz7({token:s,factory:s.\u0275fac,providedIn:"root"}),s})();var Z=o(2855);let O=(()=>{class s{constructor(t){this.wsc=t}initialize(t){this.client=new WebSocket(`${this.wsc.socket_header}://${this.wsc.address_override||h.GA}:12020`),this.client.onopen=r=>{this.client.send(JSON.stringify(t))},setTimeout(()=>{this.client.close()},5e3)}}return s.\u0275fac=function(t){return new(t||s)(e.LFG(Z.Z))},s.\u0275prov=e.Yz7({token:s,factory:s.\u0275fac,providedIn:"root"}),s})();var M=o(9912),w=o(5742);function y(s,a){if(1&s){const t=e.EpF();e.TgZ(0,"ion-item",10),e.NdJ("click",function(){e.CHM(t);const r=e.oxw().$implicit;return e.oxw(2).check_notifications(r)}),e.TgZ(1,"ion-label"),e._uU(2),e.qZA()()}if(2&s){const t=e.oxw().$implicit,i=e.oxw(2);e.xp6(2),e.Oqu(i.nakama.notifications_rearrange[t].request)}}function Q(s,a){if(1&s&&(e.TgZ(0,"div"),e.YNc(1,y,3,1,"ion-item",9),e.qZA()),2&s){const t=a.$implicit,i=e.oxw(2);e.xp6(1),e.Q6J("ngIf",i.nakama.notifications_rearrange.length>t)}}const R=function(){return[0,1,2]};function E(s,a){if(1&s&&(e.TgZ(0,"ion-accordion-group",3,4)(2,"ion-accordion",5)(3,"ion-item",6)(4,"ion-label"),e._uU(5),e.qZA()(),e.TgZ(6,"ion-list",7),e.YNc(7,Q,2,1,"div",8),e.qZA()()()),2&s){const t=e.oxw();e.Q6J("value",!1),e.xp6(5),e.Oqu(t.lang.text.Subscribes.has_noties),e.xp6(2),e.Q6J("ngForOf",e.DdM(3,R))}}function I(s,a){if(1&s){const t=e.EpF();e.TgZ(0,"div")(1,"ion-item-divider")(2,"ion-label"),e._uU(3),e.qZA()(),e.TgZ(4,"ion-item",10),e.NdJ("click",function(){return e.CHM(t),e.oxw().scanQRCode()}),e.TgZ(5,"ion-label",11),e._uU(6),e.qZA()()()}if(2&s){const t=e.oxw();e.xp6(3),e.Oqu(t.lang.text.Subscribes.almighty_link),e.xp6(3),e.Oqu(t.lang.text.Subscribes.almighty_button)}}function J(s,a){if(1&s&&(e.TgZ(0,"ion-item",12)(1,"ion-label"),e._uU(2),e.qZA()()),2&s){const t=e.oxw();e.xp6(2),e.Oqu(t.lang.text.Subscribes.noChatList)}}function U(s,a){1&s&&e._UZ(0,"div",21)}function $(s,a){if(1&s&&e._UZ(0,"img",22),2&s){const t=e.oxw().$implicit;e.Akn("online"==t.status?"filter: grayscale(0) contrast(1)":"filter: grayscale(.9) contrast(1.4)"),e.Q6J("src",t.info.img,e.LSH)}}function Y(s,a){if(1&s){const t=e.EpF();e.TgZ(0,"ion-item",10),e.NdJ("click",function(){const c=e.CHM(t).$implicit;return e.oxw(2).go_to_chatroom(c)}),e.TgZ(1,"div",14),e.YNc(2,U,1,0,"div",15),e.qZA(),e.TgZ(3,"div",16),e.YNc(4,$,1,3,"img",17),e.qZA(),e.TgZ(5,"ion-label")(6,"div",18)(7,"table")(8,"tr")(9,"td"),e._uU(10),e.qZA(),e.TgZ(11,"td",19),e._uU(12),e.qZA()()()(),e.TgZ(13,"div",20),e._uU(14),e.qZA()()()}if(2&s){const t=a.$implicit,i=e.oxw(2);e.xp6(1),e.Akn("background-color: "+i.statusBar.colors[t.status||"offline"]),e.xp6(1),e.Q6J("ngIf",t.is_new),e.xp6(2),e.Q6J("ngIf",t.info),e.xp6(6),e.hij(" ",t.info?t.info.name||t.info.display_name||i.lang.text.Subscribes.noTitiedChat:t.title||i.lang.text.Subscribes.noTitiedChat," "),e.xp6(2),e.hij(" ","("+t.server.target+")"," "),e.xp6(2),e.hij(" ",t.last_comment||t.noti||i.lang.text.Subscribes.noMessageHistory," ")}}function B(s,a){if(1&s&&(e.TgZ(0,"div"),e.YNc(1,Y,15,7,"ion-item",13),e.qZA()),2&s){const t=e.oxw();e.xp6(1),e.Q6J("ngForOf",t.nakama.channels)}}const N=[{path:"",component:(()=>{class s{constructor(t,i,r,c,l,g,_,S,F){this.modalCtrl=t,this.codescan=i,this.p5toast=r,this.tools=c,this.weblink=l,this.nakama=g,this.statusBar=_,this.wsc=S,this.lang=F,this.cant_scan=!1,this.lock_chatroom=!1}ngOnInit(){("DesktopPWA"==h.n$||"MobilePWA"==h.n$)&&(this.cant_scan=!0)}ionViewDidEnter(){this.nakama.subscribe_lock=!0,this.nakama.resumeBanner()}scanQRCode(){this.codescan.scan({disableSuccessBeep:!0,disableAnimations:!0,resultDisplayDuration:0}).then(t=>{if(!t.cancelled)try{let i=JSON.parse(t.text.trim());for(let r=0,c=i.length;r<c;r++)switch(i[r].type){case"link":if(!this.check_comm_server_is_online())return;this.weblink.initialize({pid:i[r].value,uuid:this.nakama.uuid});break;case"tools":if(!this.check_comm_server_is_online())return;this.create_tool_server(i[r].value);break;case"server":return void this.modalCtrl.create({component:p.P,componentProps:{data:i[r].value}}).then(l=>l.present());case"comm_server":this.wsc.client.close(),this.wsc.socket_header=i[r].value.useSSL?"wss":"ws",localStorage.setItem("wsc_socket_header",this.wsc.socket_header),this.wsc.address_override=i[r].value.address_override.replace(/[^0-9.]/g,""),localStorage.setItem("wsc_address_override",this.wsc.address_override),this.wsc.initialize();break;case"group_dedi":this.modalCtrl.create({component:T.X,componentProps:{address:i[r].value.address,name:this.nakama.users.self.display_name}}).then(l=>{l.present()});break;case"group":this.nakama.try_add_group(i[r]);break;default:throw new Error("\uc9c0\uc815\ub41c \ud2c0 \uc544\ub2d8")}}catch(i){console.error("scanQRCode_failed: ",i),this.modalCtrl.create({component:m.R,componentProps:{result:t}}).then(r=>r.present())}}).catch(t=>{console.error(t),this.p5toast.show({text:this.lang.text.Subscribes.CameraPermissionDenied,lateable:!0})})}check_comm_server_is_online(){let t=this.wsc.client.readyState==this.wsc.client.OPEN;return t||this.p5toast.show({text:this.lang.text.Subscribes.needLinkWithCommServ}),t}create_tool_server(t){let i,r=c=>console.warn(`${t.name}_create_tool_server_onMessage: ${c}`);if("engineppt"!==t.name)throw new Error(`\uc9c0\uc815\ub41c \ud234 \uc815\ubcf4\uac00 \uc544\ub2d8: ${t}`);i=12021,r=c=>{console.log("engineppt init test: ",c)},this.tools.initialize(t.name,12021,()=>{this.tools.check_addresses(t.name,c=>{let l=Object.keys(c),g=[];for(let _=0,S=l.length;_<S;_++)g=[...g,...c[l[_]].ipv4Addresses];this.weblink.initialize({from:"mobile",pid:t.client,addresses:g})})},r)}go_to_chatroom(t){this.lock_chatroom||(this.lock_chatroom=!0,this.modalCtrl.create({component:P.P,componentProps:{info:t}}).then(i=>{this.nakama.go_to_chatroom_without_admob_act(i),this.lock_chatroom=!1}))}check_notifications(t){let i=this.nakama.notifications_rearrange[t].server;this.nakama.check_notifications(this.nakama.notifications_rearrange[t],i.isOfficial,i.target)}ionViewWillLeave(){this.nakama.subscribe_lock=!1}}return s.\u0275fac=function(t){return new(t||s)(e.Y36(u.IN),e.Y36(v.m),e.Y36(f.F),e.Y36(A),e.Y36(O),e.Y36(M.a),e.Y36(k.g),e.Y36(Z.Z),e.Y36(w.b))},s.\u0275cmp=e.Xpm({type:s,selectors:[["app-subscribes"]],decls:12,vars:6,consts:[["value","colors","expand","inset",3,"value",4,"ngIf"],[4,"ngIf"],["button","","disabled","",4,"ngIf"],["value","colors","expand","inset",3,"value"],["accordionGroup",""],["value","colors"],["slot","header"],["slot","content"],[4,"ngFor","ngForOf"],["button","",3,"click",4,"ngIf"],["button","",3,"click"],[1,"ion-text-center"],["button","","disabled",""],["button","",3,"click",4,"ngFor","ngForOf"],[1,"additional_form","status_bar_double"],["class","new_circle",4,"ngIf"],[1,"additional_form","bg_img_form"],["class","profile_img",3,"style","src",4,"ngIf"],[1,"form_margin","header"],[1,"server_target"],[1,"form_margin","content"],[1,"new_circle"],[1,"profile_img",3,"src"]],template:function(t,i){1&t&&(e.TgZ(0,"ion-header")(1,"ion-toolbar")(2,"ion-title"),e._uU(3),e.qZA()()(),e.TgZ(4,"ion-content"),e.YNc(5,E,8,4,"ion-accordion-group",0),e.YNc(6,I,7,2,"div",1),e.TgZ(7,"ion-item-divider")(8,"ion-label"),e._uU(9),e.qZA()(),e.YNc(10,J,3,1,"ion-item",2),e.YNc(11,B,2,1,"div",1),e.qZA()),2&t&&(e.xp6(3),e.Oqu(i.lang.text.Subscribes.Title),e.xp6(2),e.Q6J("ngIf",i.nakama.notifications_rearrange.length),e.xp6(1),e.Q6J("ngIf",!i.cant_scan),e.xp6(3),e.Oqu(i.lang.text.Subscribes.Chat),e.xp6(1),e.Q6J("ngIf",!i.nakama.channels.length),e.xp6(1),e.Q6J("ngIf",i.nakama.channels.length))},directives:[u.Gu,u.sr,u.wd,u.W2,n.O5,u.eh,u.We,u.Ie,u.Q$,u.q_,n.sg,u.rH],styles:[".header[_ngcontent-%COMP%]{padding-bottom:4px}.content[_ngcontent-%COMP%]{color:#888;height:24px;display:table-cell;vertical-align:middle;padding:0 16px}.status_bar[_ngcontent-%COMP%]{width:5px;height:76%}.server_target[_ngcontent-%COMP%]{color:#888;padding-left:4px}.new_circle[_ngcontent-%COMP%]{position:relative;top:-5px;left:9px;width:8px;height:8px;border-radius:4px;background:#ff4961}"]}),s})()},{path:"chat-room",loadChildren:()=>o.e(9340).then(o.bind(o,9340)).then(s=>s.ChatRoomPageModule)},{path:"qrelse",loadChildren:()=>o.e(1388).then(o.bind(o,1388)).then(s=>s.QRelsePageModule)}];let W=(()=>{class s{}return s.\u0275fac=function(t){return new(t||s)},s.\u0275mod=e.oAB({type:s}),s.\u0275inj=e.cJS({imports:[[x.Bz.forChild(N)],x.Bz]}),s})(),D=(()=>{class s{}return s.\u0275fac=function(t){return new(t||s)},s.\u0275mod=e.oAB({type:s}),s.\u0275inj=e.cJS({imports:[[n.ez,d.u5,u.Pc,W]]}),s})()}}]);