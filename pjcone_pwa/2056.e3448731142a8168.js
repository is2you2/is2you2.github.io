"use strict";(self.webpackChunkapp=self.webpackChunkapp||[]).push([[2056],{2056:(b,l,i)=>{i.r(l),i.d(l,{LinkAccountPageModule:()=>R});var u=i(9808),h=i(4182),o=i(3996),d=i(9705),g=i(5016),t=i(9863),v=i(3336),m=i(9912),k=i(2855),A=i(3496),f=i(2463),p=i(5742),L=i(1282);function x(e,a){if(1&e&&t._UZ(0,"img",4),2&e){const n=t.oxw();t.Q6J("src",n.QRCodeSRC,t.LSH)}}const r="LinkAccount",C=[{path:"",component:(()=>{class e{constructor(n,s,c,Z,y,O,S,T){this.p5toast=n,this.nakama=s,this.navCtrl=c,this.wsc=Z,this.indexed=y,this.device=O,this.lang=S,this.global=T}ngOnInit(){this.wsc.disconnected[r]=()=>{this.navCtrl.back()},this.indexed.checkIfFileExist("link-account",n=>{this.isOverrided=n}),this.websocket=new WebSocket(`${this.wsc.socket_header}://${this.wsc.address_override||g.GA}:12020`),this.websocket.onmessage=n=>{n.data.text().then(s=>{try{let c=JSON.parse(s);if(!c.uuid)throw new Error("uuid \ubc1b\uae30 \uc2e4\ud328");this.nakama.uuid=c.uuid,this.indexed.saveTextFileToUserPath(this.nakama.uuid,"link-account"),this.p5toast.show({text:this.lang.text.LinkAccount.link_account_succ,lateable:!0}),this.nakama.logout_all_server(),this.nakama.users.self.online=!0,this.nakama.init_all_sessions(),setTimeout(()=>{this.navCtrl.back()},500)}catch(c){this.QRCodeSRC=this.global.readasQRCodeFromId({type:"link",value:s})}})}}removeOverrideDeviceId(){this.isOverrided=!1,this.nakama.uuid=this.device.uuid,this.indexed.removeFileFromUserPath("link-account"),this.nakama.logout_all_server()}ionViewWillLeave(){delete this.wsc.disconnected[r],this.websocket.close()}}return e.\u0275fac=function(n){return new(n||e)(t.Y36(v.F),t.Y36(m.a),t.Y36(o.SH),t.Y36(k.Z),t.Y36(A.H),t.Y36(f.A),t.Y36(p.b),t.Y36(L.A))},e.\u0275cmp=t.Xpm({type:e,selectors:[["app-link-account"]],decls:17,vars:6,consts:[["slot","start"],["defaultHref","settings"],["style","width: 100%; height: auto;","alt","QRCodeSRC",3,"src",4,"ngIf"],["button","",3,"disabled","click"],["alt","QRCodeSRC",2,"width","100%","height","auto",3,"src"]],template:function(n,s){1&n&&(t.TgZ(0,"ion-header")(1,"ion-toolbar")(2,"ion-title"),t._uU(3),t.qZA(),t.TgZ(4,"ion-buttons",0),t._UZ(5,"ion-back-button",1),t.qZA()()(),t.TgZ(6,"ion-content")(7,"ion-item-divider")(8,"ion-label"),t._uU(9),t.qZA()(),t.YNc(10,x,1,1,"img",2),t.TgZ(11,"ion-item-divider")(12,"ion-label"),t._uU(13),t.qZA()(),t.TgZ(14,"ion-item",3),t.NdJ("click",function(){return s.removeOverrideDeviceId()}),t.TgZ(15,"ion-label"),t._uU(16),t.qZA()()()),2&n&&(t.xp6(3),t.Oqu(s.lang.text.Settings.takeOverUser),t.xp6(6),t.Oqu(s.lang.text.LinkAccount.use_almighty_button_to),t.xp6(1),t.Q6J("ngIf",s.QRCodeSRC),t.xp6(3),t.Oqu(s.lang.text.LinkAccount.Recovery),t.xp6(1),t.Q6J("disabled",!s.isOverrided),t.xp6(2),t.Oqu(s.lang.text.LinkAccount.recovery_device_id))},directives:[o.Gu,o.sr,o.wd,o.Sm,o.oU,o.cs,o.W2,o.rH,o.Q$,u.O5,o.Ie],styles:[""]}),e})()}];let P=(()=>{class e{}return e.\u0275fac=function(n){return new(n||e)},e.\u0275mod=t.oAB({type:e}),e.\u0275inj=t.cJS({imports:[[d.Bz.forChild(C)],d.Bz]}),e})(),R=(()=>{class e{}return e.\u0275fac=function(n){return new(n||e)},e.\u0275mod=t.oAB({type:e}),e.\u0275inj=t.cJS({imports:[[u.ez,h.u5,o.Pc,P]]}),e})()}}]);