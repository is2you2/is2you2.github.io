"use strict";(self.webpackChunkapp=self.webpackChunkapp||[]).push([[4156],{4156:(y,I,_)=>{_.d(I,{$:()=>k});var c=_(5861),g=_(3641),m=_(9761),e=_(9468),a=_(1325),h=_(3857),f=_(797),x=_(6052),M=_(4663),T=_(9376),p=_(6814),v=_(95);const b=["VideoIn"],C=["AudioIn"],O=["AudioOut"],A=["RegisterNewWebRTCServer"];function D(o,s){if(1&o&&(e.TgZ(0,"ion-item")(1,"ion-label"),e._uU(2),e.qZA(),e._UZ(3,"ion-radio",14),e.qZA()),2&o){const i=s.$implicit,t=s.index;e.xp6(2),e.Oqu(i.label||i.deviceId),e.xp6(1),e.Q6J("value",t)}}function W(o,s){if(1&o&&(e.TgZ(0,"div")(1,"ion-item-divider")(2,"ion-label"),e._uU(3),e.qZA()(),e.TgZ(4,"ion-radio-group",11,12),e.YNc(6,D,4,2,"ion-item",13),e.qZA()()),2&o){const i=e.oxw();e.xp6(3),e.Oqu(i.lang.text.WebRTCDevManager.VideoIn),e.xp6(3),e.Q6J("ngForOf",i.VideoInputs)}}function Z(o,s){if(1&o&&(e.TgZ(0,"ion-item")(1,"ion-label"),e._uU(2),e.qZA(),e._UZ(3,"ion-radio",14),e.qZA()),2&o){const i=s.$implicit,t=s.index;e.xp6(2),e.Oqu(i.label||i.deviceId),e.xp6(1),e.Q6J("value",t)}}function P(o,s){if(1&o&&(e.TgZ(0,"div")(1,"ion-item-divider")(2,"ion-label"),e._uU(3),e.qZA()(),e.TgZ(4,"ion-radio-group",15,16),e.YNc(6,Z,4,2,"ion-item",13),e.qZA()()),2&o){const i=e.oxw();e.xp6(3),e.Oqu(i.lang.text.WebRTCDevManager.AudioIn),e.xp6(3),e.Q6J("ngForOf",i.AudioInputs)}}function S(o,s){if(1&o){const i=e.EpF();e.TgZ(0,"ion-item",7),e.NdJ("click",function(){e.CHM(i);const n=e.oxw();return e.KtG(n.saveSetup())}),e.TgZ(1,"ion-label",8),e._uU(2),e.qZA()()}if(2&o){const i=e.oxw();e.xp6(2),e.Oqu(i.lang.text.WebRTCDevManager.saveSetup)}}function R(o,s){if(1&o){const i=e.EpF();e.TgZ(0,"img",21),e.NdJ("click",function(){e.CHM(i);const n=e.oxw().index,r=e.oxw();return e.KtG(r.copy_info(n))}),e.qZA()}if(2&o){const i=e.oxw().index,t=e.oxw();e.Q6J("src",t.QRCodes[i],e.LSH)}}function U(o,s){if(1&o){const i=e.EpF();e.TgZ(0,"ion-accordion",14)(1,"ion-item",17)(2,"ion-label"),e._uU(3),e.qZA()(),e.TgZ(4,"div",18),e.YNc(5,R,1,1,"img",19),e.TgZ(6,"ion-item",7),e.NdJ("click",function(){const r=e.CHM(i).index,l=e.oxw();return e.KtG(l.RemoveServer(r))}),e.TgZ(7,"ion-label",20),e._uU(8),e.qZA()()()()}if(2&o){const i=s.$implicit,t=s.index,n=e.oxw();e.Q6J("value",t),e.xp6(3),e.Oqu(i.urls[0]),e.xp6(2),e.Q6J("ngIf",n.QRCodes[t]),e.xp6(3),e.Oqu(n.lang.text.WebRTCDevManager.Remove)}}function E(o,s){if(1&o){const i=e.EpF();e.TgZ(0,"ion-icon",27),e.NdJ("click",function(){e.CHM(i);const n=e.oxw(3);return e.KtG(n.AddServerUrl())}),e.qZA()}}function J(o,s){if(1&o){const i=e.EpF();e.TgZ(0,"ion-icon",28),e.NdJ("click",function(){e.CHM(i);const n=e.oxw().$implicit,r=e.oxw(2);return e.KtG(r.SubtractServerUrl(n))}),e.qZA()}}function N(o,s){if(1&o){const i=e.EpF();e.TgZ(0,"ion-item")(1,"ion-input",24),e.NdJ("ngModelChange",function(n){const l=e.CHM(i).$implicit,u=e.oxw(2);return e.KtG(u.userInput.urls[l]=n)}),e.qZA(),e.YNc(2,E,1,0,"ion-icon",25),e.YNc(3,J,1,0,"ion-icon",26),e.qZA()}if(2&o){const i=s.$implicit,t=e.oxw(2);e.xp6(1),e.Q6J("label",0==i?t.lang.text.WebRTCDevManager.Urls:"")("ngModel",t.userInput.urls[i]),e.xp6(1),e.Q6J("ngIf",0==i),e.xp6(1),e.Q6J("ngIf",0!=i)}}function w(o,s){if(1&o){const i=e.EpF();e.TgZ(0,"ion-content")(1,"ion-item-divider")(2,"ion-label"),e._uU(3),e.qZA()(),e.YNc(4,N,4,4,"ion-item",13),e.TgZ(5,"ion-item")(6,"ion-input",22),e.NdJ("ngModelChange",function(n){e.CHM(i);const r=e.oxw();return e.KtG(r.userInput.username=n)}),e.qZA()(),e.TgZ(7,"ion-item")(8,"ion-input",23),e.NdJ("ngModelChange",function(n){e.CHM(i);const r=e.oxw();return e.KtG(r.userInput.credential=n)}),e.qZA()(),e.TgZ(9,"ion-item",7),e.NdJ("click",function(){e.CHM(i);const n=e.oxw();return e.KtG(n.SaveServer())}),e.TgZ(10,"ion-label",8),e._uU(11),e.qZA()()()}if(2&o){const i=e.oxw();e.xp6(3),e.Oqu(i.lang.text.WebRTCDevManager.ServerInfo),e.xp6(1),e.Q6J("ngForOf",i.UserInputUrlsLength),e.xp6(2),e.Q6J("label",i.lang.text.WebRTCDevManager.Username)("ngModel",i.userInput.username),e.xp6(2),e.Q6J("label",i.lang.text.WebRTCDevManager.Credential)("ngModel",i.userInput.credential),e.xp6(3),e.Oqu(i.lang.text.WebRTCDevManager.Save)}}const Q=function(){return[.5,.6,.7,.8,.9,1]};let k=(()=>{var o;class s{constructor(t,n,r,l,u,d,q){this.navParams=t,this.modalCtrl=n,this.lang=r,this.indexed=l,this.global=u,this.mClipboard=d,this.p5toast=q,this.InOut=[],this.VideoInputs=[],this.AudioInputs=[],this.AudioOutputs=[],this.ServerInfos=[],this.QRCodes=[],this.userInput={urls:[""],username:"",credential:""},this.UserInputUrlsLength=[0]}ngOnInit(){this.InOut=this.navParams.get("list")||[];for(let t=0,n=this.InOut.length;t<n;t++)this.InOut[t].kind.indexOf("videoinput")>=0&&this.VideoInputs.push(this.InOut[t]),this.InOut[t].kind.indexOf("audioinput")>=0&&this.AudioInputs.push(this.InOut[t]),this.InOut[t].kind.indexOf("audiooutput")>=0&&this.AudioOutputs.push(this.InOut[t])}ionViewWillEnter(){var t=this;return(0,c.Z)(function*(){try{let n=yield t.indexed.loadTextFromUserPath("servers/webrtc_server.json");t.ServerInfos=JSON.parse(n);for(let r=0,l=t.ServerInfos.length;r<l;r++){let d=t.global.readasQRCodeFromString(`${g.Oy}pjcone_pwa/?rtcserver=[${t.ServerInfos[r].urls}],${t.ServerInfos[r].username},${t.ServerInfos[r].credential}`);t.QRCodes[r]=d}}catch{}try{let n=localStorage.getItem("VideoInputDev");t.VideoInput.value=Number(n)||0}catch{}try{let n=localStorage.getItem("AudioInputDev");t.AudioInput.value=Number(n)||0}catch{}})()}ionViewDidEnter(){this.global.p5key.KeyShortCut.AddAct=()=>{this.OpenNewWebRTCServerForm()}}saveSetup(){let t={};this.VideoInput&&void 0!==this.VideoInput.value&&(t.videoinput=this.VideoInputs[this.VideoInput.value],localStorage.setItem("VideoInputDev",this.VideoInput.value)),this.AudioInput&&void 0!==this.AudioInput.value&&(t.audioinput=this.AudioInputs[this.AudioInput.value],localStorage.setItem("AudioInputDev",this.AudioInput.value)),this.AudioOutput&&void 0!==this.AudioOutput.value&&(t.audiooutput=this.AudioOutputs[this.AudioOutput.value]),this.modalCtrl.dismiss(t)}AddServerUrl(){this.userInput.urls.push(""),this.UserInputUrlsLength.push(this.UserInputUrlsLength.length)}SubtractServerUrl(t){this.userInput.urls.splice(t,1),this.UserInputUrlsLength.pop()}OpenNewWebRTCServerForm(){this.RegisterServer.present()}SaveServer(){var t=this;return(0,c.Z)(function*(){t.userInput.urls.filter(l=>l);for(let l=t.userInput.urls.length-1;l>=0;l--)t.userInput.urls[l].trim()||t.userInput.urls.splice(l,1);if(!t.userInput.urls.length)return void t.p5toast.show({text:t.lang.text.WebRTCDevManager.IgnoreSave});let r=t.global.readasQRCodeFromString(`${g.Oy}pjcone_pwa/?rtcserver=[${t.userInput.urls}],${t.userInput.username},${t.userInput.credential}`);t.QRCodes.push(r),t.ServerInfos.push(t.userInput),t.userInput={urls:[""],username:"",credential:""},t.UserInputUrlsLength.length=0,t.UserInputUrlsLength.push(0),yield t.indexed.saveTextFileToUserPath(JSON.stringify(t.ServerInfos),"servers/webrtc_server.json"),t.RegisterServer.dismiss()})()}copy_info(t){let n=`${g.Oy}pjcone_pwa/?rtcserver=[${this.ServerInfos[t].urls}],${this.ServerInfos[t].username},${this.ServerInfos[t].credential}`;this.mClipboard.copy(n).catch(r=>m.Z.write(n))}RemoveServer(t){var n=this;return(0,c.Z)(function*(){n.ServerInfos.splice(t,1),yield n.indexed.saveTextFileToUserPath(JSON.stringify(n.ServerInfos),"servers/webrtc_server.json")})()}ionViewWillLeave(){delete this.global.p5key.KeyShortCut.AddAct}}return(o=s).\u0275fac=function(t){return new(t||o)(e.Y36(a.X1),e.Y36(a.IN),e.Y36(h.b),e.Y36(f.H),e.Y36(x.AN),e.Y36(M.T),e.Y36(T.F))},o.\u0275cmp=e.Xpm({type:o,selectors:[["app-webrtc-manage-io-dev"]],viewQuery:function(t,n){if(1&t&&(e.Gf(b,5),e.Gf(C,5),e.Gf(O,5),e.Gf(A,5)),2&t){let r;e.iGM(r=e.CRH())&&(n.VideoInput=r.first),e.iGM(r=e.CRH())&&(n.AudioInput=r.first),e.iGM(r=e.CRH())&&(n.AudioOutput=r.first),e.iGM(r=e.CRH())&&(n.RegisterServer=r.first)}},decls:22,vars:10,consts:[[1,"ion-no-border"],["slot","start",3,"click"],["defaultHref",""],[4,"ngIf"],["button","",3,"click",4,"ngIf"],["WebRTCServers",""],[3,"value",4,"ngFor","ngForOf"],["button","",3,"click"],[1,"ion-text-center"],[3,"initialBreakpoint","breakpoints"],["RegisterNewWebRTCServer",""],["name","videoinput"],["VideoIn",""],[4,"ngFor","ngForOf"],[3,"value"],["name","audioinput"],["AudioIn",""],["button","","slot","header"],["slot","content"],["style","width: 100%; height: auto;","alt","Loading",3,"src","click",4,"ngIf"],["color","danger",1,"ion-text-center"],["alt","Loading",2,"width","100%","height","auto",3,"src","click"],["placeholder","username",1,"ion-text-end",3,"label","ngModel","ngModelChange"],["placeholder","credential",1,"ion-text-end",3,"label","ngModel","ngModelChange"],["placeholder","stun:stun.l.google.com:19302",1,"ion-text-end",3,"label","ngModel","ngModelChange"],["slot","end","color","success","name","add-circle-outline",3,"click",4,"ngIf"],["slot","end","color","danger","name","remove-circle-outline",3,"click",4,"ngIf"],["slot","end","color","success","name","add-circle-outline",3,"click"],["slot","end","color","danger","name","remove-circle-outline",3,"click"]],template:function(t,n){1&t&&(e.TgZ(0,"ion-header",0)(1,"ion-toolbar")(2,"ion-title"),e._uU(3),e.qZA(),e.TgZ(4,"ion-buttons",1),e.NdJ("click",function(){return n.modalCtrl.dismiss()}),e._UZ(5,"ion-back-button",2),e.qZA()()(),e.TgZ(6,"ion-content"),e.YNc(7,W,7,2,"div",3),e.YNc(8,P,7,2,"div",3),e.YNc(9,S,3,1,"ion-item",4),e.TgZ(10,"ion-item-divider")(11,"ion-label"),e._uU(12),e.qZA()(),e.TgZ(13,"ion-accordion-group",null,5),e.YNc(15,U,9,4,"ion-accordion",6),e.qZA(),e.TgZ(16,"ion-item",7),e.NdJ("click",function(){return n.OpenNewWebRTCServerForm()}),e.TgZ(17,"ion-label",8),e._uU(18),e.qZA()(),e.TgZ(19,"ion-modal",9,10),e.YNc(21,w,12,7,"ng-template"),e.qZA()()),2&t&&(e.xp6(3),e.Oqu(n.lang.text.WebRTCDevManager.Title),e.xp6(4),e.Q6J("ngIf",n.VideoInputs.length),e.xp6(1),e.Q6J("ngIf",n.AudioInputs.length),e.xp6(1),e.Q6J("ngIf",n.InOut.length),e.xp6(3),e.Oqu(n.lang.text.WebRTCDevManager.ManageServer),e.xp6(3),e.Q6J("ngForOf",n.ServerInfos),e.xp6(3),e.Oqu(n.lang.text.WebRTCDevManager.AddServer),e.xp6(1),e.Q6J("initialBreakpoint",.5)("breakpoints",e.DdM(9,Q)))},dependencies:[p.sg,p.O5,v.JJ,v.On,a.We,a.eh,a.oU,a.Sm,a.W2,a.Gu,a.gu,a.pK,a.Ie,a.rH,a.Q$,a.B7,a.se,a.wd,a.sr,a.ki,a.U5,a.QI,a.j9,a.cs]}),s})()}}]);