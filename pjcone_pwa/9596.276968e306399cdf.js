"use strict";(self.webpackChunkapp=self.webpackChunkapp||[]).push([[9596],{9596:(N,v,l)=>{l.d(v,{I:()=>K});var d=l(1528),c=l(5193),m=l(2272),e=l(4496),h=l(9240),a=l(5624),C=l(4500),f=l(4668),O=l(5020),b=l(7756),M=l(3824),R=l(7136),I=l(1368),p=l(4716);const E=["VideoIn"],D=["AudioIn"],G=["AudioOut"],T=["RegisterNewWebRTCServer"];function P(o,s){if(1&o&&(e.I0R(0,"ion-item")(1,"ion-label"),e.OEk(2),e.C$Y(),e.wR5(3,"ion-radio",14),e.C$Y()),2&o){const i=s.$implicit,t=s.index;e.yG2(2),e.cNF(i.label||i.deviceId),e.yG2(),e.E7m("value",t)}}function W(o,s){if(1&o&&(e.I0R(0,"div")(1,"ion-item-divider")(2,"ion-label"),e.OEk(3),e.C$Y()(),e.I0R(4,"ion-radio-group",11,12),e.yuY(6,P,4,2,"ion-item",13),e.C$Y()()),2&o){const i=e.GaO();e.yG2(3),e.cNF(i.lang.text.WebRTCDevManager.VideoIn),e.yG2(3),e.E7m("ngForOf",i.VideoInputs)}}function y(o,s){if(1&o&&(e.I0R(0,"ion-item")(1,"ion-label"),e.OEk(2),e.C$Y(),e.wR5(3,"ion-radio",14),e.C$Y()),2&o){const i=s.$implicit,t=s.index;e.yG2(2),e.cNF(i.label||i.deviceId),e.yG2(),e.E7m("value",t)}}function S(o,s){if(1&o&&(e.I0R(0,"div")(1,"ion-item-divider")(2,"ion-label"),e.OEk(3),e.C$Y()(),e.I0R(4,"ion-radio-group",15,16),e.yuY(6,y,4,2,"ion-item",13),e.C$Y()()),2&o){const i=e.GaO();e.yG2(3),e.cNF(i.lang.text.WebRTCDevManager.AudioIn),e.yG2(3),e.E7m("ngForOf",i.AudioInputs)}}function A(o,s){if(1&o){const i=e.KQA();e.I0R(0,"ion-item",7),e.qCj("click",function(){e.usT(i);const n=e.GaO();return e.CGJ(n.saveSetup())}),e.I0R(1,"ion-label",8),e.OEk(2),e.C$Y()()}if(2&o){const i=e.GaO();e.yG2(2),e.cNF(i.lang.text.WebRTCDevManager.saveSetup)}}function k(o,s){if(1&o){const i=e.KQA();e.I0R(0,"img",21),e.qCj("click",function(){e.usT(i);const n=e.GaO().index,r=e.GaO();return e.CGJ(r.copy_info(n))}),e.C$Y()}if(2&o){const i=e.GaO().index,t=e.GaO();e.E7m("src",t.QRCodes[i],e.K6U)}}function x(o,s){if(1&o){const i=e.KQA();e.I0R(0,"ion-accordion",14)(1,"ion-item",17)(2,"ion-label"),e.OEk(3),e.C$Y()(),e.I0R(4,"div",18),e.yuY(5,k,1,1,"img",19),e.I0R(6,"ion-item",7),e.qCj("click",function(){const r=e.usT(i).index,u=e.GaO();return e.CGJ(u.RemoveServer(r))}),e.I0R(7,"ion-label",20),e.OEk(8),e.C$Y()()()()}if(2&o){const i=s.$implicit,t=s.index,n=e.GaO();e.E7m("value",t),e.yG2(3),e.cNF(i.urls[0]),e.yG2(2),e.E7m("ngIf",n.QRCodes[t]),e.yG2(3),e.cNF(n.lang.text.WebRTCDevManager.Remove)}}function $(o,s){if(1&o){const i=e.KQA();e.I0R(0,"ion-icon",27),e.qCj("click",function(){e.usT(i);const n=e.GaO(3);return e.CGJ(n.AddServerUrl())}),e.C$Y()}}function U(o,s){if(1&o){const i=e.KQA();e.I0R(0,"ion-icon",28),e.qCj("click",function(){e.usT(i);const n=e.GaO().$implicit,r=e.GaO(2);return e.CGJ(r.SubtractServerUrl(n))}),e.C$Y()}}function Y(o,s){if(1&o){const i=e.KQA();e.I0R(0,"ion-item")(1,"ion-input",24),e.iHE("ngModelChange",function(n){const u=e.usT(i).$implicit,_=e.GaO(2);return e.kNx(_.userInput.urls[u],n)||(_.userInput.urls[u]=n),e.CGJ(n)}),e.C$Y(),e.yuY(2,$,1,0,"ion-icon",25)(3,U,1,0,"ion-icon",26),e.C$Y()}if(2&o){const i=s.$implicit,t=e.GaO(2);e.yG2(),e.E7m("label",0==i?t.lang.text.WebRTCDevManager.Urls:""),e.OKB("ngModel",t.userInput.urls[i]),e.yG2(),e.E7m("ngIf",0==i),e.yG2(),e.E7m("ngIf",0!=i)}}function B(o,s){if(1&o){const i=e.KQA();e.I0R(0,"ion-content")(1,"ion-item-divider")(2,"ion-label"),e.OEk(3),e.C$Y()(),e.yuY(4,Y,4,4,"ion-item",13),e.I0R(5,"ion-item")(6,"ion-input",22),e.iHE("ngModelChange",function(n){e.usT(i);const r=e.GaO();return e.kNx(r.userInput.username,n)||(r.userInput.username=n),e.CGJ(n)}),e.C$Y()(),e.I0R(7,"ion-item")(8,"ion-input",23),e.iHE("ngModelChange",function(n){e.usT(i);const r=e.GaO();return e.kNx(r.userInput.credential,n)||(r.userInput.credential=n),e.CGJ(n)}),e.C$Y()(),e.I0R(9,"ion-item",7),e.qCj("click",function(){e.usT(i);const n=e.GaO();return e.CGJ(n.SaveServer())}),e.I0R(10,"ion-label",8),e.OEk(11),e.C$Y()()()}if(2&o){const i=e.GaO();e.yG2(3),e.cNF(i.lang.text.WebRTCDevManager.ServerInfo),e.yG2(),e.E7m("ngForOf",i.UserInputUrlsLength),e.yG2(2),e.E7m("label",i.lang.text.WebRTCDevManager.Username),e.OKB("ngModel",i.userInput.username),e.yG2(2),e.E7m("label",i.lang.text.WebRTCDevManager.Credential),e.OKB("ngModel",i.userInput.credential),e.yG2(3),e.cNF(i.lang.text.WebRTCDevManager.Save)}}const F=()=>[.5,.6,.7,.8,.9,1];let K=(()=>{var o;class s{constructor(t,n,r,u,_,g,w,L){this.navParams=t,this.modalCtrl=n,this.lang=r,this.indexed=u,this.global=_,this.mClipboard=g,this.p5toast=w,this.nakama=L,this.InOut=[],this.VideoInputs=[],this.AudioInputs=[],this.AudioOutputs=[],this.ServerInfos=[],this.QRCodes=[],this.userInput={urls:[""],username:"",credential:""},this.UserInputUrlsLength=[0],this.BackButtonPressed=!1}InitBrowserBackButtonOverride(){window.history.replaceState(null,null,window.location.href),window.onpopstate=()=>{this.BackButtonPressed||(this.BackButtonPressed=!0,this.modalCtrl.dismiss())}}ngOnInit(){this.InitBrowserBackButtonOverride(),this.InOut=this.navParams.get("list")||[];for(let t=0,n=this.InOut.length;t<n;t++)this.InOut[t].kind.indexOf("videoinput")>=0&&this.VideoInputs.push(this.InOut[t]),this.InOut[t].kind.indexOf("audioinput")>=0&&this.AudioInputs.push(this.InOut[t]),this.InOut[t].kind.indexOf("audiooutput")>=0&&this.AudioOutputs.push(this.InOut[t])}ionViewWillEnter(){var t=this;return(0,d.c)(function*(){try{let n=yield t.indexed.loadTextFromUserPath("servers/webrtc_server.json");t.ServerInfos=JSON.parse(n);for(let r=0,u=t.ServerInfos.length;r<u;r++){let g=t.global.readasQRCodeFromString(`${c.uM}pjcone_pwa/?rtcserver=[${t.ServerInfos[r].urls}],${t.ServerInfos[r].username},${t.ServerInfos[r].credential}`);t.QRCodes[r]=g}}catch{}try{let n=localStorage.getItem("VideoInputDev");t.VideoInput.value=Number(n)||0}catch{}try{let n=localStorage.getItem("AudioInputDev");t.AudioInput.value=Number(n)||0}catch{}})()}ionViewDidEnter(){this.global.p5key.KeyShortCut.AddAct=()=>{this.OpenNewWebRTCServerForm()}}saveSetup(){let t={};this.VideoInput&&void 0!==this.VideoInput.value&&(t.videoinput=this.VideoInputs[this.VideoInput.value],localStorage.setItem("VideoInputDev",this.VideoInput.value)),this.AudioInput&&void 0!==this.AudioInput.value&&(t.audioinput=this.AudioInputs[this.AudioInput.value],localStorage.setItem("AudioInputDev",this.AudioInput.value)),this.AudioOutput&&void 0!==this.AudioOutput.value&&(t.audiooutput=this.AudioOutputs[this.AudioOutput.value]),this.modalCtrl.dismiss(t)}AddServerUrl(){this.userInput.urls.push(""),this.UserInputUrlsLength.push(this.UserInputUrlsLength.length)}SubtractServerUrl(t){this.userInput.urls.splice(t,1),this.UserInputUrlsLength.pop()}OpenNewWebRTCServerForm(){this.RegisterServer.present()}SaveServer(){var t=this;return(0,d.c)(function*(){t.userInput.urls.filter(u=>u);for(let u=t.userInput.urls.length-1;u>=0;u--)t.userInput.urls[u].trim()||t.userInput.urls.splice(u,1);if(!t.userInput.urls.length)return void t.p5toast.show({text:t.lang.text.WebRTCDevManager.IgnoreSave});yield t.nakama.SaveWebRTCServer(t.userInput);let r=t.global.readasQRCodeFromString(`${c.uM}pjcone_pwa/?rtcserver=[${t.userInput.urls}],${t.userInput.username},${t.userInput.credential}`);t.QRCodes.push(r),t.ServerInfos.push(t.userInput),t.userInput={urls:[""],username:"",credential:""},t.UserInputUrlsLength.length=0,t.UserInputUrlsLength.push(0),t.RegisterServer.dismiss()})()}copy_info(t){let n=`${c.uM}pjcone_pwa/?rtcserver=[${this.ServerInfos[t].urls}],${this.ServerInfos[t].username},${this.ServerInfos[t].credential}`;this.mClipboard.copy(n).catch(r=>{m.c.write(n),"DesktopPWA"==c.s1&&this.p5toast.show({text:`${this.lang.text.GlobalAct.PCClipboard}: ${n}`})})}RemoveServer(t){var n=this;return(0,d.c)(function*(){n.ServerInfos.splice(t,1),yield n.indexed.saveTextFileToUserPath(JSON.stringify(n.ServerInfos),"servers/webrtc_server.json")})()}ionViewWillLeave(){delete this.global.p5key.KeyShortCut.AddAct}}return(o=s).\u0275fac=function(t){return new(t||o)(e.GI1(h.a6),e.GI1(a.qS),e.GI1(C.o),e.GI1(f.k),e.GI1(O.A1),e.GI1(b._),e.GI1(M.O),e.GI1(R.h))},o.\u0275cmp=e.In1({type:o,selectors:[["app-webrtc-manage-io-dev"]],viewQuery:function(t,n){if(1&t&&(e.CC$(E,5),e.CC$(D,5),e.CC$(G,5),e.CC$(T,5)),2&t){let r;e.wto(r=e.Gqi())&&(n.VideoInput=r.first),e.wto(r=e.Gqi())&&(n.AudioInput=r.first),e.wto(r=e.Gqi())&&(n.AudioOutput=r.first),e.wto(r=e.Gqi())&&(n.RegisterServer=r.first)}},decls:22,vars:10,consts:[[1,"ion-no-border"],["slot","start",3,"click"],["defaultHref",""],[4,"ngIf"],["button","",3,"click",4,"ngIf"],["WebRTCServers",""],[3,"value",4,"ngFor","ngForOf"],["button","",3,"click"],[1,"ion-text-center"],[3,"initialBreakpoint","breakpoints"],["RegisterNewWebRTCServer",""],["name","videoinput"],["VideoIn",""],[4,"ngFor","ngForOf"],[3,"value"],["name","audioinput"],["AudioIn",""],["button","","slot","header"],["slot","content"],["style","width: 100%; height: auto;","alt","Loading",3,"src","click",4,"ngIf"],["color","danger",1,"ion-text-center"],["alt","Loading",2,"width","100%","height","auto",3,"src","click"],["placeholder","username",1,"ion-text-end",3,"label","ngModel","ngModelChange"],["placeholder","credential",1,"ion-text-end",3,"label","ngModel","ngModelChange"],["placeholder","stun:stun.l.google.com:19302",1,"ion-text-end",3,"label","ngModel","ngModelChange"],["slot","end","color","success","name","add-circle-outline",3,"click",4,"ngIf"],["slot","end","color","danger","name","remove-circle-outline",3,"click",4,"ngIf"],["slot","end","color","success","name","add-circle-outline",3,"click"],["slot","end","color","danger","name","remove-circle-outline",3,"click"]],template:function(t,n){1&t&&(e.I0R(0,"ion-header",0)(1,"ion-toolbar")(2,"ion-title"),e.OEk(3),e.C$Y(),e.I0R(4,"ion-buttons",1),e.qCj("click",function(){return n.modalCtrl.dismiss()}),e.wR5(5,"ion-back-button",2),e.C$Y()()(),e.I0R(6,"ion-content"),e.yuY(7,W,7,2,"div",3)(8,S,7,2,"div",3)(9,A,3,1,"ion-item",4),e.I0R(10,"ion-item-divider")(11,"ion-label"),e.OEk(12),e.C$Y()(),e.I0R(13,"ion-accordion-group",null,5),e.yuY(15,x,9,4,"ion-accordion",6),e.C$Y(),e.I0R(16,"ion-item",7),e.qCj("click",function(){return n.OpenNewWebRTCServerForm()}),e.I0R(17,"ion-label",8),e.OEk(18),e.C$Y()(),e.I0R(19,"ion-modal",9,10),e.yuY(21,B,12,7,"ng-template"),e.C$Y()()),2&t&&(e.yG2(3),e.cNF(n.lang.text.WebRTCDevManager.Title),e.yG2(4),e.E7m("ngIf",n.VideoInputs.length),e.yG2(),e.E7m("ngIf",n.AudioInputs.length),e.yG2(),e.E7m("ngIf",n.InOut.length),e.yG2(3),e.cNF(n.lang.text.WebRTCDevManager.ManageServer),e.yG2(3),e.E7m("ngForOf",n.ServerInfos),e.yG2(3),e.cNF(n.lang.text.WebRTCDevManager.AddServer),e.yG2(),e.E7m("initialBreakpoint",.5)("breakpoints",e.q4q(9,F)))},dependencies:[I.ay,I.u_,p.ue,p._G,a.cm,a.qU,a.GS,a._i,a.wB,a.Ko,a.A5,a.Yb,a.S8,a.QR,a.CS,a.ue,a.tM,a.Md,a.yc,a.Gv,a.IT,a.qG,a.Im]}),s})()}}]);