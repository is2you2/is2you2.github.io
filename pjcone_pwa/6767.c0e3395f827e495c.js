"use strict";(self.webpackChunkapp=self.webpackChunkapp||[]).push([[6767],{6767:(De,G,p)=>{p.r(G),p.d(G,{ArcadePageModule:()=>Fe});var $=p(177),I=p(4341),f=p(5374),D=p(9858),h=p(467),B=p(617),L=p(8326),T=p(7100),P=p(5402),V=p(92),v=p(9969),e=p(3953),E=p(4234),M=p(8065),N=p(4237),X=p(3656),O=p(9347),U=p(755),Q=p(9900),Y=p(3307),J=p(7476),W=p(5547);const z=["ArcadeDetail"],H=["ArcadeQRShare"],Z=["InAppQRScanner"],K=["arcadeInput"];function q(o,_){if(1&o){const i=e.RV6();e.j41(0,"ion-header",11)(1,"ion-toolbar")(2,"ion-title"),e.EFF(3),e.k0s(),e.j41(4,"input",12),e.bIt("change",function(a){e.eBV(i);const n=e.XpG();return e.Njj(n.SelectVoidDrawBackgroundImage(a))}),e.k0s(),e.j41(5,"div",13),e.bIt("click",function(){e.eBV(i);const a=e.XpG();return e.Njj(a.JoinInstantCall())}),e.nrm(6,"ion-icon",14),e.k0s(),e.j41(7,"div",15),e.bIt("click",function(){e.eBV(i);const a=e.XpG();return e.Njj(a.JoinSmallTalk())}),e.nrm(8,"ion-icon",16),e.k0s(),e.j41(9,"div",17),e.bIt("click",function(){e.eBV(i);const a=e.XpG();return e.Njj(a.nakama.toggle_all_session())}),e.k0s()()()}if(2&o){const i=e.XpG();e.R7$(3),e.JRh(i.lang.text.Arcade.Title),e.R7$(6),e.Aen("background-color: "+i.statusBar.colors[i.statusBar.settings.groupServer])}}function ee(o,_){if(1&o){const i=e.RV6();e.j41(0,"div",30),e.bIt("click",function(){const a=e.eBV(i),n=a.$implicit,l=a.index,c=e.XpG(2);return e.Njj(c.ShowGameInfo(n,l))})("contextmenu",function(){const a=e.eBV(i).index,n=e.XpG(2);return e.Njj(n.RemoveTempGame(a))}),e.j41(1,"div",20),e.EFF(2),e.k0s()()}if(2&o){const i=_.$implicit;e.Y8G("@pck_changed",void 0)("hidden",i.hide),e.R7$(2),e.SpI(" ",i.name," ")}}function te(o,_){if(1&o){const i=e.RV6();e.j41(0,"div")(1,"ion-item-divider")(2,"ion-label"),e.EFF(3),e.k0s()(),e.j41(4,"div",18)(5,"div",19),e.bIt("click",function(){e.eBV(i);const a=e.XpG();return e.Njj(a.OpenScanner())})("contextmenu",function(){e.eBV(i);const a=e.XpG();return e.Njj(a.OpenQuickLink())}),e.j41(6,"div",20),e.nrm(7,"ion-icon",21),e.j41(8,"div")(9,"ion-label",22),e.EFF(10,"QRCode"),e.k0s()()()(),e.j41(11,"input",23),e.bIt("change",function(a){e.eBV(i);const n=e.XpG();return e.Njj(n.LoadFileFromLocalAct(a))}),e.k0s(),e.j41(12,"input",24),e.bIt("change",function(a){e.eBV(i);const n=e.XpG();return e.Njj(n.global.LoadGameFile(a))}),e.k0s(),e.j41(13,"div",19),e.bIt("click",function(){e.eBV(i);const a=e.XpG();return e.Njj(a.LoadFileFromLocal())})("contextmenu",function(){e.eBV(i);const a=e.XpG();return e.Njj(a.LoadFileFromClipboard())}),e.j41(14,"div",20),e.nrm(15,"ion-icon",25),e.j41(16,"div")(17,"ion-label",22),e.EFF(18),e.k0s()()()(),e.j41(19,"div",19),e.bIt("click",function(){e.eBV(i);const a=e.XpG();return e.Njj(a.QuickLinkAct())})("contextmenu",function(){e.eBV(i);const a=e.XpG();return e.Njj(a.QuickLinkContextmenu())}),e.j41(20,"div",20),e.nrm(21,"img",26),e.j41(22,"div")(23,"ion-label",22),e.EFF(24),e.k0s()()()()(),e.j41(25,"div")(26,"ion-item-divider")(27,"ion-label"),e.EFF(28),e.k0s()(),e.j41(29,"div",18)(30,"div",19),e.bIt("click",function(){e.eBV(i);const a=e.XpG();return e.Njj(a.LoadFileForTest())})("contextmenu",function(){e.eBV(i);const a=e.XpG();return e.Njj(a.LoadFileForTestClipboard())}),e.j41(31,"div",20),e.nrm(32,"ion-icon",27),e.j41(33,"div")(34,"ion-label",22),e.EFF(35),e.k0s()(),e.j41(36,"input",28),e.bIt("change",function(a){e.eBV(i);const n=e.XpG();return e.Njj(n.LoadFileForTestAct(a))}),e.k0s()()(),e.DNE(37,ee,3,3,"div",29),e.k0s()()()}if(2&o){const i=e.XpG();e.R7$(3),e.JRh(i.lang.text.Arcade.AddCustom),e.R7$(15),e.JRh(i.lang.text.Arcade.FromFile),e.R7$(6),e.JRh(i.lang.text.ChatRoom.voidDraw),e.R7$(4),e.JRh(i.lang.text.Arcade.TestList),e.R7$(7),e.JRh(i.lang.text.Arcade.AddTest),e.R7$(2),e.Y8G("ngForOf",i.TmpTestFile)}}function ae(o,_){if(1&o&&(e.j41(0,"span"),e.EFF(1),e.k0s()),2&o){const i=e.XpG().$implicit;e.Aen("color: #"+i.color),e.R7$(),e.JRh(" "+i.text)}}function ie(o,_){if(1&o&&(e.j41(0,"b"),e.EFF(1),e.k0s()),2&o){const i=e.XpG(2).$implicit;e.R7$(),e.SpI("",i.target,":")}}function ne(o,_){if(1&o&&(e.j41(0,"span"),e.EFF(1),e.k0s()),2&o){const i=e.XpG().$implicit;e.R7$(),e.JRh(i.text)}}function oe(o,_){if(1&o){const i=e.RV6();e.j41(0,"a",51),e.bIt("click",function(a){e.eBV(i);const n=e.XpG().$implicit,l=e.XpG(6);return e.Njj(l.nakama.open_url_link(a,n.text))}),e.EFF(1),e.k0s()}if(2&o){const i=e.XpG().$implicit;e.Y8G("href",i.text,e.B4B),e.R7$(),e.JRh(i.text)}}function re(o,_){if(1&o&&(e.j41(0,"span"),e.DNE(1,ne,2,1,"span",7)(2,oe,2,2,"a",50),e.k0s()),2&o){const i=_.$implicit;e.R7$(),e.Y8G("ngIf",!i.href),e.R7$(),e.Y8G("ngIf",i.href)}}function le(o,_){if(1&o&&(e.j41(0,"span"),e.DNE(1,re,3,2,"span",38),e.k0s()),2&o){const i=e.XpG(2).$implicit;e.Aen(i.isSystem?"color: var(--arcade-fix-system-color)":""),e.R7$(),e.Y8G("ngForOf",i.text)}}function ce(o,_){if(1&o){const i=e.RV6();e.j41(0,"span")(1,"span",52),e.bIt("click",function(){e.eBV(i);const a=e.XpG(2).$implicit,n=e.XpG(3);return e.Njj(n.open_file_viewer(a.file.info))}),e.EFF(2),e.k0s()()}if(2&o){const i=e.XpG(2).$implicit,t=e.XpG(3);e.R7$(2),e.JRh(t.lang.text.ChatRoom.attachments+": "+i.file.info.filename)}}function se(o,_){if(1&o&&(e.j41(0,"span",49)(1,"span"),e.DNE(2,ie,2,1,"b",7),e.k0s(),e.DNE(3,le,2,3,"span",47)(4,ce,3,1,"span",7),e.k0s()),2&o){const i=e.XpG().$implicit;e.R7$(),e.Aen("color: #"+i.color),e.R7$(),e.Y8G("ngIf",i.target),e.R7$(),e.Y8G("ngIf",i.text),e.R7$(),e.Y8G("ngIf",i.file)}}function de(o,_){if(1&o&&(e.j41(0,"p"),e.DNE(1,ae,2,3,"span",47)(2,se,5,5,"span",48),e.k0s()),2&o){const i=_.$implicit;e.Y8G("@arcade_chat",void 0),e.R7$(),e.Y8G("ngIf",!i.target),e.R7$(),e.Y8G("ngIf",i.target)}}function _e(o,_){if(1&o&&e.nrm(0,"ion-icon",59),2&o){const i=e.XpG().$implicit;e.Y8G("name",i.icon||"close-circle")}}function ge(o,_){if(1&o&&e.nrm(0,"img",60),2&o){const i=e.XpG().$implicit;e.Y8G("src","assets/icon/"+i.icon_img,e.B4B)("alt",i.title)}}function pe(o,_){if(1&o){const i=e.RV6();e.j41(0,"div",55)(1,"div",56),e.bIt("click",function(){const a=e.eBV(i).$implicit;return e.Njj(a.act())})("contextmenu",function(){const a=e.eBV(i).$implicit;return e.Njj(a.context?a.context():null)}),e.DNE(2,_e,1,1,"ion-icon",57)(3,ge,1,2,"img",58),e.j41(4,"div"),e.EFF(5),e.k0s()()()}if(2&o){const i=_.$implicit;e.R7$(),e.Aen("cursor: "+(i.cursor||"pointer")+";"),e.Y8G("hidden",i.isHide),e.R7$(),e.Y8G("ngIf",i.icon),e.R7$(),e.Y8G("ngIf",i.icon_img),e.R7$(2),e.JRh(i.name)}}function ue(o,_){if(1&o&&(e.j41(0,"div",53),e.DNE(1,pe,6,6,"div",54),e.k0s()),2&o){const i=e.XpG(3);e.R7$(),e.Y8G("ngForOf",i.extended_buttons)}}function me(o,_){if(1&o){const i=e.RV6();e.j41(0,"div",34)(1,"div",35)(2,"div",36)(3,"div",37),e.DNE(4,de,3,3,"p",38),e.k0s()(),e.j41(5,"table",39)(6,"tr")(7,"td")(8,"ion-button",40),e.bIt("click",function(){e.eBV(i);const a=e.XpG(2);return e.Njj(a.ToggleExtMenu())}),e.nrm(9,"ion-icon",41),e.k0s(),e.j41(10,"input",42),e.bIt("change",function(a){e.eBV(i);const n=e.XpG(2);return e.Njj(n.SendAttachAct(a))}),e.k0s()(),e.j41(11,"td",43)(12,"ion-input",44,3),e.bIt("ionFocus",function(){e.eBV(i);const a=e.XpG(2);return a.focus_on_input(120),e.Njj(a.global.toggleBlockMainShortcut(!0))})("ionBlur",function(){e.eBV(i);const a=e.XpG(2);return e.Njj(a.global.toggleBlockMainShortcut(!1))})("keyup.enter",function(){e.eBV(i);const a=e.XpG(2);return e.Njj(a.send())}),e.mxI("ngModelChange",function(a){e.eBV(i);const n=e.XpG(2);return e.DH7(n.global.arcadeChat.text,a)||(n.global.arcadeChat.text=a),e.Njj(a)}),e.k0s()(),e.j41(14,"td")(15,"ion-button",40),e.bIt("click",function(){e.eBV(i);const a=e.XpG(2);return e.Njj(a.send())}),e.nrm(16,"ion-icon",45),e.k0s()()()(),e.DNE(17,ue,2,1,"div",46),e.k0s()()}if(2&o){const i=e.XpG(2);e.R7$(4),e.Y8G("ngForOf",i.global.arcadeChat.logs),e.R7$(8),e.Y8G("placeholder",i.lang.text.ChatRoom.input_placeholder),e.R50("ngModel",i.global.arcadeChat.text),e.R7$(5),e.Y8G("ngIf",i.ShowExtMenus)}}function he(o,_){if(1&o&&(e.j41(0,"div",31)(1,"div",32),e.DNE(2,me,18,4,"div",33),e.k0s()()),2&o){const i=e.XpG();e.R7$(2),e.Y8G("ngIf",i.global.ToggleChatInput)}}function fe(o,_){if(1&o&&(e.j41(0,"div"),e.EFF(1),e.k0s()),2&o){const i=e.XpG(3);e.R7$(),e.SpI(" ",i.TargetArcadeInfo.creator," ")}}function xe(o,_){if(1&o&&(e.j41(0,"a",73),e.EFF(1),e.k0s()),2&o){const i=e.XpG(3);e.Y8G("href",i.TargetArcadeInfo.link,e.B4B),e.R7$(),e.JRh(i.TargetArcadeInfo.creator)}}function ve(o,_){if(1&o&&(e.j41(0,"div",66),e.DNE(1,fe,2,1,"div",7)(2,xe,2,2,"a",72),e.k0s()),2&o){const i=e.XpG(2);e.R7$(),e.Y8G("ngIf",!i.TargetArcadeInfo.link),e.R7$(),e.Y8G("ngIf",i.TargetArcadeInfo.link)}}function be(o,_){if(1&o){const i=e.RV6();e.j41(0,"ion-item",82),e.bIt("click",function(){const a=e.eBV(i).index,n=e.XpG(3);return e.Njj(n.select_server(a))}),e.j41(1,"ion-label"),e.EFF(2),e.k0s()()}if(2&o){const i=_.$implicit;e.R7$(2),e.JRh(i.name)}}function Ae(o,_){if(1&o){const i=e.RV6();e.j41(0,"ion-accordion-group",74,4),e.bIt("click",function(){e.eBV(i);const a=e.XpG(2);return e.Njj(a.isExpanded=!0)}),e.j41(2,"ion-accordion",75)(3,"ion-item",76)(4,"ion-label",77),e.EFF(5),e.k0s(),e.j41(6,"ion-label",78),e.EFF(7),e.k0s(),e.nrm(8,"ion-icon",79),e.k0s(),e.j41(9,"div",80),e.DNE(10,be,3,1,"ion-item",81),e.k0s()()()}if(2&o){const i=e.XpG(2);e.Y8G("value",i.isExpanded),e.R7$(5),e.JRh(i.lang.text.AddGroup.SelectServer),e.R7$(2),e.JRh(i.servers[i.index].name),e.R7$(3),e.Y8G("ngForOf",i.servers)}}function ke(o,_){if(1&o){const i=e.RV6();e.j41(0,"ion-item",83)(1,"ion-input",84),e.mxI("ngModelChange",function(a){e.eBV(i);const n=e.XpG(2);return e.DH7(n.global.ArcadeUserInputAddress,a)||(n.global.ArcadeUserInputAddress=a),e.Njj(a)}),e.k0s()()}if(2&o){const i=e.XpG(2);e.R7$(),e.Y8G("label",i.lang.text.voidDraw.LocalAddrInput),e.R50("ngModel",i.global.ArcadeUserInputAddress)}}function ye(o,_){if(1&o){const i=e.RV6();e.j41(0,"ion-button",85),e.bIt("click",function(){e.eBV(i);const a=e.XpG(2);return e.Njj(a.RemoveTempGame(a.TempIndex))}),e.EFF(1),e.k0s()}if(2&o){const i=e.XpG(2);e.R7$(),e.SpI(" ",i.lang.text.UserFsDir.Delete," ")}}function Re(o,_){if(1&o){const i=e.RV6();e.j41(0,"div",61),e.bIt("click",function(a){e.eBV(i);const n=e.XpG();return e.Njj(n.CheckIfDismissAct(a))}),e.j41(1,"div",62)(2,"div",63)(3,"div",64)(4,"h1"),e.EFF(5),e.k0s(),e.DNE(6,ve,3,2,"div",65),e.j41(7,"div",66),e.EFF(8),e.k0s(),e.j41(9,"div",67),e.EFF(10),e.k0s(),e.DNE(11,Ae,11,4,"ion-accordion-group",68),e.j41(12,"div"),e.DNE(13,ke,2,2,"ion-item",69),e.j41(14,"ion-button",70),e.bIt("click",function(){e.eBV(i);const a=e.XpG();return e.Njj(a.StartGame())}),e.EFF(15),e.k0s(),e.DNE(16,ye,2,1,"ion-button",71),e.k0s()()()()()}if(2&o){const i=e.XpG();e.R7$(2),e.Aen(i.TargetArcadeInfo.cover?"background-image: url("+i.TargetArcadeInfo.cover+"); background-size: cover; background-position: center;":""),e.R7$(3),e.JRh(i.TargetArcadeInfo.name),e.R7$(),e.Y8G("ngIf",i.TargetArcadeInfo.creator),e.R7$(2),e.SpI(" ",i.lang.text.Arcade.GameLang+": "+i.TargetArcadeInfo.lang," "),e.R7$(2),e.SpI(" ",i.TargetArcadeInfo.desc," "),e.R7$(),e.Y8G("ngIf",i.servers.length),e.R7$(2),e.Y8G("ngIf",0==i.index),e.R7$(),e.Y8G("disabled",!i.servers.length),e.R7$(),e.SpI(" ",i.lang.text.Arcade.StartGame," "),e.R7$(),e.Y8G("ngIf",void 0!==i.Removable)}}function je(o,_){if(1&o){const i=e.RV6();e.j41(0,"img",91),e.bIt("click",function(){e.eBV(i);const a=e.XpG(2);return e.Njj(a.copy_address(a.global.ArcadeQRAddress))})("contextmenu",function(){e.eBV(i);const a=e.XpG(2);return e.Njj(a.copy_address_with_iframe_tag())}),e.k0s()}if(2&o){const i=e.XpG(2);e.Y8G("src",i.global.ArcadeQRCodeSRC,e.B4B)}}function Te(o,_){if(1&o){const i=e.RV6();e.j41(0,"div",86),e.bIt("click",function(a){e.eBV(i);const n=e.XpG();return e.Njj(n.CheckIfDismissAct(a))}),e.j41(1,"div",87)(2,"div",88),e.DNE(3,je,1,1,"img",89),e.j41(4,"ion-item",82),e.bIt("click",function(){e.eBV(i);const a=e.XpG();return e.Njj(a.copy_address(a.global.ArcadeQRAddress))}),e.j41(5,"ion-label",90),e.EFF(6),e.k0s()()()()()}if(2&o){const i=e.XpG();e.R7$(3),e.Y8G("ngIf",i.global.ArcadeQRCodeSRC),e.R7$(3),e.JRh(i.global.ArcadeQRAddress)}}function we(o,_){if(1&o&&(e.j41(0,"ion-label",99),e.EFF(1),e.k0s()),2&o){const i=e.XpG(2);e.R7$(),e.JRh(i.lang.text.Subscribes.QRScanPlaceholder)}}function Ce(o,_){if(1&o&&(e.j41(0,"ion-label",90),e.EFF(1),e.k0s()),2&o){const i=e.XpG(2);e.R7$(),e.JRh(i.QRScanResult)}}function $e(o,_){if(1&o){const i=e.RV6();e.j41(0,"div",92),e.bIt("click",function(a){e.eBV(i);const n=e.XpG();return e.Njj(n.CheckIfDismissAct(a))}),e.j41(1,"div",87)(2,"div",93)(3,"div",94),e.bIt("click",function(){e.eBV(i);const a=e.XpG();return e.Njj(a.ChangeScanDevice())}),e.nrm(4,"ion-icon",95),e.k0s(),e.nrm(5,"iframe",96),e.j41(6,"ion-item",82),e.bIt("click",function(){e.eBV(i);const a=e.XpG();return e.Njj(a.copy_address(a.QRScanResult))}),e.DNE(7,we,2,1,"ion-label",97)(8,Ce,2,1,"ion-label",98),e.k0s()()()()}if(2&o){const i=e.XpG();e.R7$(7),e.Y8G("ngIf",!i.QRScanResult),e.R7$(),e.Y8G("ngIf",i.QRScanResult)}}const Ie=[{path:"",component:(()=>{var o;class _{constructor(t,a,n,l,c,r,s,d,g,u,x,A){var b,m=this;this.lang=t,this.statusBar=a,this.nakama=n,this.navCtrl=l,this.client=c,this.global=r,this.indexed=s,this.animationCtrl=d,this.p5toast=g,this.p5loading=u,this.floatButton=x,this.noti=A,this.WillLeave=!1,this.TmpTestFile=[],this.TargetArcadeInfo={},this.servers=[],this.index=0,this.isExpanded=!1,this.Removable=!1,this.TempIndex=0,this.enterAnimation=b=>{const k=b.shadowRoot,R=this.animationCtrl.create().addElement(k.querySelector("ion-backdrop")).fromTo("opacity","0.01","var(--backdrop-opacity)"),y=this.animationCtrl.create().addElement(k.querySelector(".modal-wrapper")).keyframes([{offset:0,opacity:"0",transform:"scale(0)"},{offset:1,opacity:"1",transform:"scale(1)"}]);return this.animationCtrl.create().addElement(b).easing("ease-out").duration(250).addAnimation([R,y])},this.leaveAnimation=b=>this.enterAnimation(b).direction("reverse"),this.OpeningScanner=!1,this.ShowExtMenus=!1,this.useVoiceRecording=!1,this.extended_buttons=[{icon:"document-attach-outline",name:this.lang.text.ChatRoom.attachments,act:(b=(0,h.A)(function*(){m.new_attach({detail:{value:"load"}})}),function(){return b.apply(this,arguments)}),context:()=>(this.new_attach({detail:{value:"link"}}),!1)},{icon_img:"voidDraw.png",name:this.lang.text.ChatRoom.voidDraw,act:()=>{this.new_attach({detail:{value:"image"}})},context:()=>(function(){var k=(0,h.A)(function*(){const R=yield m.global.GetValueFromClipboard("voiddraw");if("image/png"===R.type){const y=R.value,w=`tmp_files/minimal_chat/${y.name}`;yield m.indexed.saveBlobToUserPath(y,w);const F=URL.createObjectURL(y);new L(j=>{j.setup=()=>{j.noCanvas(),j.loadImage(F,C=>{m.global.PageDismissAct["arcade-image"]=function(){var Se=(0,h.A)(function*(S){if(S.data){let Ge=yield m.global.voidDraw_fileAct_callback(S,"tmp_files/square/",{display_name:m.nakama.users.self.display_name});m.TrySendingAttach(Ge,"arcade_chat")}delete m.global.PageDismissAct["arcade-image"]});return function(S){return Se.apply(this,arguments)}}(),m.global.ActLikeModal("void-draw",{path:w,width:C.width,height:C.height,type:y.type,dismiss:"arcade-image"}),URL.revokeObjectURL(F),j.remove()},C=>{console.log("\ube60\ub978 \uadf8\ub9bc\ud310 \uc5f4\uae30 \uc2e4\ud328: ",C),URL.revokeObjectURL(F),j.remove()})}})}else m.extended_buttons[1].act()});return function(){return k.apply(this,arguments)}}()(),!1)},{icon:"reader-outline",name:this.lang.text.ChatRoom.newText,act:()=>{this.new_attach({detail:{value:"text"}})}},{icon:"camera-outline",name:this.lang.text.ChatRoom.Camera,act:()=>{this.new_attach({detail:{value:"camera"}})}},{icon:"mic-circle-outline",name:this.lang.text.ChatRoom.Voice,act:function(){var b=(0,h.A)(function*(){if(m.useVoiceRecording=!m.useVoiceRecording,m.useVoiceRecording){if(m.global.useVoiceRecording&&"ArcadeRecording"!=m.global.useVoiceRecording)return void m.p5toast.show({text:m.lang.text.GlobalAct[m.global.useVoiceRecording]});(yield P.R.hasAudioRecordingPermission()).value?(m.global.useVoiceRecording="ArcadeRecording",m.extended_buttons[4].icon="stop-circle-outline",m.extended_buttons[4].name=m.lang.text.ChatRoom.VoiceStop,m.p5loading.toast(m.lang.text.ChatRoom.StartVRecord),yield P.R.startRecording(),m.CreateFloatingVoiceTimeHistoryAddButton()):(m.useVoiceRecording=!1,m.extended_buttons[4].icon="mic-circle-outline",yield P.R.requestAudioRecordingPermission())}else yield m.StopAndSaveVoiceRecording()});return function(){return b.apply(this,arguments)}}()},{icon:"trash-outline",name:this.lang.text.MinimalChat.TrashChat,act:()=>{this.global.arcadeChat.logs.length=0,this.global.arcadeChat.logs.push({color:T.ud?"bbb":"444",text:this.lang.text.MinimalChat.TrashChatLog,isSystem:!0}),this.ShowExtMenus=!1}}]}ngOnInit(){this.global.ArcadeSendAttachFunc=(t,a)=>this.SendAttachAct(t,a),this.global.windowOnFocusAct.arcade_focus=()=>{this.WillLeave||this.noti.ClearNoti(this.global.ArcadeOnMessageLnId)}}ionViewWillEnter(){var t=this;return(0,h.A)(function*(){var a,n,l;t.WillLeave=!1,t.noti.ClearNoti(t.global.ArcadeOnMessageLnId),t.global.ArcadeLoaded&&(t.noti.Current="arcade",t.global.RemoveAutoPIPMode()),null===(a=t.ArcadeDetail)||void 0===a||a.dismiss(),null===(n=t.InAppQRScanner)||void 0===n||n.dismiss(),null===(l=t.ArcadeQRShare)||void 0===l||l.dismiss(),t.global.GodotRelativeArcadeChatInputFocus=()=>{t.focus_on_input()}})()}ionViewDidEnter(){this.global.ArcadeObject.QRCode||(this.global.ArcadeObject.QRCode=this.ArcadeQRShare)}WaitingCurrent(){var t=this;return(0,h.A)(function*(){for(;t.WillLeave;)yield new Promise(a=>setTimeout(a,0))})()}ionViewWillLeave(){this.global.RestoreShortCutAct("arcade-fileviewer"),this.global.ToggleFullScreen(!1),this.WillLeave=!0,this.global.ArcadeLoaded&&(this.noti.Current="",this.global.CraeteAutoPIPMode()),this.global.GodotRelativeArcadeChatInputFocus=null}QuickLinkAct(){this.global.PageDismissAct["arcade-voiddraw"]=t=>{delete this.global.PageDismissAct["arcade-voiddraw"]},this.global.ActLikeModal("portal/arcade/void-draw",{saveClipboard:!0,dismiss:"arcade-voiddraw"})}CheckIfDismissAct(t){switch(t.target.id){case"arcade_detail":this.ArcadeDetail.dismiss();break;case"inapp_qrscanner":this.InAppQRScanner.dismiss();break;case"arcade_qrmodal":this.ArcadeQRShare.dismiss()}}LoadFileForTest(){document.getElementById("add_test_arcade").click()}LoadFileForTestAct(t){var a=this;return(0,h.A)(function*(){const n="LoadFileForTestAct";try{for(let l=0,c=t.target.files.length;l<c;l++){a.p5loading.update({id:n,message:`${a.lang.text.ContentViewer.OnLoadContent} (${l}): ${t.target.files[l].name}`,progress:l/c});let r={};(r.filename=t.target.files[l].name,r.file_ext=t.target.files[l].name.split(".").pop()||t.target.files[l].type||a.lang.text.ChatRoom.unknown_ext,r.size=t.target.files[l].size,r.type=t.target.files[l].type||t.target.files[l].type_override,r.blob=t.target.files[l],a.global.set_viewer_category_from_ext(r),"godot"==r.viewer)?(r.path=`tmp_files/arcade/[${l}: ${Date.now()}] ${t.target.files[l].name}`,yield a.indexed.saveBlobToUserPath(t.target.files[l],r.path),a.TmpTestFile.unshift({name:r.filename,file_ext:"pck",path:r.path})):a.p5toast.show({text:`${a.lang.text.Arcade.wrong_ext}: ${r.filename}`})}}catch(l){a.p5toast.show({text:`${a.lang.text.Arcade.InputError}: ${(l.statusText?`${l.statusText}(${l.status})`:l.status)||l}`}),console.log("\uc544\ucf00\uc774\ub4dc \ud30c\uc77c \uc785\ub825 \uc2e4\ud328: ",l)}a.p5loading.update({id:n,progress:1,forceEnd:0}),document.getElementById("add_test_arcade").value=null})()}LoadFileForTestClipboard(){var t=this;return function(){var n=(0,h.A)(function*(){let l=yield t.global.GetValueFromClipboard();if("text/plain"===l.type){let c={};const s=yield(yield fetch(l.value)).blob(),d=new File([s],l.value.split("/").pop());t.global.set_viewer_category_from_ext(c),t.LoadFileForTestAct({target:{files:[d]}})}else console.log("\uc544\ucf00\uc774\ub4dc_\ud14c\uc2a4\ud2b8-\ud074\ub9bd\ubcf4\ub4dc\ub85c\ubd80\ud130 \ud30c\uc77c \uc77d\uae30 \uc624\ub958: ",l.value),t.LoadFileForTest()});return function(){return n.apply(this,arguments)}}()(),!1}LoadFileFromLocal(){document.getElementById("arcade_file_load").click()}LoadFileFromLocalAct(t){var a=this;return(0,h.A)(function*(){const n="LoadFileFromLocalAct";let l,c=[];try{for(let r=0,s=t.target.files.length;r<s;r++){a.p5loading.update({id:n,message:`${a.lang.text.ContentViewer.OnLoadContent} (${r}): ${t.target.files[r].name}`,progress:r/s});let d={};d.filename=t.target.files[r].name,d.file_ext=t.target.files[r].name.split(".").pop()||t.target.files[r].type||a.lang.text.ChatRoom.unknown_ext,d.size=t.target.files[r].size,d.type=t.target.files[r].type||t.target.files[r].type_override,d.blob=t.target.files[r],a.global.set_viewer_category_from_ext(d),d.path=`tmp_files/arcade/[${r}] ${t.target.files[r].name}`,yield a.indexed.saveBlobToUserPath(t.target.files[r],d.path),l||(l=d),c.push({content:d})}}catch(r){a.p5toast.show({text:`${a.lang.text.Arcade.InputError}: ${(r.statusText?`${r.statusText}(${r.status})`:r.status)||r}`}),console.log("\uc544\ucf00\uc774\ub4dc \ud30c\uc77c \uc785\ub825 \uc2e4\ud328: ",r)}a.p5loading.update({id:n,progress:1,forceEnd:0}),a.global.PageDismissAct["arcade-fileviewer"]=function(){var r=(0,h.A)(function*(s){s.data&&a.ClipBoardOpenVoidDraw(s),a.global.RestoreShortCutAct("arcade-fileviewer"),delete a.global.PageDismissAct["arcade-fileviewer"]});return function(s){return r.apply(this,arguments)}}(),a.global.StoreShortCutAct("arcade-fileviewer"),a.global.ActLikeModal("portal/arcade/ionic-viewer",{info:{content:l},relevance:c,noEdit:"image"!=l.viewer,noTextEdit:!0,dismiss:"arcade-fileviewer"}),document.getElementById("arcade_file_load").value=null})()}LoadFileFromClipboard(){var t=this;return function(){var n=(0,h.A)(function*(){const l=yield t.global.GetValueFromClipboard();switch(l.type){case"text/plain":{t.global.PageDismissAct["arcade-clipboard"]=r=>{r.data&&t.ClipBoardOpenVoidDraw(r),t.global.RestoreShortCutAct("arcade-fileviewer"),delete t.global.PageDismissAct["arcade-clipboard"]};let c={};c.filename=l.value.split("/").pop(),c.file_ext=c.filename.split(".").pop(),c.url=l.value,c.path=`tmp_files/arcade/${c.filename}`,c.type="html"==c.file_ext?"text/html":c.type,t.global.set_viewer_category_from_ext(c),t.global.StoreShortCutAct("arcade-fileviewer"),t.global.ActLikeModal("portal/arcade/ionic-viewer",{info:{content:c},relevance:[{content:c}],noTextEdit:!0,dismiss:"arcade-clipboard"})}break;case"image/png":t.LoadFileFromLocalAct({target:{files:[l.value]}});break;default:console.log("\uc544\ucf00\uc774\ub4dc-\ud074\ub9bd\ubcf4\ub4dc\ub85c\ubd80\ud130 \ud30c\uc77c \uc77d\uae30 \uc624\ub958: ",l.value),t.LoadFileFromLocal()}});return function(){return n.apply(this,arguments)}}()(),!1}ClipBoardOpenVoidDraw(t){var a=this;return(0,h.A)(function*(){if("image"===t.data.type)return a.global.PageDismissAct["arcade-modify-image"]=n=>{delete a.global.PageDismissAct["arcade-modify-image"]},yield a.WaitingCurrent(),void a.global.ActLikeModal("portal/arcade/void-draw",{path:t.data.path,width:t.data.width,height:t.data.height,type:t.data.filetype,isDarkMode:t.data.isDarkMode,scrollHeight:t.data.scrollHeight,saveClipboard:!0,dismiss:"arcade-modify-image"})})()}ShowGameInfo(t,a=void 0){this.TargetArcadeInfo=t,this.ArcadeDetail.onDidDismiss().then(()=>{this.TargetArcadeInfo={},this.global.RestoreShortCutAct("arcade_detail")}),this.servers=this.nakama.get_all_server_info(!0,!0),this.servers.unshift({name:this.lang.text.voidDraw.LocalAddrInput,isOfficial:"local",target:"target",local:!0}),this.index=Math.max(0,Math.min(this.servers.length-1,1)),this.select_server(this.index),this.Removable=a,void 0!==a&&(this.TempIndex=a),this.global.StoreShortCutAct("arcade_detail"),this.ArcadeDetail.present()}RemoveTempGame(t){var a;return this.TmpTestFile.splice(t,1),null===(a=this.ArcadeDetail)||void 0===a||a.dismiss(),!1}select_server(t){this.index=t,this.isExpanded=!1,0==t?this.global.ArcadeUserInputAddress="":(this.global.ArcadeWSAddress=this.global.CatchWebSocketAddressFromServerInfo(this.servers[t]),this.global.ArcadeSquarePort=this.servers[t].square_port||12013,this.global.ArcadeCdnPort=this.servers[t].cdn_port||9001,this.global.ArcadeFilePort=this.servers[t].apache_port||9002,this.global.ArcadeUserInputAddress=`${this.global.ArcadeWSAddress}:${this.global.ArcadeSquarePort}`)}StartGame(){var t=this;return(0,h.A)(function*(){if(t.ShowExtMenus=!1,0==t.index){const l=t.global.ArcadeUserInputAddress.split(",");t.global.ArcadeWSAddress=l[0],t.global.ArcadeSquarePort=Number(l[1])||12013,t.global.ArcadeCdnPort=Number(l[2])||9001,t.global.ArcadeFilePort=Number(l[3])||9002}const a=JSON.parse(JSON.stringify(t.TargetArcadeInfo));let n;yield t.ArcadeDetail.dismiss(),a.path&&(n=yield t.indexed.loadBlobFromUserPath(a.path,"")),a.url||(t.global.afterInitAct=(0,h.A)(function*(){var l;const c=t.global.ArcadeWSAddress.split("://"),r=`${"wss"==c[0]?"https":"http"}://${c[1]},${t.global.ArcadeCdnPort||9001},${t.global.ArcadeFilePort||9002}`,s=(new Date).getTime(),d=`tmp_${t.global.ArcadeJoinedChannel}_${t.global.ArcadeWSPeerId}`,u=a.path.split("/").pop().replace(/[\/\\:*?"<>|#&?%+\s]/g,"_"),x=`${d.replace(/\//g,"_")}_${s}_${u}`;let A={blob:n,filename:u,file_ext:a.file_ext,override_name:x,override_path:"",override_filename:x};a.url=yield t.global.try_upload_to_user_custom_fs(A,d,void 0,t.lang.text.Arcade.Title,r),null===(l=t.global.ArcadeWS)||void 0===l||l.send(JSON.stringify({type:"update_reqInfo",socketId:t.global.ArcadeSocketId,keys:["url","cdn_port","apache_port"],url:a.url,cdn_port:t.global.ArcadeCdnPort,apache_port:t.global.ArcadeFilePort}))})),yield t.global.CreateArcadeFrame({url:a.url,blob:n}),t.global.CreateInfoSocket(a.url)})()}QuickLinkContextmenu(){var t=this;return function(){var n=(0,h.A)(function*(){const l="voiddraw",c=yield t.global.GetValueFromClipboard(l);switch(c.type){case"image/png":t.SelectVoidDrawBackgroundImage({target:{files:[c.value]}});break;case"text/plain":const s={file_ext:c.value.split(".").pop()};if(t.global.set_viewer_category_from_ext(s),"image"==s.viewer)try{t.p5loading.update({id:l,message:`${t.lang.text.Arcade.TryingDownload}: ${c.value.split("/").pop()}`,forceEnd:null});const d=yield fetch(c.value);if(!d.ok)throw`${d.statusText} (${d.status})`;const g=yield d.blob();t.p5loading.update({id:l,message:`${t.lang.text.Arcade.TryingDownload}: ${c.value.split("/").pop()}`,progress:1,forceEnd:350}),t.SelectVoidDrawBackgroundImage({target:{files:[g]}});break}catch(d){console.log("\uadf8\ub9bc\ud310 \ube60\ub978 \uc9c4\uc785 \uc624\ub958: ",d)}default:document.getElementById("arcade_voiddraw_img").click()}});return function(){return n.apply(this,arguments)}}()(),!1}SelectVoidDrawBackgroundImage(t){var a=this;return(0,h.A)(function*(){const n="SelectVoidDrawBackgroundImage";a.p5loading.update({id:n,message:`${a.lang.text.ContentViewer.OnLoadContent}: ${t.target.files[0].name}`});const l=t.target.files[0],c=`tmp_files/quick_act/${l.name}`;yield a.indexed.saveBlobToUserPath(l,c);let r=yield a.indexed.loadBlobFromUserPath(c,l.type);const s=URL.createObjectURL(r);new L(d=>{d.setup=()=>{document.getElementById("arcade_voiddraw_img").value="",d.noCanvas(),d.loadImage(s,g=>{a.global.PageDismissAct["arcade-voiddraw"]=u=>{delete a.global.PageDismissAct["arcade-voiddraw"]},a.global.ActLikeModal("portal/arcade/void-draw",{path:c,width:g.width,height:g.height,type:l.type,saveClipboard:!0,dismiss:"arcade-voiddraw"}),URL.revokeObjectURL(s),d.remove()},g=>{console.log("\ube60\ub978 \ud3b8\uc9d1\uae30 \uc774\ub3d9 \uc2e4\ud328: ",g),URL.revokeObjectURL(s),d.remove()})}}),a.p5loading.update({id:n,progress:1,forceEnd:0})})()}JoinSmallTalk(){"online"!=this.statusBar.settings.dedicated_groupchat&&"certified"!=this.statusBar.settings.dedicated_groupchat&&(this.statusBar.settings.dedicated_groupchat="pending"),this.client.RejoinGroupChat()}JoinInstantCall(){this.navCtrl.navigateForward("portal/arcade/instant-call",{animation:B.NC})}copy_address(t){this.global.WriteValueToClipboard("text/plain",t)}copy_address_with_iframe_tag(){return this.global.WriteValueToClipboard("text/plain",`<iframe src="${this.global.ArcadeQRAddress}" style="width: 350px; height: 480px; border: 0;"></iframe>`),!1}OpenScanner(){var t=this;return(0,h.A)(function*(){if(t.OpeningScanner)return;t.OpeningScanner=!0;const a=`arcade_OpenScanner_${Date.now()}`;yield t.p5loading.update({id:a,message:t.lang.text.Arcade.OpeningCamera,forceEnd:null}),t.QRScanResult=null,t.global.StoreShortCutAct("qrcode-scanner");let n="assets/p5js/zxing.html";try{if("1"!=localStorage.getItem("useCache"))throw"\uc624\ud504\ub77c\uc778 \uce90\uc2dc \uc6b0\ud68c\ub97c \uc0ac\uc6a9\ud558\uc9c0 \uc54a\uc74c";const d=yield(yield fetch("assets/p5js/zxing_scanner.js")).blob(),g=URL.createObjectURL(d),x=yield(yield fetch("assets/p5js/libraries/p5.min.js")).blob(),A=URL.createObjectURL(x),b=yield(yield fetch("assets/p5js/libraries/zxing@0.21.3.min.js")).blob(),k=URL.createObjectURL(b);let y=yield(yield fetch("assets/p5js/zxing.html")).text();y=y.replace('<script language="javascript" type="text/javascript" src="libraries/p5.min.js"><\/script>',`<script language="javascript" type="text/javascript" src="${A}"><\/script>`).replace('<script language="javascript" type="text/javascript" src="libraries/zxing@0.21.3.min.js"><\/script>',`<script language="javascript" type="text/javascript" src="${k}"><\/script>`).replace('<script language="javascript" type="text/javascript" src="zxing_scanner.js"><\/script>',`<script language="javascript" type="text/javascript" src="${g}"><\/script>`);const w=new Blob([y],{type:"text/html"});n=URL.createObjectURL(w),t.InAppQRScanner.onDidDismiss().then(()=>{URL.revokeObjectURL(n),URL.revokeObjectURL(g),URL.revokeObjectURL(A),URL.revokeObjectURL(k),t.ChangeDeviceFunc=null,t.global.RestoreShortCutAct("qrcode-scanner")})}catch(r){console.log("QR\uc2a4\uce90\ub108 \uc624\ud504\ub77c\uc778 \ud398\uc774\uc9c0 \ubd88\ub7ec\uc624\uae30 \uc2e4\ud328: ",r),t.InAppQRScanner.onDidDismiss().then(()=>{t.ChangeDeviceFunc=null,t.global.RestoreShortCutAct("qrcode-scanner")})}yield t.InAppQRScanner.present(),t.OpeningScanner=!1,t.p5loading.remove(a);const l=document.getElementById("qr_scan_frame");l.src=n;const c=l.contentWindow||l.contentDocument;setTimeout(()=>{t.ChangeDeviceFunc=c.ChangeDevice,c.load_failed=r=>{t.p5toast.show({text:`${t.lang.text.Subscribes.QRScanInitFailed}: ${(r.statusText?`${r.statusText}(${r.status})`:r.status)||r}`}),t.InAppQRScanner.dismiss()},c.scan_result=function(){var r=(0,h.A)(function*(s){try{t.QRScanResult=s.text,t.QRScanResult&&(yield t.nakama.open_url_link(null,t.QRScanResult,!1))&&t.InAppQRScanner.dismiss()}catch(d){console.log("QR\uc2a4\uce94 \uc2e4\ud328: ",d)}});return function(s){return r.apply(this,arguments)}}()},1e3)})()}ChangeScanDevice(){this.ChangeDeviceFunc&&this.ChangeDeviceFunc()}OpenQuickLink(){var t=this;const a=`arcade_OpenQuickLink_${Date.now()}`;return function(){var l=(0,h.A)(function*(){const c=yield t.global.GetValueFromClipboard(a);switch(c.type){case"text/plain":const r=c.value,s=yield t.global.GetHeaderAddress();if(0==r.indexOf("https://is2you2.github.io/pjcone_pwa/?")||0==r.indexOf(`${s}?`)||0==r.indexOf(`${t.global.CustomLocalAddress}?`)){const d=t.global.CatchGETs(r)||{};try{const g=yield t.nakama.AddressToQRCodeAct(d,!0);yield t.nakama.act_from_QRInfo(g,"portal/arcade/")}catch(g){console.log("open_url_link: ",g),t.p5toast.show({text:`${t.lang.text.AddGroup.DiffFormat}: ${(g.statusText?`${g.statusText}(${g.status})`:g.status)||g}`})}}else console.log("\uc8fc\uc18c \uc2dc\uc791\uc810 \uc624\ub958: ",r),t.p5loading.update({id:a,message:`${t.lang.text.AddGroup.DiffFormat}: ${r}`,progress:0});break;case"image/png":t.LoadFileFromLocalAct({target:{files:[c.value]}});break;case"error":t.p5toast.show({text:`${t.lang.text.GlobalAct.FailedToReadClipboard}: ${c.value}`})}});return function(){return l.apply(this,arguments)}}()(),!1}ToggleExtMenu(t){this.ShowExtMenus=null!=t?t:!this.ShowExtMenus,setTimeout(()=>{this.global.auto_scroll_down()},0)}focus_on_input(t){var a;"MobilePWA"==V.aH&&(this.ShowExtMenus=!1),null===(a=this.arcadeInput)||void 0===a||a.setFocus(),this.global.auto_scroll_down(t)}StopAndSaveVoiceRecording(){var t=this;return(0,h.A)(function*(){t.floatButton.RemoveFloatButton("sqaure-record");const a="arcade_chat";t.p5loading.update({id:a,message:t.lang.text.AddPost.SavingRecord});try{let n=yield t.global.StopAndSaveVoiceRecording();yield t.SendAttachAct({target:{files:[n]}},a)}catch{}t.p5loading.remove(a),t.extended_buttons[4].icon="mic-circle-outline",t.extended_buttons[4].name=t.lang.text.ChatRoom.Voice})()}open_file_viewer(t){var a=this;const n="arcade_chat";let l=[];for(let c=0,r=this.global.arcadeChat.logs.length;c<r;c++)try{this.global.arcadeChat.logs[c].file.info.filename&&l.push({content:JSON.parse(JSON.stringify(this.global.arcadeChat.logs[c].file.info))})}catch{}this.global.PageDismissAct["minimal-ionic-viewer"]=function(){var c=(0,h.A)(function*(r){if(r.data)switch(r.data.type){case"image":let s=[];if(r.data.msg.content.content_related_creator&&(s=[...r.data.msg.content.content_related_creator]),r.data.msg.content.content_creator){let d=!1;for(let g=0,u=s.length;g<u;g++)if(s[g].user_id==r.data.msg.content.content_creator.user_id){d=!0;break}d||s.push(r.data.msg.content.content_creator)}return a.global.PageDismissAct["minimal-ionic-viewer-edit"]=d=>{if(d.data){a.p5loading.remove(d.data.loadingCtrl);let g=d.data.img;a.indexed.saveBase64ToUserPath(g,`tmp_files/sqaure/${d.data.name}`);let x=a.global.Base64ToBlob(g,"image/png");x.name=d.data.name,a.SendAttachAct({target:{files:[x]}},n)}delete a.global.PageDismissAct["minimal-ionic-viewer-edit"]},yield a.WaitingCurrent(),void a.global.ActLikeModal("void-draw",{path:r.data.path||t.path,width:r.data.width,height:r.data.height,type:r.data.filetype,isDarkMode:r.data.isDarkMode,scrollHeight:r.data.scrollHeight,dismiss:"minimal-ionic-viewer-edit"});case"text":r.data.blob.name=a.global.TextEditorNewFileName(),r.data.path=`tmp_files/texteditor/${r.data.blob.name}`,a.SendAttachAct({target:{files:[r.data.blob]}},n)}delete a.global.PageDismissAct["minimal-ionic-viewer"]});return function(r){return c.apply(this,arguments)}}(),this.global.ActLikeModal("ionic-viewer",{info:{content:t},isOfficial:"local",path:t.path,relevance:l,dismiss:"minimal-ionic-viewer"})}CreateFloatingVoiceTimeHistoryAddButton(){this.floatButton.RemoveFloatButton("sqaure-record"),this.floatButton.AddFloatButton("sqaure-record","mic-outline").mouseClicked(()=>{this.p5toast.show({text:`${this.lang.text.GlobalAct.ArcadeRecording}`})})}SelectAttach(){document.getElementById("arcade_file_input").click()}new_attach(t){var a=this;return(0,h.A)(function*(){const n="arcade_chat";switch(t.detail.value){case"camera":try{let s=yield a.global.from_camera("tmp_files/square/",{display_name:a.nakama.users.self.display_name},n);s&&a.TrySendingAttach(s,n)}catch{}break;case"text":let c=a.global.TextEditorNewFileName();a.global.PageDismissAct["minimal-textedit"]=s=>{if(s.data){let d=a.global.TextEditorAfterAct(s.data,{display_name:a.nakama.users.self.display_name});a.TrySendingAttach(d,n)}delete a.global.PageDismissAct["minimal-textedit"]},a.global.ActLikeModal("ionic-viewer",{info:{content:{is_new:"text",type:"text/plain",viewer:"text",filename:c}},noEdit:!0,dismiss:"minimal-textedit"});break;case"image":a.global.PageDismissAct["arcade-image"]=function(){var s=(0,h.A)(function*(d){if(d.data){let g=yield a.global.voidDraw_fileAct_callback(d,"tmp_files/square/",{display_name:a.nakama.users.self.display_name});a.TrySendingAttach(g,n)}delete a.global.PageDismissAct["arcade-image"]});return function(d){return s.apply(this,arguments)}}(),a.global.ActLikeModal("void-draw",{dismiss:"arcade-image"});break;case"load":a.SelectAttach();break;case"link":let r;try{var l;try{let u=yield a.global.GetValueFromClipboard(n);switch(u.type){case"text/plain":r=u.value;break;case"image/png":return void a.SendAttachAct({target:{files:[u.value]}},n);case"error":throw u.value}}catch(u){throw u}try{let u=a.global.Base64ToBlob(r),x=r.split(";")[0].split(":")[1],A=new File([u],`${a.lang.text.ChatRoom.FileLink}.${x.split("/").pop()}`,{type:x});throw a.SendAttachAct({target:{files:[A]}},n),"done"}catch(u){if("done"===u)throw u}try{if(0!=r.indexOf("http:")&&0!=r.indexOf("https:"))throw"\uc62c\ubc14\ub978 \uc6f9 \uc8fc\uc18c\uac00 \uc544\ub2d8"}catch(u){throw u}let s={};s.url=r,s.content_related_creator=[],s.content_related_creator.push({user_id:a.global.ArcadeWSPeerId,timestamp:(new Date).getTime(),display_name:a.nakama.users.self.display_name,various:"link"}),s.content_creator={user_id:a.global.ArcadeWSPeerId,timestamp:(new Date).getTime(),display_name:a.nakama.users.self.display_name,various:"link"};let d=s.url.split(".");s.file_ext=d.pop().split("?").shift(),s.filename=decodeURIComponent(s.url.split("/").pop()||`${a.lang.text.ChatRoom.ExternalLinkFile}.${s.file_ext}`),a.global.set_viewer_category_from_ext(s),s.type="",s.typeheader=s.viewer,null===(l=a.global.ArcadeWS)||void 0===l||l.send(JSON.stringify({type:"file",info:s,name:a.nakama.users.self.display_name}))}catch(s){throw"done"==s?s:`\uc778\uc2dd \ubd88\uac00\ub2a5\ud55c URL \uc815\ubcf4: ${(s.statusText?`${s.statusText}(${s.status})`:s.status)||s}`}}})()}imitationSendFile(t,a){var n=this;return(0,h.A)(function*(){var l,c,r;yield n.p5loading.update({id:a,message:`${n.lang.text.ChatRoom.attachments}: ${null===(l=t.info)||void 0===l?void 0:l.filename}`,progress:null});const d=t.name?`${t.name} (${n.lang.text.MinimalChat.name_me})`:n.lang.text.MinimalChat.name_me,g=t.uid?(t.uid.replace(/[^5-79a-b]/g,"")+"abcdef").substring(0,6):T.ud?"607773":"8a6d66",u=null===(c=t.info)||void 0===c?void 0:c.blob,x=`tmp_files/arcade/imitationSend/${null===(r=t.info)||void 0===r?void 0:r.filename}`;yield n.indexed.saveBlobToUserPath(u,x),t.info.path=x,n.global.arcadeChat.logs.push({color:g,file:t,target:d,isMe:!0}),n.global.auto_scroll_down(),n.p5loading.remove(a)})()}SendAttachAct(t,a){var n=this;return(0,h.A)(function*(){n.p5loading.update({id:a,message:`${n.lang.text.ContentViewer.OnLoadContent}: ${t.target.files[0].name}`});let l=t.target.files[0],c={};c.blob=l,c.filename=l.name,c.size=l.size,c.file_ext=l.name.split(".").pop(),c.type=l.type,n.global.set_viewer_category(c),c.content_related_creator=[{user_id:n.global.ArcadeWSPeerId,timestamp:(new Date).getTime(),display_name:n.nakama.users.self.display_name,various:"loaded"}],c.content_creator={user_id:n.global.ArcadeWSPeerId,timestamp:(new Date).getTime(),display_name:n.nakama.users.self.display_name,various:"loaded"},n.p5loading.update({id:a,progress:1,forceEnd:0}),yield n.TrySendingAttach(c,a)})()}TrySendingAttach(t,a){var n=this;return(0,h.A)(function*(){let l={type:"file",info:t,name:n.nakama.users.self.display_name};if(n.global.ArcadeWS){try{const r=n.global.ArcadeWSAddress.split("://"),s=`${"wss"==r[0]?"https":"http"}://${r[1]},${n.global.ArcadeCdnPort||9001},${n.global.ArcadeFilePort||9002}`,d=(new Date).getTime(),g=`tmp_${n.global.ArcadeJoinedChannel}_${n.global.ArcadeWSPeerId}`;t.override_name=`${g.replace(/\//g,"_")}_${d}_${t.filename}`,t.override_path="",t.override_filename=t.override_name,delete t.thumbnail;const u=yield n.global.try_upload_to_user_custom_fs(t,g,a,n.lang.text.Arcade.Title,s);if(!u)throw"\uc11c\ubc84\uc5d0 \uc5c5\ub85c\ub4dc \uc2e4\ud328";var c;t.url=u,delete t.blob,null===(c=n.global.ArcadeWS)||void 0===c||c.send(JSON.stringify(l))}catch(r){console.log("\ud30c\uc77c \uc804\uc1a1 \uc2e4\ud328: ",r),n.p5toast.show({text:`${n.lang.text.Nakama.FailedUpload}: ${(r.statusText?`${r.statusText}(${r.status})`:r.status)||r}`})}n.p5loading.remove(a),n.global.auto_scroll_down()}else n.imitationSendFile(l,a)})()}send(){var t;null===(t=this.global.ArcadeChatLog)||void 0===t||t.scrollTo({top:this.global.ArcadeChatLog.scrollHeight,behavior:"smooth"});let a={type:"text",msg:this.global.arcadeChat.text};if(a.msg.trim()){if(this.ShowExtMenus=!1,a.name=this.nakama.users.self.display_name,this.global.ArcadeWS)this.global.ArcadeWS.send(JSON.stringify(a));else{let n=a.msg.split(" "),l=[],c="";const r=a.name?`${a.name} (${this.lang.text.MinimalChat.name_me})`:this.lang.text.MinimalChat.name_me,s=a.uid?(a.uid.replace(/[^5-79a-b]/g,"")+"abcdef").substring(0,6):T.ud?"607773":"8a6d66";for(let g=0,u=n.length;g<u;g++)0==n[g].indexOf("http://")||0==n[g].indexOf("https://")?(l.push({text:" "+c+" "}),c="",l.push({href:!0,text:n[g]})):c+=" "+n[g];c&&l.push({text:" "+c}),this.global.arcadeChat.logs.push({color:s,text:l,target:r,isMe:!0}),this.global.auto_scroll_down()}this.global.arcadeChat.text="",this.focus_on_input()}}}return(o=_).\u0275fac=function(t){return new(t||o)(e.rXU(E.y),e.rXU(M.j),e.rXU(N.X),e.rXU(X.q9),e.rXU(O.z),e.rXU(T.z3),e.rXU(U.n),e.rXU(f.Hx),e.rXU(Q.G),e.rXU(Y.f),e.rXU(J.u),e.rXU(W.r))},o.\u0275cmp=e.VBU({type:o,selectors:[["app-arcade"]],viewQuery:function(t,a){if(1&t&&(e.GBs(z,5),e.GBs(H,5),e.GBs(Z,5),e.GBs(K,5)),2&t){let n;e.mGM(n=e.lsd())&&(a.ArcadeDetail=n.first),e.mGM(n=e.lsd())&&(a.ArcadeQRShare=n.first),e.mGM(n=e.lsd())&&(a.InAppQRScanner=n.first),e.mGM(n=e.lsd())&&(a.arcadeInput=n.first)}},decls:13,vars:6,consts:[["ArcadeDetail",""],["ArcadeQRShare",""],["InAppQRScanner",""],["arcadeInput",""],["ArcadePlayServer",""],["class","ion-no-border",4,"ngIf"],[3,"fullscreen"],[4,"ngIf"],["style","position: relative; height: 100%;",4,"ngIf"],[1,"transparent-modal",3,"enterAnimation","leaveAnimation"],[1,"transparent-modal"],[1,"ion-no-border"],["hidden","","type","file","id","arcade_voiddraw_img","accept","image/*",3,"change"],[1,"add_group","top_icon_override_1",3,"click"],["button","","name","call-outline",2,"width","24px","height","24px"],[1,"add_group",3,"click"],["button","","name","chatbubbles-outline",2,"width","24px","height","24px"],[1,"header_online_circle",3,"click"],[1,"fixed_btn_size"],[1,"list_ele","list_add_btn",3,"click","contextmenu"],[1,"disconnect_info"],["color","medium","name","qr-code-outline",2,"width","36px","height","36px"],["color","medium"],["hidden","","type","file","id","arcade_file_load","multiple","","accept","*",3,"change"],["hidden","","type","file","id","arcade_ingame_load","accept","*",3,"change"],["color","medium","name","document-outline",2,"width","36px","height","36px"],["src","assets/icon/voidDraw.png",2,"width","36px","height","36px"],["color","medium","name","add-circle-outline",2,"width","36px","height","36px"],["hidden","","type","file","id","add_test_arcade","multiple","","accept",".pck",3,"change"],["class","list_ele list_add_btn",3,"hidden","click","contextmenu",4,"ngFor","ngForOf"],[1,"list_ele","list_add_btn",3,"click","contextmenu","hidden"],[2,"position","relative","height","100%"],["id","arcade_pck_loaded",1,"full_screen"],["style","display: flex; justify-content: center; align-items: center; width: 100%; position: absolute; bottom: 0; color: var(--arcade-fix-color);",4,"ngIf"],[2,"display","flex","justify-content","center","align-items","center","width","100%","position","absolute","bottom","0","color","var(--arcade-fix-color)"],[2,"width","100%","max-width","650px","overflow-y","hidden"],["id","arcadeChatLog",2,"width","100%","height","fit-content","max-height","84px","overflow-y","scroll","padding","8px","background","linear-gradient(to top, var(--arcade-background-transparent), transparent)"],[2,"pointer-events","none","user-select","text"],[4,"ngFor","ngForOf"],[2,"width","100%","background-color","var(--arcade-background-transparent)"],["expand","block","fill","clear",3,"click"],["name","add-outline"],["hidden","","type","file","id","arcade_file_input","accept","*",3,"change"],[2,"width","100%"],["id","arcadeInput","type","text",3,"ionFocus","ionBlur","keyup.enter","ngModelChange","placeholder","ngModel"],["name","send"],["style","overflow-x: hidden; overflow-y: auto; scroll-behavior: smooth; text-align: center; background-color: var(--arcade-background-transparent); padding-bottom: 16px;",4,"ngIf"],[3,"style",4,"ngIf"],["class","default_text",4,"ngIf"],[1,"default_text"],["target","_system","onclick","return false;","style","pointer-events: all;",3,"href","click",4,"ngIf"],["target","_system","onclick","return false;",2,"pointer-events","all",3,"click","href"],[1,"file_attach_box",3,"click"],[2,"overflow-x","hidden","overflow-y","auto","scroll-behavior","smooth","text-align","center","background-color","var(--arcade-background-transparent)","padding-bottom","16px"],["style","display: inline-block;",4,"ngFor","ngForOf"],[2,"display","inline-block"],[1,"ext_button",3,"click","contextmenu","hidden"],["slot","icon-only","style","width: 36px; height: 36px;",3,"name",4,"ngIf"],["class","ext_icon_img",3,"src","alt",4,"ngIf"],["slot","icon-only",2,"width","36px","height","36px",3,"name"],[1,"ext_icon_img",3,"src","alt"],["id","arcade_detail",1,"OutterModal",3,"click"],[2,"justify-content","center","align-items","center","overflow-y","auto"],[1,"arcade_modal"],[2,"display","flex","flex-direction","column","width","100%","height","100%","background-color","var(--arcade-detail-modal)","padding","16px","border-radius","16px"],["style","text-align: start; margin: 8px 0px;",4,"ngIf"],[2,"text-align","start","margin","8px 0px"],[2,"text-align","start","flex-grow","1","overflow-y","scroll"],["value","colors","expand","inset",3,"value","click",4,"ngIf"],["style","margin-bottom: 8px;",4,"ngIf"],[1,"ion-align-self-center",3,"click","disabled"],["class","ion-align-self-center","color","danger","style","margin-left: 4px;",3,"click",4,"ngIf"],[3,"href",4,"ngIf"],[3,"href"],["value","colors","expand","inset",3,"click","value"],["value","colors"],["slot","header"],[2,"display","contents"],[1,"ion-text-right"],[1,"ion-accordion-toggle-icon","hide_accordion_icon"],["slot","content"],["button","",3,"click",4,"ngFor","ngForOf"],["button","",3,"click"],[2,"margin-bottom","8px"],["type","text","placeholder","(wss://)0.0.0.0,12013,9001",1,"ion-text-end",3,"ngModelChange","label","ngModel"],["color","danger",1,"ion-align-self-center",2,"margin-left","4px",3,"click"],["id","arcade_qrmodal",1,"OutterModal",3,"click"],[2,"display","flex","justify-content","center","align-items","center"],[2,"width","400px","min-height","455px","background-color","var(--chatroom-background)","text-align","center","padding","16px"],["style","width: 100%; height: auto; cursor: copy; margin-bottom: 8px;","alt","ArcadeQuickLink",3,"src","click","contextmenu",4,"ngIf"],[1,"ion-text-center"],["alt","ArcadeQuickLink",2,"width","100%","height","auto","cursor","copy","margin-bottom","8px",3,"click","contextmenu","src"],["id","inapp_qrscanner",1,"OutterModal",3,"click"],[2,"width","400px","min-height","455px","background-color","var(--chatroom-background)","text-align","center","padding","16px","position","relative"],[2,"position","absolute","width","64px","height","64px","cursor","pointer","margin","16px","background-color","#8888","border-radius","24px","top","0","right","0","text-align","center","align-content","center",3,"click"],["name","camera-reverse-outline",2,"width","36px","height","36px"],["id","qr_scan_frame","frameborder","0",2,"width","100%","height","368px","margin-bottom","8px"],["class","ion-text-center","color","medium",4,"ngIf"],["class","ion-text-center",4,"ngIf"],["color","medium",1,"ion-text-center"]],template:function(t,a){1&t&&(e.DNE(0,q,10,3,"ion-header",5),e.j41(1,"ion-content",6),e.DNE(2,te,38,6,"div",7)(3,he,3,1,"div",8),e.j41(4,"ion-modal",9,0),e.DNE(6,Re,17,11,"ng-template"),e.k0s(),e.j41(7,"ion-modal",10,1),e.DNE(9,Te,7,2,"ng-template"),e.k0s(),e.j41(10,"ion-modal",10,2),e.DNE(12,$e,9,2,"ng-template"),e.k0s()()),2&t&&(e.Y8G("ngIf",!a.global.ArcadeLoaded),e.R7$(),e.Y8G("fullscreen",!0),e.R7$(),e.Y8G("ngIf",!a.global.ArcadeLoaded),e.R7$(),e.Y8G("ngIf",a.global.ArcadeLoaded),e.R7$(),e.Y8G("enterAnimation",a.enterAnimation)("leaveAnimation",a.leaveAnimation))},dependencies:[$.Sq,$.bT,I.BC,I.vS,f.xk,f.YH,f.Jm,f.W9,f.eU,f.iq,f.$w,f.uz,f.Dg,f.he,f.BC,f.ai,f.Sb,f.Gw],styles:[".list_form[_ngcontent-%COMP%]{display:grid;grid-template-columns:repeat(auto-fill,minmax(135px,1fr));padding:16px;gap:16px}.list_add_btn[_ngcontent-%COMP%]{flex:0 1}p[_ngcontent-%COMP%]{margin:8px 0 0}.default_text[_ngcontent-%COMP%]{color:var(--arcade-fix-color)}.file_attach_box[_ngcontent-%COMP%]{margin-left:8px;padding:2px 8px;border-radius:6px;background-color:#8888;cursor:pointer;color:var(--arcade-fix-color);pointer-events:all}.fixed_btn_size[_ngcontent-%COMP%]{display:flex;flex-direction:row;gap:16px;overflow-x:auto;margin:16px 16px 0;padding-bottom:16px}.arcade_modal[_ngcontent-%COMP%]{display:flex;flex-direction:column;width:400px;height:455px;background-color:var(--chatroom-background);text-align:center;border-radius:16px}.list_ele[_ngcontent-%COMP%]{overflow:hidden;cursor:pointer;border:1px solid var(--list-shortcut-hint-background);border-radius:8px;min-width:135px;min-height:90px;text-align:center;align-content:center;position:relative}.add_group[_ngcontent-%COMP%]{position:absolute;right:68px;top:16px;cursor:pointer}.top_icon_override_1[_ngcontent-%COMP%]{right:116px}ion-input[_ngcontent-%COMP%]{--highlight-color-valid: var(--ion-color-primary)}"],data:{animation:[(0,v.hZ)("arcade_chat",[(0,v.kY)(":enter",[(0,v.iF)({opacity:0}),(0,v.i0)(".3s ease-out",(0,v.iF)({opacity:1}))])]),(0,v.hZ)("pck_changed",[(0,v.kY)(":enter",[(0,v.iF)({transform:"scale(0)",opacity:0}),(0,v.i0)(".3s ease-out",(0,v.iF)({transform:"scale(1)",opacity:1}))]),(0,v.kY)(":leave",[(0,v.iF)({opacity:0}),(0,v.i0)(".3s ease-out",(0,v.iF)({opacity:1,transform:"scale(0)"}))])])]}}),_})()},{path:"instant-call",loadChildren:()=>p.e(6524).then(p.bind(p,6524)).then(o=>o.InstantCallPageModule)},{path:"void-draw",loadChildren:()=>Promise.all([p.e(6042),p.e(2655)]).then(p.bind(p,2655)).then(o=>o.VoidDrawPageModule)},{path:"ionic-viewer",loadChildren:()=>Promise.all([p.e(6042),p.e(4803),p.e(222)]).then(p.bind(p,4803)).then(o=>o.IonicViewerPageModule)},{path:"post-viewer",loadChildren:()=>Promise.all([p.e(222),p.e(526)]).then(p.bind(p,526)).then(o=>o.PostViewerPageModule)}];let Pe=(()=>{var o;class _{}return(o=_).\u0275fac=function(t){return new(t||o)},o.\u0275mod=e.$C({type:o}),o.\u0275inj=e.G2t({imports:[D.iI.forChild(Ie),D.iI]}),_})(),Fe=(()=>{var o;class _{}return(o=_).\u0275fac=function(t){return new(t||o)},o.\u0275mod=e.$C({type:o}),o.\u0275inj=e.G2t({imports:[$.MD,I.YN,f.bv,Pe]}),_})()}}]);