"use strict";(self.webpackChunkapp=self.webpackChunkapp||[]).push([[542],{1186:(Z,A,c)=>{c.d(A,{M:()=>y});const y=(0,c(2726).fo)("SpeechRecognition",{web:()=>c.e(4850).then(c.bind(c,7554)).then(T=>new T.SpeechRecognitionWeb)})},5961:(Z,A,c)=>{c.d(A,{GW:()=>y,dk:()=>T,oK:()=>E});var E=function(u){return u.Prompt="PROMPT",u.Camera="CAMERA",u.Photos="PHOTOS",u}(E||{}),y=function(u){return u.Rear="REAR",u.Front="FRONT",u}(y||{}),T=function(u){return u.Uri="uri",u.Base64="base64",u.DataUrl="dataUrl",u}(T||{})},8162:(Z,A,c)=>{c.d(A,{V1:()=>T,dk:()=>y.dk,oK:()=>y.oK});var E=c(2726),y=c(5961);const T=(0,E.fo)("Camera",{web:()=>c.e(6468).then(c.bind(c,6468)).then(u=>new u.CameraWeb)})},477:(Z,A,c)=>{c.d(A,{$:()=>ce});var E=c(5861),y=c(9868),u=c(3641),h=c(9468),ae=c(3857),v=c(1325),re=c(6052),se=c(797);let ce=(()=>{var I;class Q{constructor(i,l,m,e,a,d,L){this.lang=i,this.modalCtrl=l,this.alertCtrl=m,this.loadingCtrl=e,this.global=a,this.navParams=d,this.indexed=L,this.initialized=!1,this.EventListenerAct=D=>{D.detail.register(130,S=>{})},this.WithoutSave=!0}ngOnInit(){}ionViewDidEnter(){var i=this;return(0,E.Z)(function*(){i.global.p5key.KeyShortCut.HistoryAct=l=>{switch(l){case"Z":i.act_history(-1);break;case"X":i.act_history(1);break;case"C":i.p5voidDraw.change_color();break;case"V":i.p5voidDraw.set_line_weight()}},i.global.p5key.KeyShortCut.AddAct=()=>{i.new_image()},i.global.p5key.KeyShortCut.DeleteAct=()=>{i.dismiss_draw()},i.global.p5key.KeyShortCut.SKeyAct=()=>{i.open_crop_tool()},document.addEventListener("ionBackButton",i.EventListenerAct),i.mainLoading=yield i.loadingCtrl.create({message:i.lang.text.voidDraw.UseThisImage}),i.create_new_canvas({width:i.navParams.data.width,height:i.navParams.data.height,path:i.navParams.data.path})})()}create_new_canvas(i){i.width=i.width||432,i.height=i.height||432,this.p5voidDraw&&this.p5voidDraw.remove(),this.create_p5voidDraw(i)}create_p5voidDraw(i){var l=this;let m=document.getElementById("voidDraw");this.p5voidDraw=new y(e=>{let a,d,L,D,S,U,W,ee=e.createColorPicker("#000"),z=!1,te=e.min(i.width,i.heigth),x=e.createSlider(1,te/10,te/100);const he="Android"==u.n$||"iOS"==u.n$?.6:1;e.setup=(0,E.Z)(function*(){x.parent(m),x.hide(),e.pixelDensity(he),e.smooth(),e.noLoop(),e.noFill(),e.imageMode(e.CENTER),L=e.createCanvas(m.clientWidth,m.clientHeight),L.elt.addEventListener("contextmenu",s=>s.preventDefault()),L.parent(m),w.x=e.width/2,w.y=e.height/2,e.set_line_weight=()=>{z=!z,z?x.show():x.hide()},e.change_color=()=>{console.log("change_color")},e.save_image=()=>{new y(s=>{s.setup=()=>{s.createCanvas(a.width,a.height),d&&s.image(d,0,0),a&&s.image(a,0,0),s.saveFrames("","png",1,1,M=>{let p=M[0].imageData.replace(/"|=|\\/g,"");l.modalCtrl.dismiss({name:`voidDraw_${s.year()}-${s.nf(s.month(),2)}-${s.nf(s.day(),2)}_${s.nf(s.hour(),2)}-${s.nf(s.minute(),2)}-${s.nf(s.second(),2)}.png`,img:p,loadingCtrl:l.mainLoading}),s.remove()})}})},e.history_act=s=>{switch(k=e.min(e.max(0,k+s),b.length),s){case 1:U.style.fill="var(--ion-color-dark)",k==b.length&&(W.style.fill="var(--ion-color-medium)"),K(a,b[k-1]);break;case-1:W.style.fill="var(--ion-color-dark)",k<1?(U.style.fill="var(--ion-color-medium)",a.background(255,0),e.redraw()):ue()}},e.open_crop_tool=()=>{},D=e.createElement("table"),D.style("position: absolute; top: 0px;"),D.style(`width: 100%; height: ${_}px;`),D.style("background-color: var(--voidDraw-menu-background);"),D.parent(m);let t=D.elt.insertRow(0),o=t.insertCell(0);o.innerHTML='<ion-icon style="width: 27px; height: 27px" name="add"></ion-icon>',o.style.textAlign="center",o.style.cursor="pointer",o.onclick=()=>{l.new_image()};let n=t.insertCell(1);n.innerHTML='<ion-icon id="CropToolNotReady" style="width: 27px; height: 27px" name="crop"></ion-icon>',document.getElementById("CropToolNotReady").style.fill="var(--ion-color-medium)",n.style.textAlign="center",n.style.cursor="pointer",n.onclick=()=>{l.open_crop_tool()};let f=t.insertCell(2);f.innerHTML='<ion-icon style="width: 27px; height: 27px" name="checkmark"></ion-icon>',f.style.textAlign="center",f.style.cursor="pointer",f.onclick=()=>{l.dismiss_draw()},S=e.createElement("table"),S.style("position: absolute; bottom: 0px;"),S.style(`width: 100%; height: ${_}px;`),S.style("background-color: var(--voidDraw-menu-background);"),S.parent(m);let H=S.elt.insertRow(0),$=H.insertCell(0);$.innerHTML='<ion-icon id="undoIcon" style="width: 27px; height: 27px" name="arrow-undo"></ion-icon>',U=document.getElementById("undoIcon"),U.style.fill="var(--ion-color-medium)",$.style.textAlign="center",$.style.cursor="pointer",$.onclick=()=>{l.act_history(-1)};let N=H.insertCell(1);N.innerHTML='<ion-icon id="redoIcon" style="width: 27px; height: 27px" name="arrow-redo"></ion-icon>',W=document.getElementById("redoIcon"),W.style.fill="var(--ion-color-medium)",N.style.textAlign="center",N.style.cursor="pointer",N.onclick=()=>{l.act_history(1)};let J=H.insertCell(2);ee.parent(J),J.style.textAlign="center",J.style.cursor="pointer";let F=H.insertCell(3);if(F.innerHTML='<ion-icon style="width: 27px; height: 27px" name="pencil"></ion-icon>',F.style.textAlign="center",F.style.cursor="pointer",F.onclick=()=>{l.change_line_weight()},e.SetCanvasViewportInit=()=>{L.hide(),e.resizeCanvas(m.clientWidth,m.clientHeight),B.x=e.width/2,B.y=e.height/2,w.x=0,w.y=0;let s=m.clientHeight-112;C=m.clientWidth/s<a.width/a.height?m.clientWidth/a.width:s/a.height,L.show(),x.position(e.width-x.width,e.height-x.height-_),e.redraw()},a=e.createGraphics(i.width,i.height,e.WEBGL),a.smooth(),a.noLoop(),a.noFill(),i.path){let s=yield l.indexed.loadBlobFromUserPath(i.path,""),M=URL.createObjectURL(s);e.loadImage(M,p=>{a.resizeCanvas(p.width,p.height),d=e.createGraphics(p.width,p.height,e.WEBGL),d.noLoop(),d.noFill(),d.background(255),d.imageMode(e.CENTER),d.image(p,0,0),URL.revokeObjectURL(M),e.SetCanvasViewportInit(),e.redraw()},p=>{console.error("\uadf8\ub9bc\ud310 \ubc30\uacbd \uc774\ubbf8\uc9c0 \ubd88\ub7ec\uc624\uae30 \uc624\ub958: ",p),URL.revokeObjectURL(M)})}else d=e.createGraphics(i.width,i.height,e.WEBGL),d.noLoop(),d.background(255),e.SetCanvasViewportInit(),e.redraw();l.initialized=!0});let w=e.createVector(),C=1,B=e.createVector(0,0),ie=e.createVector();e.draw=()=>{if(e.clear(255,255,255,255),e.push(),e.translate(B),e.scale(C),e.translate(w),d&&(d.push(),d.translate(ie),e.image(d,0,0),d.pop()),a&&(a.push(),a.translate(ie),e.image(a,0,0),a.pop()),r&&r.pos&&r.pos.length){e.push(),e.stroke(r.color),e.strokeWeight(r.weight),e.beginShape();for(let t=0,o=r.pos.length;t<o;t++)e.curveVertex(r.pos[t].x,r.pos[t].y);e.endShape(),e.pop()}e.pop()};let b=[],k=0,ue=()=>{a.background(255,0);for(let t=k-1;t>=0;t--)K(a,b[t])},K=(t=a,o=r)=>{t.push(),t.noFill(),t.stroke(o.color),t.strokeWeight(o.weight),t.beginShape();for(let n=0,f=o.pos.length;n<f;n++)t.curveVertex(o.pos[n].x,o.pos[n].y);t.endShape(),t.pop(),t.redraw(),e.redraw()};e.windowResized=()=>{setTimeout(()=>{e.SetCanvasViewportInit()},0)};let r={};const _=56;let G,R,oe,V,j=0,P=!1;e.mousePressed=t=>{if(e.mouseY<_||e.mouseY>e.height-_)P=!0;else switch(t.which){case 1:ne();break;case 3:R=e.createVector(e.mouseX,e.mouseY),V=w.copy(),G=e.createVector(e.mouseX,e.mouseY);break;case 2:e.SetCanvasViewportInit()}};let ne=(t,o)=>{U.style.fill="var(--ion-color-dark)",W.style.fill="var(--ion-color-medium)";let n=O(t,o),f={x:n.x,y:n.y};r={pos:[],color:ee.color(),weight:Number(x.value())},r.pos.push(f),r.pos.push(f),e.redraw()};e.mouseDragged=t=>{switch(t.which){case 1:let o=O();r&&r.pos.push({x:o.x,y:o.y}),e.redraw();break;case 3:G=e.createVector(e.mouseX,e.mouseY),w=V.copy().add(G.sub(R).div(C)),e.redraw()}},e.mouseWheel=t=>{e.mouseY<_||e.mouseY>e.height-_?P=!0:(ge(O()),C*=t.deltaY<0?1.1:.9,e.redraw())},e.mouseReleased=t=>{if(1===t.which&&!P){let o=O(),n={x:o.x,y:o.y};r&&(r.pos.push(n),r.pos.push(n)),le()}P=!1};let ge=t=>{B=e.createVector(e.mouseX,e.mouseY),w=t.mult(-1)},O=(t,o)=>{let n=e.createVector(t||e.mouseX,o||e.mouseY);return n.sub(B),n.div(C),n.sub(w),n},g=[],X=!1;e.touchStarted=t=>{if(g=t.touches,t.changedTouches[0].clientY<_||t.changedTouches[0].clientY>e.height-_)P=!0;else switch(X=!0,g.length){case 1:ne(t.changedTouches[0].clientX,t.changedTouches[0].clientY-_);break;case 2:let o=e.createVector(g[0].clientX,g[0].clientY-56),n=e.createVector(g[1].clientX,g[1].clientY-56);j=o.dist(n),R=o.copy().add(n).div(2),V=w.copy(),oe=C,r=void 0;break;default:X=!1,e.SetCanvasViewportInit()}},e.touchMoved=t=>{switch(g=t.touches,g.length){case 1:{let o=O(t.changedTouches[0].clientX,t.changedTouches[0].clientY-_);r&&r.pos.push({x:o.x,y:o.y}),e.redraw()}break;case 2:{let o=e.createVector(g[0].clientX,g[0].clientY-56),n=e.createVector(g[1].clientX,g[1].clientY-56),f=o.copy().add(n).div(2);C=o.dist(n)/j*oe,w=V.copy().add(f.sub(R).div(C)),e.redraw()}}return!1},e.touchEnded=t=>{if(t.changedTouches){switch(g=t.touches,X=!1,g.length){case 0:if(!P){let o=O(t.changedTouches[0].clientX,t.changedTouches[0].clientY-_),n={x:o.x,y:o.y};r.pos.push(n),r.pos.push(n),r&&le()}break;case 1:if(!X)return;me(),j=0,r=void 0}P=!1}};let me=()=>{R=e.createVector(g[0].clientX,g[0].clientY-56),V=w.copy()},le=()=>{if(b.length=k,b.push(r),K(a,r),a.redraw(),b.length>16){let t=b.shift();K(d,t),d.redraw()}k=b.length,R=void 0,P=!1,r=void 0,e.redraw()}})}change_color(){this.initialized&&this.p5voidDraw.change_color()}new_image(){if(!this.initialized)return;this.alertCtrl.create({header:this.lang.text.voidDraw.newDraw,inputs:[{name:"width",type:"number",placeholder:`${this.lang.text.voidDraw.width} (${this.lang.text.voidDraw.default_size}: 432)`},{name:"height",type:"number",placeholder:`${this.lang.text.voidDraw.height} (${this.lang.text.voidDraw.default_size}: 432)`}],buttons:[{text:this.lang.text.voidDraw.CreateNew,handler:l=>{l.width=l.width?Number(l.width):432,l.height=l.height?Number(l.height):432,this.create_new_canvas(l)}}]}).then(l=>l.present())}change_line_weight(){this.initialized&&this.p5voidDraw.set_line_weight()}act_history(i){this.p5voidDraw.history_act(i)}open_crop_tool(){this.initialized&&this.p5voidDraw.open_crop_tool()}dismiss_draw(){this.mainLoading.present(),this.WithoutSave=!1,this.p5voidDraw.save_image()}ionViewWillLeave(){delete this.global.p5key.KeyShortCut.HistoryAct,delete this.global.p5key.KeyShortCut.AddAct,delete this.global.p5key.KeyShortCut.DeleteAct,delete this.global.p5key.KeyShortCut.SKeyAct,this.p5voidDraw&&this.p5voidDraw.remove()}ionViewDidLeave(){document.removeEventListener("ionBackButton",this.EventListenerAct),this.indexed.removeFileFromUserPath("tmp_files/modify_image.png"),this.WithoutSave&&this.mainLoading.remove()}}return(I=Q).\u0275fac=function(i){return new(i||I)(h.Y36(ae.b),h.Y36(v.IN),h.Y36(v.Br),h.Y36(v.HT),h.Y36(re.AN),h.Y36(v.X1),h.Y36(se.H))},I.\u0275cmp=h.Xpm({type:I,selectors:[["app-void-draw"]],decls:8,vars:1,consts:[[1,"ion-no-border"],["slot","start",3,"click"],["defaultHref",""],["id","voidDraw",1,"full_screen",2,"display","flex","overflow","hidden"]],template:function(i,l){1&i&&(h.TgZ(0,"ion-header",0)(1,"ion-toolbar")(2,"ion-title"),h._uU(3),h.qZA(),h.TgZ(4,"ion-buttons",1),h.NdJ("click",function(){return l.modalCtrl.dismiss()}),h._UZ(5,"ion-back-button",2),h.qZA()()(),h.TgZ(6,"ion-content"),h._UZ(7,"div",3),h.qZA()),2&i&&(h.xp6(3),h.Oqu(l.lang.text.ChatRoom.voidDraw))},dependencies:[v.oU,v.Sm,v.W2,v.Gu,v.wd,v.sr,v.cs]}),Q})()}}]);