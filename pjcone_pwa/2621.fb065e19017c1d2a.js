"use strict";(self.webpackChunkapp=self.webpackChunkapp||[]).push([[2621],{2621:(ce,y,p)=>{p.r(y),p.d(y,{AddTodoMenuPageModule:()=>de});var x=p(9808),T=p(4182),c=p(3996),k=p(9705),g=p(655),b=p(6505),w=p(774),I=p(9912),v=p(5016),D=p(9805),e=p(9863),O=p(5742),M=p(3336),C=p(2313),Z=p(3496),P=p(8677),S=p(4606),U=p(1282),j=p(5129);const F=["StartCalendar"],J=["Calendar"],B=["NewAttach"],q=["StoreAt"],N=["ImporantSel"];function $(l,h){if(1&l&&(e.TgZ(0,"ion-select-option",41),e._uU(1),e.qZA()),2&l){const t=h.$implicit;e.Q6J("value",t),e.xp6(1),e.hij("",t.name," ")}}function W(l,h){if(1&l){const t=e.EpF();e.TgZ(0,"ion-item",36),e.NdJ("click",function(){return e.CHM(t),e.oxw().StoreAtSelClicked()}),e.TgZ(1,"ion-label"),e._uU(2),e.qZA(),e.TgZ(3,"ion-select",37,38),e.NdJ("ionChange",function(s){return e.CHM(t),e.oxw().StoreAtSelChanged(s)}),e.TgZ(5,"ion-select-option",39),e._uU(6),e.qZA(),e.YNc(7,$,2,2,"ion-select-option",40),e.qZA()()}if(2&l){const t=e.oxw();e.xp6(2),e.Oqu(t.lang.text.TodoDetail.StoreAt),e.xp6(4),e.Oqu(t.lang.text.TodoDetail.OnThisDevice),e.xp6(1),e.Q6J("ngForOf",t.AvailableStorageList)}}function L(l,h){if(1&l){const t=e.EpF();e.TgZ(0,"div")(1,"ion-item")(2,"ion-label",42),e._uU(3),e.qZA(),e.TgZ(4,"ion-label",43),e._uU(5),e.qZA()(),e.TgZ(6,"ion-grid",44)(7,"ion-row")(8,"ion-col",45)(9,"ion-item",46),e.NdJ("click",function(){return e.CHM(t),e.oxw().doneTodo()}),e.TgZ(10,"ion-label",47),e._uU(11),e.qZA()()()()()()}if(2&l){const t=e.oxw();e.xp6(3),e.Oqu(t.userInput.display_store||t.lang.text.TodoDetail.WIP),e.xp6(2),e.Oqu(t.userInput.display_creator),e.xp6(4),e.Q6J("disabled",!t.isModifiable||t.isButtonClicked),e.xp6(2),e.Oqu(t.lang.text.TodoDetail.TodoComplete)}}function Y(l,h){if(1&l){const t=e.EpF();e.TgZ(0,"ion-item")(1,"ion-label"),e._uU(2),e.qZA(),e.TgZ(3,"ion-checkbox",52),e.NdJ("ngModelChange",function(s){return e.CHM(t).$implicit.todo_checked=s}),e.qZA()()}if(2&l){const t=h.$implicit;e.xp6(2),e.Oqu(t.display_name),e.xp6(1),e.Q6J("ngModel",t.todo_checked)}}function Q(l,h){if(1&l){const t=e.EpF();e.TgZ(0,"ion-accordion",41)(1,"ion-item",49)(2,"ion-label"),e._uU(3),e.qZA()(),e.TgZ(4,"ion-list",50)(5,"ion-item",11),e.NdJ("click",function(){const n=e.CHM(t).$implicit;return e.oxw(2).toggle_all_user(n.id)}),e.TgZ(6,"ion-label"),e._uU(7),e.qZA()(),e.YNc(8,Y,4,2,"ion-item",24),e.qZA()()}if(2&l){const t=h.$implicit,i=e.oxw(2);e.Q6J("value",t.id),e.xp6(3),e.Oqu(t.name),e.xp6(4),e.Oqu(i.lang.text.TodoDetail.ToggleWorkers),e.xp6(1),e.Q6J("ngForOf",i.AvailableWorker[t.id])}}function G(l,h){if(1&l&&(e.TgZ(0,"div")(1,"ion-accordion-group",null,48)(3,"ion-accordion")(4,"ion-item",49)(5,"ion-label"),e._uU(6),e.qZA()(),e.TgZ(7,"ion-list",50)(8,"ion-accordion-group",null,51),e.YNc(10,Q,9,4,"ion-accordion",40),e.qZA()()()()()),2&l){const t=e.oxw();e.xp6(6),e.Oqu(t.lang.text.TodoDetail.ManageWorker),e.xp6(4),e.Q6J("ngForOf",t.WorkerGroups)}}function H(l,h){if(1&l&&(e.TgZ(0,"div",60),e._uU(1),e.qZA()),2&l){const t=e.oxw().$implicit;e.xp6(1),e.Oqu(t.displayTime)}}function R(l,h){1&l&&e._UZ(0,"ion-icon",61)}function E(l,h){1&l&&e._UZ(0,"ion-icon",62)}function z(l,h){1&l&&e._UZ(0,"ion-icon",63)}function V(l,h){if(1&l&&(e.TgZ(0,"ion-item",55)(1,"ion-label"),e._uU(2),e.qZA(),e.YNc(3,H,2,1,"div",56),e.YNc(4,R,1,0,"ion-icon",57),e.YNc(5,E,1,0,"ion-icon",58),e.YNc(6,z,1,0,"ion-icon",59),e.qZA()),2&l){const t=h.$implicit;e.xp6(2),e.Oqu(t.name),e.xp6(1),e.Q6J("ngIf",t.displayTime),e.xp6(1),e.Q6J("ngIf",void 0===t.isDelete),e.xp6(1),e.Q6J("ngIf",1==t.isDelete),e.xp6(1),e.Q6J("ngIf",0==t.isDelete)}}function K(l,h){if(1&l&&(e.TgZ(0,"div")(1,"ion-accordion-group",null,48)(3,"ion-accordion")(4,"ion-item",49)(5,"ion-label"),e._uU(6),e.qZA(),e.TgZ(7,"ion-label",53),e._uU(8),e.qZA()(),e.TgZ(9,"ion-list",50),e.YNc(10,V,7,5,"ion-item",54),e.qZA()()()()),2&l){const t=e.oxw();e.xp6(6),e.Oqu(t.lang.text.TodoDetail.ManageWorker),e.xp6(2),e.Oqu(t.worker_done+" / "+t.userInput.workers.length),e.xp6(2),e.Q6J("ngForOf",t.userInput.workers)}}function X(l,h){if(1&l){const t=e.EpF();e.TgZ(0,"ion-label",64),e.NdJ("click",function(){return e.CHM(t),e.oxw().toggle_custom_color()}),e._uU(1),e.qZA()}if(2&l){const t=e.oxw();e.xp6(1),e.Oqu(t.lang.text.TodoDetail.SetCustomColor)}}function ee(l,h){if(1&l){const t=e.EpF();e.TgZ(0,"div")(1,"button",65),e.NdJ("click",function(){return e.CHM(t),e.oxw().toggle_custom_color()}),e._uU(2),e.qZA(),e.TgZ(3,"input",66),e.NdJ("ngModelChange",function(s){return e.CHM(t),e.oxw().userInput.custom_color=s}),e.qZA()()}if(2&l){const t=e.oxw();e.xp6(2),e.hij(" ",t.lang.text.TodoDetail.remove," "),e.xp6(1),e.Q6J("ngModel",t.userInput.custom_color)}}function te(l,h){if(1&l&&e._UZ(0,"img",70),2&l){const t=e.oxw(2).$implicit;e.Q6J("src",t.thumbnail,e.LSH)("alt",t.filename)}}function ie(l,h){if(1&l&&(e.TgZ(0,"ion-item",17)(1,"ion-label",42),e._uU(2),e.qZA()()),2&l){const t=e.oxw(3);e.xp6(2),e.Oqu(t.lang.text.TodoDetail.open_content_viewer)}}function se(l,h){if(1&l){const t=e.EpF();e.TgZ(0,"div",36),e.NdJ("click",function(){e.CHM(t);const s=e.oxw().index;return e.oxw().open_content_viewer(s)}),e.YNc(1,te,1,2,"img",68),e.YNc(2,ie,3,1,"ion-item",69),e.qZA()}if(2&l){const t=e.oxw().$implicit;e.xp6(1),e.Q6J("ngIf",t.thumbnail),e.xp6(1),e.Q6J("ngIf",!t.thumbnail)}}function ae(l,h){if(1&l){const t=e.EpF();e.TgZ(0,"div")(1,"ion-item")(2,"ion-label",67),e._uU(3),e.qZA(),e.TgZ(4,"ion-button",36),e.NdJ("click",function(){const n=e.CHM(t).index;return e.oxw().remove_attach(n)}),e._uU(5),e.qZA()(),e.YNc(6,se,3,2,"div",8),e.qZA()}if(2&l){const t=h.$implicit,i=e.oxw();e.xp6(3),e.Oqu(t.filename),e.xp6(2),e.hij(" ",i.lang.text.TodoDetail.delete_attach," "),e.xp6(1),e.Q6J("ngIf",t.viewer)}}function ne(l,h){if(1&l&&(e.TgZ(0,"ion-select-option",71),e._uU(1),e.qZA()),2&l){const t=e.oxw();e.xp6(1),e.Oqu(t.lang.text.GlobalAct.FromCamera)}}function oe(l,h){if(1&l){const t=e.EpF();e.TgZ(0,"td")(1,"ion-button",72),e.NdJ("click",function(){return e.CHM(t),e.oxw().deleteData()}),e._uU(2),e.qZA()()}if(2&l){const t=e.oxw();e.xp6(1),e.Q6J("disabled",!t.isModifiable||t.isButtonClicked),e.xp6(1),e.hij(" ",t.lang.text.TodoDetail.remove," ")}}const re=[{path:"",component:(()=>{class l{constructor(t,i,s,n,a,o,r,u,d,m,_,f,A,ue,he){this.route=t,this.router=i,this.modalCtrl=s,this.lang=n,this.p5toast=a,this.sanitizer=o,this.indexed=r,this.nakama=u,this.alertCtrl=d,this.noti=m,this.statusBar=_,this.loadingCtrl=f,this.global=A,this.camera=ue,this.navCtrl=he,this.userInput={id:void 0,storeAt:"local",display_store:"",title:void 0,create_at:void 0,written:void 0,startFrom:void 0,limit:void 0,custom_color:void 0,workers:void 0,importance:"0",description:void 0,remote:void 0,display_creator:void 0,attach:[],done:void 0,is_focus:void 0,noti_id:void 0},this.buttonDisplay={saveTodo:this.lang.text.TodoDetail.buttonDisplay_add},this.AmICreator=!0,this.isModify=!1,this.isModifiable=!1,this.isStartCalendarHidden=!0,this.isCalendarHidden=!0,this.isLimitChangable=!1,this.normal_color="#888b",this.alert_color="#0bbb",this.AlertLerpStartFrom=.8,this.file_sel_id="",this.AvailableStorageList=[],this.isManager=!1,this.AvailableWorker={},this.WorkerGroups=[],this.toggle_logs={},this.worker_done=0,this.isButtonClicked=!1}ngOnInit(){if(this.can_cordova="Android"==v.n$||"iOS"==v.n$,this.nakama.removeBanner(),this.route.queryParams.subscribe(t=>{const i=this.router.getCurrentNavigation().extras.state;i&&(this.received_data=i.data),this.received_data&&(this.userInput=Object.assign(Object.assign({},this.userInput),JSON.parse(this.received_data)))}),this.nakama.AddTodoLinkAct=t=>(0,g.mG)(this,void 0,void 0,function*(){this.nakama.removeBanner(),this.p5timer.remove(),this.received_data=t,this.userInput=JSON.parse(this.received_data),yield this.ionViewWillEnter(),this.show_count_timer()}),this.nakama.AddTodoManageUpdateAct=(t,i,s,n)=>{if(this.userInput.id==t)for(let a=0,o=this.userInput.workers.length;a<o;a++)if((this.userInput.workers[a].user_id||this.userInput.workers[a].id)==i){this.userInput.workers[a].isDelete=s,this.userInput.workers[a].timestamp=n,this.userInput.workers[a].displayTime=new Date(n).toLocaleString(),this.worker_done++;break}},"DesktopPWA"==v.n$&&setTimeout(()=>{this.CreateDrop()},0),this.userInput.workers)for(let t=0,i=this.userInput.workers.length;t<i;t++)this.userInput.workers[t].timestamp&&(this.userInput.workers[t].displayTime=new Date(this.userInput.workers[t].timestamp).toLocaleString(),this.worker_done++)}CreateDrop(){let t=document.getElementById("p5Drop_todo");this.p5canvas=new b(i=>{i.setup=()=>{let s=i.createCanvas(t.clientWidth,t.clientHeight);s.parent(t),i.pixelDensity(1),s.drop(n=>(0,g.mG)(this,void 0,void 0,function*(){yield this.selected_blobFile_callback_act(n.file)}))},i.mouseMoved=s=>{s.dataTransfer?(t.style.pointerEvents="all",t.style.backgroundColor="#0008"):(t.style.pointerEvents="none",t.style.backgroundColor="transparent")}})}selected_blobFile_callback_act(t){return(0,g.mG)(this,void 0,void 0,function*(){let i=yield this.loadingCtrl.create({message:this.lang.text.TodoDetail.WIP});i.present();let s={};s.filename=t.name,s.file_ext=t.name.substring(t.name.lastIndexOf(".")+1),s.size=t.size,s.type=t.type,s.path=`tmp_files/todo/${s.filename}`,s.blob=t,s.content_related_creator=[{timestamp:(new Date).getTime(),display_name:this.nakama.users.self.display_name,various:"loaded"}],s.content_creator={timestamp:(new Date).getTime(),display_name:this.nakama.users.self.display_name,various:"loaded"};let n=!1;n=yield this.indexed.checkIfFileExist(s.path,void 0,this.indexed.godotDB),this.userInput.id&&!n&&(n=yield this.indexed.checkIfFileExist(`todo/${this.userInput.id}/${s.filename}`,void 0,this.indexed.godotDB)),n&&(s.filename=`${s.filename.substring(0,s.filename.lastIndexOf("."))}_.${s.file_ext}`),this.global.set_viewer_category(s);let a=URL.createObjectURL(t);"image"==s.viewer&&(s.thumbnail=this.sanitizer.bypassSecurityTrustUrl(a));try{yield this.indexed.saveBlobToUserPath(t,s.path,void 0,this.indexed.godotDB),this.userInput.attach.push(s),setTimeout(()=>{URL.revokeObjectURL(a)},0),i.dismiss()}catch(o){console.error("\ud30c\uc77c \uc62c\ub9ac\uae30 \uc2e4\ud328: ",o),this.p5toast.show({text:this.lang.text.TodoDetail.load_failed}),i.dismiss()}})}ionViewWillEnter(){return(0,g.mG)(this,void 0,void 0,function*(){let n,t=[];if(Object.keys(this.nakama.servers).forEach(o=>{Object.keys(this.nakama.servers[o]).forEach(u=>{"online"==this.statusBar.groupServer[o][u]&&t.push({name:`${this.nakama.servers[o][u].info.name}`,isOfficial:o,target:u,type:`${o}/${u}`})})}),[...t].forEach(o=>{this.AvailableStorageList.push(o)}),this.received_data)this.buttonDisplay.saveTodo=this.lang.text.TodoDetail.buttonDisplay_modify,n=JSON.parse(this.received_data),this.userInput=Object.assign(Object.assign({},this.userInput),n),this.isModify=!0;else{let o=new Date((new Date).getTime()+864e5);this.userInput.limit=o.getTime()}if(this.file_sel_id=`todo_${this.userInput.id||"new_todo_id"}_${(new Date).getTime()}`,this.userInput.attach.length)for(let o=0,r=this.userInput.attach.length;o<r;o++){try{let u;if(this.userInput.remote){let m=yield this.loadingCtrl.create({message:this.lang.text.TodoDetail.WIP});m.present(),u=yield this.nakama.sync_load_file(this.userInput.attach[o],this.userInput.remote.isOfficial,this.userInput.remote.target,"todo_attach",this.userInput.remote.creator_id,void 0,this.indexed.godotDB),m.dismiss()}else{if("image"!=this.userInput.attach[o].viewer&&"text"!=this.userInput.attach[o].viewer)throw"\ubc88\uc678 \uc378\ub124\uc77c \ud544\uc694";u=yield this.indexed.loadBlobFromUserPath(this.userInput.attach[o].path,this.userInput.attach[o].type,void 0,this.indexed.godotDB)}if(!u)continue;let d=URL.createObjectURL(u);this.global.modulate_thumbnail(this.userInput.attach[o],d,this.indexed.godotDB)}catch(u){this.global.modulate_thumbnail(this.userInput.attach[o],"",this.indexed.godotDB)}this.userInput.attach[o].exist=!0}try{if("local"==this.userInput.storeAt)this.isModify||(this.StoreAt.value=this.userInput.storeAt),this.userInput.display_store=this.lang.text.TodoDetail.OnThisDevice,this.userInput.display_creator=this.lang.text.TodoDetail.WrittenByMe,this.isModifiable=!0;else if(this.userInput.remote){if(this.isModify||(this.StoreAt.value=this.userInput.remote),this.userInput.display_store=this.userInput.remote.name,this.userInput.display_creator=this.lang.text.TodoDetail.Disconnected,!this.nakama.servers[this.userInput.remote.isOfficial]||!this.nakama.servers[this.userInput.remote.isOfficial][this.userInput.remote.target])throw this.userInput.display_creator=this.lang.text.TodoDetail.DeletedServer,{text:"Server Deleted",isModifiable:!0};if(this.statusBar.groupServer[this.userInput.remote.isOfficial]&&"online"!=this.statusBar.groupServer[this.userInput.remote.isOfficial][this.userInput.remote.target])throw{text:"Server disconnected",isModifiable:!1};"online"==this.statusBar.groupServer[this.userInput.remote.isOfficial][this.userInput.remote.target]&&(this.isModifiable=!0),this.AmICreator=this.nakama.servers[this.userInput.remote.isOfficial][this.userInput.remote.target].session.user_id==this.userInput.remote.creator_id,this.userInput.display_creator=this.AmICreator?this.lang.text.TodoDetail.WrittenByMe:this.nakama.load_other_user(this.userInput.remote.creator_id,this.userInput.remote.isOfficial,this.userInput.remote.target).display_name,this.userInput.remote.group_id&&(this.isModifiable="online"==this.nakama.groups[this.userInput.remote.isOfficial][this.userInput.remote.target][this.userInput.remote.group_id].status)}}catch(o){this.isModifiable=o.isModifiable,console.log("Server issue: ",o)}this.noti.Current=this.userInput.id;let a=new Date(this.userInput.limit);if(this.Calendar.value=new Date(a.getTime()-60*a.getTimezoneOffset()*1e3).toISOString(),n&&(this.limitTimeP5Display=new Date(n.limit).getTime()),this.userInput.startFrom){let o=new Date(this.userInput.startFrom);this.startDisplay=o.toLocaleString(this.lang.lang),this.startDisplay=this.startDisplay.substring(0,this.startDisplay.lastIndexOf(":"))}if(this.limitDisplay=a.toLocaleString(this.lang.lang),this.limitDisplay=this.limitDisplay.substring(0,this.limitDisplay.lastIndexOf(":")),this.isLimitChangable=!0,this.userInput.workers)for(let o=0,r=this.userInput.workers.length;o<r;o++)try{this.userInput.workers[o].name=this.nakama.load_other_user(this.userInput.workers[o].id,this.userInput.remote.isOfficial,this.userInput.remote.target).display_name}catch(u){}})}ionViewDidEnter(){this.show_count_timer()}toggle_start_calendar(){this.isStartCalendarHidden=!this.isStartCalendarHidden,this.isCalendarHidden=!0}toggle_calendar(){this.isCalendarHidden=!this.isCalendarHidden,this.isStartCalendarHidden=!0}start_change(t){!this.isLimitChangable||(this.userInput.startFrom=t.detail.value,this.startDisplay=new Date(t.detail.value).toLocaleString(this.lang.lang),this.startDisplay=this.startDisplay.substring(0,this.startDisplay.lastIndexOf(":")),this.startTimeP5Display=new Date(this.userInput.startFrom).getTime())}limit_change(t){!this.isLimitChangable||(this.userInput.limit=t.detail.value,this.limitDisplay=new Date(t.detail.value).toLocaleString(this.lang.lang),this.limitDisplay=this.limitDisplay.substring(0,this.limitDisplay.lastIndexOf(":")),this.limitTimeP5Display=new Date(this.userInput.limit).getTime())}remove_attach(t){this.userInput.attach.splice(t,1)}show_count_timer(){this.p5timer=new b(t=>{let i=0;this.startTimeP5Display=new Date(this.userInput.startFrom||this.userInput.written).getTime();let s,n=t.color(this.normal_color);t.setup=()=>{let d=document.getElementById("p5timer"),m=t.createCanvas(d.clientWidth,d.clientHeight);m.id("timer"),m.style("position","inherit"),m.style("width","100%"),m.style("height","100%"),m.parent(d),t.noStroke()};let a=0,o=()=>{s=(new Date).getTime(),a=this.limitTimeP5Display<s?1:t.map(s,this.startTimeP5Display,this.limitTimeP5Display,0,1,!0),a<=this.AlertLerpStartFrom?n=t.color(this.userInput.custom_color||this.normal_color):a>this.AlertLerpStartFrom&&(n=this.userInput.custom_color?t.color(this.userInput.custom_color):t.lerpColor(t.color(this.normal_color),t.color(this.alert_color),t.map(a,this.AlertLerpStartFrom,1,0,1)*i))};t.draw=()=>{o(),t.clear(255,255,255,255),t.push(),t.fill(n),i<1?(i+=.04,i>=1&&(i=1),t.rect(0,0,t.lerp(0,t.width,a*r(i)),t.height)):t.rect(0,0,t.lerp(0,t.width,a),t.height),t.pop()};let r=d=>u(t.sq(u(d))),u=d=>1-d})}from_camera(){this.camera.getPicture({destinationType:0,correctOrientation:!0}).then(t=>(0,g.mG)(this,void 0,void 0,function*(){let i=yield this.loadingCtrl.create({message:this.lang.text.TodoDetail.WIP});i.present();let s={},n=new Date;s.filename=`Camera_${n.toLocaleString().replace(/[:|.|\/]/g,"_")}.jpeg`,s.file_ext="jpeg",s.base64="data:image/jpeg;base64,"+t,s.thumbnail=this.sanitizer.bypassSecurityTrustUrl(s.base64),s.type="image/jpeg",s.typeheader="image",s.content_related_creator=[{timestamp:(new Date).getTime(),display_name:this.nakama.users.self.display_name,various:"camera"}],s.content_creator={timestamp:(new Date).getTime(),display_name:this.nakama.users.self.display_name,various:"camera"},s.path=`tmp_files/todo/${s.filename}`,s.viewer="image";let a=yield this.indexed.saveBase64ToUserPath(s.base64,s.path,void 0,this.indexed.godotDB);s.blob=new Blob([a],{type:s.type}),s.size=s.blob.size,i.dismiss(),this.userInput.attach.push(s)}))}open_select_new(){this.NewAttach.open()}new_attach(t){switch(t.detail.value){case"camera":this.from_camera();break;case"text":let i=new Date,d=`texteditor_${i.getUTCFullYear()}-${("0"+(i.getMonth()+1)).slice(-2)}-${("0"+i.getDate()).slice(-2)}_${("0"+i.getHours()).slice(-2)}-${("0"+i.getMinutes()).slice(-2)}-${("0"+i.getSeconds()).slice(-2)}.txt`;this.modalCtrl.create({component:w.B,componentProps:{info:{content:{is_new:"text",type:"text/plain",viewer:"text",filename:d},targetDB:this.indexed.godotDB},no_edit:!0}}).then(m=>{m.onWillDismiss().then(_=>{if(_.data){let f={};f.content_creator={timestamp:(new Date).getTime(),display_name:this.nakama.users.self.display_name,various:"textedit"},f.content_related_creator=[],f.content_related_creator.push(f.content_creator),f.blob=_.data.blob,f.path=_.data.path,f.size=_.data.blob.size,f.filename=d,f.viewer="text",this.userInput.attach.push(f)}}),m.present()});break;case"image":this.modalCtrl.create({component:D.$}).then(m=>{m.onWillDismiss().then(_=>(0,g.mG)(this,void 0,void 0,function*(){_.data&&this.voidDraw_fileAct_callback(_)})),m.present()})}this.NewAttach.value=""}select_attach(){document.getElementById(this.file_sel_id).click()}inputImageSelected(t){return(0,g.mG)(this,void 0,void 0,function*(){if(t.target.files.length)for(let i=0,s=t.target.files.length;i<s;i++)yield this.selected_blobFile_callback_act(t.target.files[i])})}StoreAtSelClicked(){this.StoreAt.open()}StoreAtSelChanged(t){let i=t.detail.value;"local"==i?(this.userInput.storeAt="local",this.userInput.remote=void 0,this.isManager=!1,this.userInput.workers=void 0):(this.userInput.storeAt=i.type,this.userInput.remote=i,this.userInput.workers=[],this.nakama.servers[i.isOfficial][i.target].client.getAccount(this.nakama.servers[i.isOfficial][i.target].session).then(s=>(0,g.mG)(this,void 0,void 0,function*(){let n=JSON.parse(s.user.metadata);if(this.WorkerGroups.length=0,this.AvailableWorker={},n.is_admin){let a=(yield this.nakama.servers[i.isOfficial][i.target].client.rpc(this.nakama.servers[i.isOfficial][i.target].session,"query_all_groups",{})).payload;for(let o=0,r=a.length;o<r;o++){this.AvailableWorker[a[o].id]||(this.AvailableWorker[a[o].id]=[]);for(let u=0,d=a[o].users.length;u<d;u++){let m=this.nakama.load_other_user(a[o].users[u].user.user_id,i.isOfficial,i.target);delete m.todo_checked,m.email||this.AvailableWorker[a[o].id].push(m)}this.AvailableWorker[a[o].id].length?this.WorkerGroups.push({id:a[o].id,name:a[o].name}):delete this.AvailableWorker[a[o].id]}this.isManager=!0}else if(n.is_manager){for(let a=n.is_manager.length-1;a>=0;a--)try{let o=this.nakama.groups[i.isOfficial][i.target][n.is_manager[a]];this.AvailableWorker[o.id]||(this.AvailableWorker[o.id]=[]);for(let r=0,u=o.users.length;r<u;r++){let d=this.nakama.load_other_user(o.users[r].user.user_id||o.users[r].user.id,i.isOfficial,i.target);delete d.todo_checked,(d.id||d.user_id)!=this.nakama.servers[i.isOfficial][i.target].session.user_id&&this.AvailableWorker[o.id].push(d)}this.AvailableWorker[o.id].length?this.WorkerGroups.push({id:o.id,name:o.name}):delete this.AvailableWorker[o.id]}catch(o){n.is_manager.splice(a,1)}this.isManager=n.is_manager.length,this.isManager||delete n.is_manager;try{this.nakama.servers[i.isOfficial][i.target].client.rpc(this.nakama.servers[i.isOfficial][i.target].session,"update_user_metadata_fn",{user_id:this.nakama.servers[i.isOfficial][i.target].session.user_id,metadata:n})}catch(a){}}})))}toggle_all_user(t){this.toggle_logs[t]=!this.toggle_logs[t];for(let i=0,s=this.AvailableWorker[t].length;i<s;i++)this.AvailableWorker[t][i].todo_checked=this.toggle_logs[t]}ImporantSelClicked(){this.ImporantSel.open()}ImporantSelChanged(t){switch(this.userInput.importance=t.detail.value,this.userInput.importance){case"0":this.normal_color="#888b",this.alert_color="#0bbb",this.AlertLerpStartFrom=.8;break;case"1":this.normal_color="#888b",this.alert_color="#dddd0cbb",this.AlertLerpStartFrom=.5;break;case"2":this.normal_color="#dddd0cbb",this.alert_color="#800b",this.AlertLerpStartFrom=.4}}toggle_custom_color(){this.userInput.custom_color=this.userInput.custom_color?void 0:"#000000"}open_content_viewer(t){let i=[];for(let s=0,n=this.userInput.attach.length;s<n;s++)i.push({content:this.userInput.attach[s]});this.modalCtrl.create({component:w.B,componentProps:{info:{content:this.userInput.attach[t]},path:this.userInput.attach[t].path,relevance:i,targetDB:this.indexed.godotDB}}).then(s=>{s.onDidDismiss().then(n=>{if(n.data)switch(n.data.type){case"image":let a=[];if(this.userInput.attach[n.data.index].content_related_creator&&(a=[...this.userInput.attach[n.data.index].content_related_creator]),this.userInput.attach[n.data.index].content_creator){let o=!1;for(let r=0,u=a.length;r<u;r++)if(void 0!==a[r].user_id&&void 0!==this.userInput.attach[n.data.index].content_creator.user_id&&a[r].user_id==this.userInput.attach[n.data.index].content_creator.user_id){o=!0;break}o||a.push(this.userInput.attach[n.data.index].content_creator)}return delete this.userInput.attach[n.data.index].exist,void this.modalCtrl.create({component:D.$,componentProps:{path:n.data.path||this.userInput.attach[n.data.index].path,width:n.data.width,height:n.data.height}}).then(o=>{o.onWillDismiss().then(r=>{r.data&&("image"===n.data.msg.content.viewer?this.voidDraw_fileAct_callback(r,a,n.data.index,!0):this.voidDraw_fileAct_callback(r,a,n.data.index))}),o.present()});case"text":this.userInput.attach[t].content_related_creator.push(this.userInput.attach[t].content_creator),this.userInput.attach[t].content_creator={timestamp:(new Date).getTime(),display_name:this.nakama.users.self.display_name,various:"textedit"},this.userInput.attach[t].blob=n.data.blob,this.userInput.attach[t].path=n.data.path,this.userInput.attach[t].size=n.data.blob.size,this.userInput.attach[t].filename=`[${this.lang.text.TodoDetail.EditText}] ${this.userInput.attach[t].filename}`,delete this.userInput.attach[t].exist}}),this.noti.Current="IonicViewerPage",s.present()})}voidDraw_fileAct_callback(t,i,s,n=!1){let a;try{if(!n)throw"not overwrite";a={},this.userInput.attach[s]=a}catch(o){a={},this.userInput.attach.splice(s+1,0,a)}a.filename=t.data.name,a.file_ext="png",a.type="image/png",a.viewer="image",i?(a.content_related_creator=i,a.content_creator={timestamp:(new Date).getTime(),display_name:this.nakama.users.self.display_name,various:"voidDraw"}):(a.content_related_creator=[{timestamp:(new Date).getTime(),display_name:this.nakama.users.self.display_name,various:"voidDraw"}],a.content_creator={timestamp:(new Date).getTime(),display_name:this.nakama.users.self.display_name,various:"voidDraw"}),a.thumbnail=this.sanitizer.bypassSecurityTrustUrl(t.data.img),a.path=`tmp_files/todo/${a.filename}`,this.indexed.saveBase64ToUserPath(t.data.img,"tmp_files/todo/attach.jpeg",o=>{a.blob=new Blob([o],{type:a.type}),a.size=a.blob.size},this.indexed.godotDB),this.indexed.saveBase64ToUserPath(t.data.img,a.path,o=>{t.data.loadingCtrl.dismiss()},this.indexed.godotDB)}doneTodo(){return(0,g.mG)(this,void 0,void 0,function*(){if(this.isButtonClicked=!0,this.userInput.done=!0,this.global.godot_window.add_todo&&this.global.godot_window.add_todo(JSON.stringify(this.userInput)),this.userInput.remote){let t=yield this.loadingCtrl.create({message:this.lang.text.TodoDetail.WIP});t.present(),this.nakama.servers[this.userInput.remote.isOfficial][this.userInput.remote.target]&&(yield this.nakama.servers[this.userInput.remote.isOfficial][this.userInput.remote.target].socket.sendMatchState(this.nakama.self_match[this.userInput.remote.isOfficial][this.userInput.remote.target].match_id,I.B.ADD_TODO,encodeURIComponent(`done,${this.userInput.id}`))),t.dismiss()}this.deleteFromStorage(!1)})}saveData(){return(0,g.mG)(this,void 0,void 0,function*(){if(!this.userInput.title)return void this.p5toast.show({text:this.lang.text.TodoDetail.needDisplayName});this.isButtonClicked=!0;let t=Boolean(this.userInput.attach.length);if(delete this.userInput.display_store,delete this.userInput.display_creator,JSON.stringify(this.userInput)==this.received_data)return void this.navCtrl.back();this.userInput.create_at||(this.userInput.create_at=(new Date).getTime()),(!this.userInput.id||!this.isModify)&&(this.userInput.id=this.userInput.remote?`${this.userInput.remote.isOfficial}_${this.userInput.remote.target}_${new Date(this.userInput.create_at).toISOString().replace(/[:|.|\/]/g,"_")}`:new Date(this.userInput.create_at).toISOString().replace(/[:|.|\/]/g,"_")),this.userInput.noti_id&&(("DesktopPWA"==v.n$||"MobilePWA"==v.n$)&&(clearTimeout(this.nakama.web_noti_id[this.userInput.noti_id]),delete this.nakama.web_noti_id[this.userInput.noti_id]),this.noti.ClearNoti(this.userInput.noti_id)),this.userInput.noti_id=this.nakama.get_noti_id(),this.nakama.set_todo_notification(this.userInput);let s=this.received_data?JSON.parse(this.received_data):void 0,n=!1;if(this.userInput.workers){this.userInput.workers.length=0;let a=Object.keys(this.AvailableWorker),o=[];for(let r=0,u=a.length;r<u;r++)for(let d=0,m=this.AvailableWorker[a[r]].length;d<m;d++){let _=this.AvailableWorker[a[r]][d].id||this.AvailableWorker[a[r]][d].user_id;this.AvailableWorker[a[r]][d].todo_checked&&!o.includes(_)&&(this.userInput.workers.push({id:_,name:this.nakama.load_other_user(_,this.userInput.remote.isOfficial,this.userInput.remote.target).display_name}),o.push(_))}this.userInput.workers.length||(this.userInput.workers=void 0)}try{s.attach.forEach(r=>{delete r.exist,delete r.thumbnail,delete r.base64,delete r.blob});let a=JSON.stringify(s.attach),o=JSON.parse(JSON.stringify(this.userInput.attach));o.forEach(r=>{delete r.exist,delete r.thumbnail,delete r.base64,delete r.blob}),o=JSON.stringify(o),n=a!=o}catch(a){n=!0}if(t&&n){let o,a=yield this.loadingCtrl.create({message:this.lang.text.TodoDetail.WIP});if(a.present(),s){yield this.indexed.removeFileFromUserPath(`todo/${this.userInput.id}/thumbnail.png`,void 0,this.indexed.godotDB);for(let r=0,u=s.attach.length;r<u;r++){for(let d=0,m=this.userInput.attach.length;d<m;d++)if(this.userInput.attach[d].path==s.attach[r].path){s.attach[r].exist=!0,s.attach[r].index=d;break}(!s.attach[r].exist||s.attach[r].exist&&!this.userInput.attach[s.attach[r].index])&&(yield this.indexed.removeFileFromUserPath(s.attach[r].path,void 0,this.indexed.godotDB))}}for(let r=0,u=this.userInput.attach.length;r<u;r++){let d;!this.userInput.attach[r].exist||!o&&"image"==this.userInput.attach[r].viewer?(d=yield this.indexed.loadBlobFromUserPath(this.userInput.attach[r].path,this.userInput.attach[r].type,void 0,this.indexed.godotDB),this.userInput.attach[r].path=`todo/${this.userInput.id}/${this.userInput.attach[r].filename}`,yield this.indexed.saveBlobToUserPath(d,this.userInput.attach[r].path,void 0,this.indexed.godotDB)):delete this.userInput.attach[r].exist,!o&&"image"==this.userInput.attach[r].viewer&&(o=URL.createObjectURL(d))}o&&(yield new Promise(r=>{new b(u=>{u.setup=()=>{u.noCanvas(),u.loadImage(o,d=>{d.width>d.height?d.resize(d.width/d.height*128,128):d.resize(128,d.height/d.width*128),u.createCanvas(128,128).hide(),u.smooth(),u.image(d,-(d.width-128)/2,-(d.height-128)/2),u.saveFrames("","png",1,1,f=>{this.indexed.saveBase64ToUserPath(f[0].imageData.replace(/"|=|\\/g,""),`todo/${this.userInput.id}/thumbnail.png`,A=>{r()},this.indexed.godotDB),URL.revokeObjectURL(o),u.remove()})},d=>{console.error("Todo-\ub4f1\ub85d\ub41c \uc774\ubbf8\uc9c0 \ubd88\ub7ec\uc624\uae30 \uc2e4\ud328: ",d),r(),URL.revokeObjectURL(o),u.remove()})}})}),this.global.last_frame_name=""),a.dismiss()}if(!t&&n&&s){yield this.indexed.removeFileFromUserPath(`todo/${this.userInput.id}/thumbnail.png`,void 0,this.indexed.godotDB);for(let a=0,o=s.attach.length;a<o;a++)yield this.indexed.removeFileFromUserPath(s.attach[a].path,void 0,this.indexed.godotDB);this.global.last_frame_name=""}if(this.userInput.attach.forEach(a=>{URL.revokeObjectURL(a.thumbnail),delete a.thumbnail,delete a.exist,delete a.base64}),this.userInput.written=(new Date).getTime(),this.userInput.startFrom){let a=new Date(this.userInput.startFrom).getTime();(new Date).getTime()>a?delete this.userInput.startFrom:this.userInput.startFrom=a}if(this.userInput.limit=new Date(this.userInput.limit).getTime(),this.isModify||this.userInput.remote&&!this.userInput.remote.creator_id&&(this.userInput.remote.creator_id=this.nakama.servers[this.userInput.remote.isOfficial][this.userInput.remote.target].session.user_id),this.userInput.remote){let a=yield this.loadingCtrl.create({message:this.lang.text.TodoDetail.WIP});a.present();let o={collection:"server_todo",key:this.userInput.id,permission_read:2,permission_write:1,value:this.userInput};try{if(this.userInput.attach.forEach(r=>{URL.revokeObjectURL(r.thumbnail),delete r.thumbnail,delete r.exist,delete r.base64}),this.userInput.workers){yield this.nakama.servers[this.userInput.remote.isOfficial][this.userInput.remote.target].client.rpc(this.nakama.servers[this.userInput.remote.isOfficial][this.userInput.remote.target].session,"manage_todo_add_fn",this.userInput);for(let r=0,u=this.userInput.workers.length;r<u;r++)try{let d=yield this.nakama.servers[this.userInput.remote.isOfficial][this.userInput.remote.target].client.readStorageObjects(this.nakama.servers[this.userInput.remote.isOfficial][this.userInput.remote.target].session,{object_ids:[{collection:"self_share",key:"private_match",user_id:this.userInput.workers[r].id}]});d.objects.length&&(yield this.nakama.servers[this.userInput.remote.isOfficial][this.userInput.remote.target].socket.joinMatch(d.objects[0].value.match_id),yield this.nakama.servers[this.userInput.remote.isOfficial][this.userInput.remote.target].socket.sendMatchState(d.objects[0].value.match_id,I.B.ADD_TODO,encodeURIComponent(`add,server_todo,${this.userInput.id}`)),yield this.nakama.servers[this.userInput.remote.isOfficial][this.userInput.remote.target].socket.leaveMatch(d.objects[0].value.match_id))}catch(d){}}else yield this.nakama.servers[this.userInput.remote.isOfficial][this.userInput.remote.target].client.writeStorageObjects(this.nakama.servers[this.userInput.remote.isOfficial][this.userInput.remote.target].session,[o]).then(r=>(0,g.mG)(this,void 0,void 0,function*(){yield this.nakama.servers[this.userInput.remote.isOfficial][this.userInput.remote.target].socket.sendMatchState(this.nakama.self_match[this.userInput.remote.isOfficial][this.userInput.remote.target].match_id,I.B.ADD_TODO,encodeURIComponent(`add,${r.acks[0].collection},${r.acks[0].key}`))}));if(t&&n&&s)for(let r=0,u=s.attach.length;r<u;r++){for(let d=0,m=this.userInput.attach.length;d<m;d++)if(this.userInput.attach[d].path==s.attach[r].path){s.attach[r].exist=!0,s.attach[r].index=d;break}(!s.attach[r].exist||s.attach[r].exist&&!this.userInput.attach[s.attach[r].index])&&(yield this.nakama.sync_remove_file(s.attach[r].path,this.userInput.remote.isOfficial,this.userInput.remote.target,"todo_attach",void 0,this.indexed.godotDB))}for(let r=0,u=this.userInput.attach.length;r<u;r++)yield this.nakama.sync_save_file(this.userInput.attach[r],this.userInput.remote.isOfficial,this.userInput.remote.target,"todo_attach",void 0,this.indexed.godotDB);a.dismiss()}catch(r){return console.error("\ud574\uc57c\ud560 \uc77c\uc774 \uc11c\ubc84\uc5d0 \uc804\uc1a1\ub418\uc9c0 \uc54a\uc74c: ",r),this.p5toast.show({text:this.lang.text.TodoDetail.CanAddToServer}),this.isButtonClicked=!1,void a.dismiss()}}this.global.godot_window.add_todo&&this.global.godot_window.add_todo(JSON.stringify(this.userInput)),yield this.indexed.saveTextFileToUserPath(JSON.stringify(this.userInput),`todo/${this.userInput.id}/info.todo`,void 0,this.indexed.godotDB),this.navCtrl.back()})}deleteData(){this.alertCtrl.create({header:this.lang.text.TodoDetail.remove,message:this.lang.text.TodoDetail.terminateTodo,buttons:[{text:this.lang.text.TodoDetail.remove,handler:()=>{this.deleteFromStorage()}}]}).then(t=>t.present())}deleteFromStorage(t=!0){return(0,g.mG)(this,void 0,void 0,function*(){this.isButtonClicked=!0;let i=yield this.loadingCtrl.create({message:this.lang.text.TodoDetail.WIP});if(i.present(),this.userInput.remote){let s={collection:"server_todo",key:this.userInput.id};try{if(!this.nakama.servers[this.userInput.remote.isOfficial][this.userInput.remote.target])throw"Server deleted.";let n=this.userInput.remote.isOfficial,a=this.userInput.remote.target;yield this.nakama.servers[n][a].client.deleteStorageObjects(this.nakama.servers[n][a].session,{object_ids:[s]});for(let o=0,r=this.userInput.attach.length;o<r;o++)yield this.nakama.sync_remove_file(this.userInput.attach[o].path,n,a,"todo_attach",void 0,this.indexed.godotDB);t&&(yield this.nakama.servers[n][a].socket.sendMatchState(this.nakama.self_match[n][a].match_id,I.B.ADD_TODO,encodeURIComponent(`delete,${this.userInput.id}`)))}catch(n){console.error("\ud574\uc57c\ud560 \uc77c \uc0ad\uc81c \uc694\uccad\uc774 \uc11c\ubc84\uc5d0 \uc804\uc1a1\ub418\uc9c0 \uc54a\uc74c: ",n)}try{if(this.userInput.remote.creator_id!=this.nakama.servers[this.userInput.remote.isOfficial][this.userInput.remote.target].session.user_id){let n=(new Date).getTime();try{yield this.nakama.servers[this.userInput.remote.isOfficial][this.userInput.remote.target].client.rpc(this.nakama.servers[this.userInput.remote.isOfficial][this.userInput.remote.target].session,"manage_todo_done_fn",{id:this.userInput.id,creator_id:this.userInput.remote.creator_id,user_id:this.nakama.servers[this.userInput.remote.isOfficial][this.userInput.remote.target].session.user_id,timestamp:n,isDelete:t})}catch(a){}try{let a=yield this.nakama.servers[this.userInput.remote.isOfficial][this.userInput.remote.target].client.readStorageObjects(this.nakama.servers[this.userInput.remote.isOfficial][this.userInput.remote.target].session,{object_ids:[{collection:"self_share",key:"private_match",user_id:this.userInput.remote.creator_id}]});a.objects.length&&(yield this.nakama.servers[this.userInput.remote.isOfficial][this.userInput.remote.target].socket.joinMatch(a.objects[0].value.match_id),yield this.nakama.servers[this.userInput.remote.isOfficial][this.userInput.remote.target].socket.sendMatchState(a.objects[0].value.match_id,I.B.ADD_TODO,encodeURIComponent(`worker,${this.userInput.id},${this.nakama.servers[this.userInput.remote.isOfficial][this.userInput.remote.target].session.user_id},${t},${n}`)),yield this.nakama.servers[this.userInput.remote.isOfficial][this.userInput.remote.target].socket.leaveMatch(a.objects[0].value.match_id))}catch(a){}}}catch(n){}}if(this.userInput.workers){try{yield this.nakama.servers[this.userInput.remote.isOfficial][this.userInput.remote.target].client.rpc(this.nakama.servers[this.userInput.remote.isOfficial][this.userInput.remote.target].session,"manage_todo_delete_fn",{id:this.userInput.id,workers:this.userInput.workers})}catch(s){}for(let s=0,n=this.userInput.workers.length;s<n;s++)try{let a=yield this.nakama.servers[this.userInput.remote.isOfficial][this.userInput.remote.target].client.readStorageObjects(this.nakama.servers[this.userInput.remote.isOfficial][this.userInput.remote.target].session,{object_ids:[{collection:"self_share",key:"private_match",user_id:this.userInput.workers[s].id}]});a.objects.length&&(yield this.nakama.servers[this.userInput.remote.isOfficial][this.userInput.remote.target].socket.joinMatch(a.objects[0].value.match_id),yield this.nakama.servers[this.userInput.remote.isOfficial][this.userInput.remote.target].socket.sendMatchState(a.objects[0].value.match_id,I.B.ADD_TODO,encodeURIComponent(t?`delete,${this.userInput.id}`:`done,${this.userInput.id}`)),yield this.nakama.servers[this.userInput.remote.isOfficial][this.userInput.remote.target].socket.leaveMatch(a.objects[0].value.match_id))}catch(a){}}this.indexed.GetFileListFromDB(`todo/${this.userInput.id}`,s=>(0,g.mG)(this,void 0,void 0,function*(){s.forEach(n=>this.indexed.removeFileFromUserPath(n,void 0,this.indexed.godotDB)),this.userInput.noti_id&&("DesktopPWA"==v.n$||"MobilePWA"==v.n$)&&(clearTimeout(this.nakama.web_noti_id[this.userInput.noti_id]),delete this.nakama.web_noti_id[this.userInput.noti_id]),this.noti.ClearNoti(this.userInput.noti_id),t&&this.global.godot_window.remove_todo&&this.global.godot_window.remove_todo(JSON.stringify(this.userInput)),i.dismiss(),this.navCtrl.back()}),this.indexed.godotDB)})}ionViewWillLeave(){return(0,g.mG)(this,void 0,void 0,function*(){this.indexed.GetFileListFromDB("tmp_files",t=>{t.forEach(i=>this.indexed.removeFileFromUserPath(i,void 0,this.indexed.godotDB))},this.indexed.godotDB),this.noti.Current="",this.p5timer&&this.p5timer.remove(),this.global.CreateGodotIFrame("todo",{local_url:"assets/data/godot/todo.pck",title:"Todo",add_todo_menu:t=>{this.nakama.open_add_todo_page(t)}})})}ngOnDestroy(){this.nakama.AddTodoLinkAct=void 0,this.nakama.AddTodoManageUpdateAct=void 0,this.p5canvas&&this.p5canvas.remove()}}return l.\u0275fac=function(t){return new(t||l)(e.Y36(k.gz),e.Y36(k.F0),e.Y36(c.IN),e.Y36(O.b),e.Y36(M.F),e.Y36(C.H7),e.Y36(Z.H),e.Y36(I.a),e.Y36(c.Br),e.Y36(P.J),e.Y36(S.g),e.Y36(c.HT),e.Y36(U.AN),e.Y36(j.V1),e.Y36(c.SH))},l.\u0275cmp=e.Xpm({type:l,selectors:[["app-add-todo-menu"]],viewQuery:function(t,i){if(1&t&&(e.Gf(F,5),e.Gf(J,5),e.Gf(B,5),e.Gf(q,5),e.Gf(N,5)),2&t){let s;e.iGM(s=e.CRH())&&(i.StartCalendar=s.first),e.iGM(s=e.CRH())&&(i.Calendar=s.first),e.iGM(s=e.CRH())&&(i.NewAttach=s.first),e.iGM(s=e.CRH())&&(i.StoreAt=s.first),e.iGM(s=e.CRH())&&(i.ImporantSel=s.first)}},decls:80,vars:38,consts:[["slot","start"],["defaultHref","main"],["id","p5Drop_todo",2,"position","absolute","width","100%","height","100%","display","flex","pointer-events","none","z-index","500"],["id","main_table",2,"width","100%","height","100%"],[2,"height","100%"],[2,"vertical-align","top"],["id","p5timer",2,"position","absolute","width","100%","height","8px","z-index","2"],["id","main_div",1,"main",2,"max-width","100vw"],[3,"click",4,"ngIf"],[4,"ngIf"],[1,"ion-text-right",3,"ngModel","placeholder","ngModelChange"],["button","",3,"click"],[2,"pointer-events","none",3,"value","ionChange"],["ImporantSel",""],["value","2"],["value","1"],["value","0"],["button",""],["button","","color","medium","class","ion-text-end",3,"click",4,"ngIf"],[1,"ion-text-right","uneditable_data"],[2,"display","inline",3,"hidden","locale","ionChange"],["StartCalendar",""],["Calendar",""],[1,"infobox",3,"ngModel","placeholder","ngModelChange"],[4,"ngFor","ngForOf"],[1,"ion-text-right",3,"click"],["hidden",""],["interface","action-sheet",3,"ionChange"],["NewAttach",""],["value","camera",4,"ngIf"],["value","text"],["value","image"],["hidden","","type","file","accept","*","multiple","",3,"id","change"],[2,"width","100%"],["id","bottom_buttons",2,"width","100%","background-color","black"],["expand","block",3,"disabled","click"],[3,"click"],[2,"pointer-events","none",3,"ionChange"],["StoreAt",""],["value","local"],[3,"value",4,"ngFor","ngForOf"],[3,"value"],["color","medium"],["color","medium",1,"ion-text-right"],["fixed",""],["col-33",""],["button","","color","success",3,"disabled","click"],[1,"ion-text-center"],["ManageWorker",""],["button","","slot","header"],["slot","content"],["Groups",""],["slot","end",3,"ngModel","ngModelChange"],[1,"ion-text-end"],["class","ignore_check",4,"ngFor","ngForOf"],[1,"ignore_check"],["style","color: var(--ion-color-medium);",4,"ngIf"],["slot","end","color","medium","name","ellipsis-horizontal-circle-outline",4,"ngIf"],["slot","end","color","danger","name","close-circle-outline",4,"ngIf"],["slot","end","color","success","name","checkmark-circle-outline",4,"ngIf"],[2,"color","var(--ion-color-medium)"],["slot","end","color","medium","name","ellipsis-horizontal-circle-outline"],["slot","end","color","danger","name","close-circle-outline"],["slot","end","color","success","name","checkmark-circle-outline"],["button","","color","medium",1,"ion-text-end",3,"click"],[2,"height","27px","transform","translateY(-3px)","padding","0px 8px",3,"click"],["type","color",2,"margin-right","8px","height","27px",3,"ngModel","ngModelChange"],["text-wrap",""],["class","image_thumbnail",3,"src","alt",4,"ngIf"],["button","",4,"ngIf"],[1,"image_thumbnail",3,"src","alt"],["value","camera"],["color","danger","expand","block",3,"disabled","click"]],template:function(t,i){1&t&&(e.TgZ(0,"ion-header")(1,"ion-toolbar")(2,"ion-title"),e._uU(3),e.qZA(),e.TgZ(4,"ion-buttons",0),e._UZ(5,"ion-back-button",1),e.qZA()()(),e.TgZ(6,"ion-content"),e._UZ(7,"div",2),e.TgZ(8,"table",3)(9,"tr",4)(10,"td",5),e._UZ(11,"div",6),e.TgZ(12,"div",7),e.YNc(13,W,8,3,"ion-item",8),e.YNc(14,L,12,4,"div",9),e.TgZ(15,"ion-item")(16,"ion-label"),e._uU(17),e.qZA(),e.TgZ(18,"ion-input",10),e.NdJ("ngModelChange",function(n){return i.userInput.title=n}),e.qZA()(),e.YNc(19,G,11,2,"div",9),e.TgZ(20,"ion-item",11),e.NdJ("click",function(){return i.ImporantSelClicked()}),e.TgZ(21,"ion-label"),e._uU(22),e.qZA(),e.TgZ(23,"ion-select",12,13),e.NdJ("ionChange",function(n){return i.ImporantSelChanged(n)}),e.TgZ(25,"ion-select-option",14),e._uU(26),e.qZA(),e.TgZ(27,"ion-select-option",15),e._uU(28),e.qZA(),e.TgZ(29,"ion-select-option",16),e._uU(30),e.qZA()()(),e.YNc(31,K,11,3,"div",9),e.TgZ(32,"ion-item",17)(33,"ion-label"),e._uU(34),e.qZA(),e.YNc(35,X,2,1,"ion-label",18),e.YNc(36,ee,4,2,"div",9),e.qZA(),e.TgZ(37,"ion-item",11),e.NdJ("click",function(){return i.toggle_start_calendar()}),e.TgZ(38,"ion-label"),e._uU(39),e.qZA(),e.TgZ(40,"ion-label",19),e._uU(41),e.qZA()(),e.TgZ(42,"ion-datetime",20,21),e.NdJ("ionChange",function(n){return i.start_change(n)}),e.qZA(),e.TgZ(44,"ion-item",11),e.NdJ("click",function(){return i.toggle_calendar()}),e.TgZ(45,"ion-label"),e._uU(46),e.qZA(),e.TgZ(47,"ion-label",19),e._uU(48),e.qZA()(),e.TgZ(49,"ion-datetime",20,22),e.NdJ("ionChange",function(n){return i.limit_change(n)}),e.qZA(),e.TgZ(51,"textarea",23),e.NdJ("ngModelChange",function(n){return i.userInput.description=n}),e.qZA(),e.YNc(52,ae,7,3,"div",24),e.TgZ(53,"ion-item")(54,"ion-label"),e._uU(55),e.qZA(),e.TgZ(56,"ion-button",25),e.NdJ("click",function(){return i.open_select_new()}),e._uU(57),e.qZA(),e.TgZ(58,"ion-item",26)(59,"ion-label"),e._uU(60),e.qZA(),e.TgZ(61,"ion-select",27,28),e.NdJ("ionChange",function(n){return i.new_attach(n)}),e.YNc(63,ne,2,1,"ion-select-option",29),e.TgZ(64,"ion-select-option",30),e._uU(65),e.qZA(),e.TgZ(66,"ion-select-option",31),e._uU(67),e.qZA()()(),e.TgZ(68,"ion-button",25),e.NdJ("click",function(){return i.select_attach()}),e._uU(69),e.qZA()(),e.TgZ(70,"input",32),e.NdJ("change",function(n){return i.inputImageSelected(n)}),e.qZA()()()(),e.TgZ(71,"tr")(72,"td")(73,"div",33)(74,"table",34)(75,"tr")(76,"td")(77,"ion-button",35),e.NdJ("click",function(){return i.saveData()}),e._uU(78),e.qZA()(),e.YNc(79,oe,3,2,"td",9),e.qZA()()()()()()()),2&t&&(e.xp6(3),e.Oqu(i.lang.text.TodoDetail.Title),e.xp6(10),e.Q6J("ngIf",!i.isModify),e.xp6(1),e.Q6J("ngIf",i.isModify),e.xp6(3),e.Oqu(i.lang.text.TodoDetail.DisplayName),e.xp6(1),e.Q6J("ngModel",i.userInput.title)("placeholder",i.lang.text.TodoDetail.DisplayName_placeholder),e.xp6(1),e.Q6J("ngIf","local"!=i.userInput.storeAt&&i.isManager),e.xp6(3),e.Oqu(i.lang.text.TodoDetail.Importance),e.xp6(1),e.Q6J("value",i.userInput.importance),e.xp6(3),e.Oqu(i.lang.text.TodoDetail.Importance_2),e.xp6(2),e.Oqu(i.lang.text.TodoDetail.Importance_1),e.xp6(2),e.Oqu(i.lang.text.TodoDetail.Importance_0),e.xp6(1),e.Q6J("ngIf",i.isModify&&i.userInput.workers),e.xp6(3),e.Oqu(i.lang.text.TodoDetail.CustomColor),e.xp6(1),e.Q6J("ngIf",!i.userInput.custom_color),e.xp6(1),e.Q6J("ngIf",i.userInput.custom_color),e.xp6(3),e.Oqu(i.lang.text.TodoDetail.startFrom),e.xp6(2),e.Oqu(i.startDisplay||i.lang.text.TodoDetail.startImmediatly),e.xp6(1),e.Q6J("hidden",i.isStartCalendarHidden)("locale",i.lang.lang),e.xp6(4),e.Oqu(i.lang.text.TodoDetail.limit),e.xp6(2),e.Oqu(i.limitDisplay),e.xp6(1),e.Q6J("hidden",i.isCalendarHidden)("locale",i.lang.lang),e.xp6(2),e.Q6J("ngModel",i.userInput.description)("placeholder",i.lang.text.TodoDetail.description),e.xp6(1),e.Q6J("ngForOf",i.userInput.attach),e.xp6(3),e.Oqu(i.lang.text.TodoDetail.attachments),e.xp6(2),e.hij(" ",i.lang.text.TodoDetail.new_attach," "),e.xp6(3),e.Oqu(i.lang.text.TodoDetail.new_attach),e.xp6(3),e.Q6J("ngIf",i.can_cordova),e.xp6(2),e.Oqu(i.lang.text.TodoDetail.new_text),e.xp6(2),e.Oqu(i.lang.text.TodoDetail.new_draw),e.xp6(2),e.hij(" ",i.lang.text.TodoDetail.add_attach," "),e.xp6(1),e.Q6J("id",i.file_sel_id),e.xp6(7),e.Q6J("disabled",!i.isModifiable||i.isButtonClicked),e.xp6(1),e.hij(" ",i.buttonDisplay.saveTodo," "),e.xp6(1),e.Q6J("ngIf",i.isModify))},directives:[c.Gu,c.sr,c.wd,c.Sm,c.oU,c.cs,c.W2,x.O5,c.Ie,c.Q$,c.t9,c.QI,c.n0,x.sg,c.jY,c.Nd,c.wI,c.pK,c.j9,T.JJ,T.On,c.eh,c.We,c.q_,c.nz,c.w,c.gu,T.Fj,c.x4,c.YG],styles:[".uneditable_data[_ngcontent-%COMP%]{color:#888}.main[_ngcontent-%COMP%]{width:100%;height:100%;padding:8px;overflow-x:hidden;overflow-y:auto;scroll-behavior:smooth}.logs[_ngcontent-%COMP%]{background:var(--voidDraw-menu-background);border-radius:8px;margin:8px;padding:4px 8px;text-align:center}.image_thumbnail[_ngcontent-%COMP%]{width:auto;height:auto;object-fit:contain;display:block;margin:auto}.ignore_check[_ngcontent-%COMP%]{pointer-events:none}"]}),l})()}];let le=(()=>{class l{}return l.\u0275fac=function(t){return new(t||l)},l.\u0275mod=e.oAB({type:l}),l.\u0275inj=e.cJS({imports:[[k.Bz.forChild(re)],k.Bz]}),l})(),de=(()=>{class l{}return l.\u0275fac=function(t){return new(t||l)},l.\u0275mod=e.oAB({type:l}),l.\u0275inj=e.cJS({imports:[[x.ez,T.u5,c.Pc,le]]}),l})()}}]);