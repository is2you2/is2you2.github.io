"use strict";(self.webpackChunkapp=self.webpackChunkapp||[]).push([[5436],{5436:(J,m,u)=>{u.r(m),u.d(m,{WebrtcManageIoDevPageModule:()=>E});var g=u(177),d=u(4341),s=u(5374),c=u(9858),p=u(467),_=u(92),e=u(3953),h=u(4234),f=u(755),b=u(482),R=u(9900),M=u(4237),D=u(3656);const W=["VideoIn"],j=["AudioIn"],S=["AudioOut"],C=["RegisterNewWebRTCServer"],G=()=>[.5,.6,.7,.8,.9,1];function T(o,a){if(1&o&&(e.j41(0,"ion-item")(1,"ion-radio",15),e.EFF(2),e.k0s()()),2&o){const i=a.$implicit,t=a.index;e.R7$(),e.Y8G("value",t),e.R7$(),e.JRh(i.label||i.deviceId)}}function k(o,a){if(1&o&&(e.j41(0,"div")(1,"ion-item-divider")(2,"ion-label"),e.EFF(3),e.k0s()(),e.j41(4,"ion-radio-group",13,2),e.DNE(6,T,3,2,"ion-item",14),e.k0s()()),2&o){const i=e.XpG();e.R7$(3),e.JRh(i.lang.text.WebRTCDevManager.VideoIn),e.R7$(3),e.Y8G("ngForOf",i.VideoInputs)}}function x(o,a){if(1&o&&(e.j41(0,"ion-item")(1,"ion-radio",15),e.EFF(2),e.k0s()()),2&o){const i=a.$implicit,t=a.index;e.R7$(),e.Y8G("value",t),e.R7$(),e.JRh(i.label||i.deviceId)}}function P(o,a){if(1&o&&(e.j41(0,"div")(1,"ion-item-divider")(2,"ion-label"),e.EFF(3),e.k0s()(),e.j41(4,"ion-radio-group",16,3),e.DNE(6,x,3,2,"ion-item",14),e.k0s()()),2&o){const i=e.XpG();e.R7$(3),e.JRh(i.lang.text.WebRTCDevManager.AudioIn),e.R7$(3),e.Y8G("ngForOf",i.AudioInputs)}}function $(o,a){if(1&o){const i=e.RV6();e.j41(0,"ion-item",10),e.bIt("click",function(){e.eBV(i);const n=e.XpG();return e.Njj(n.saveSetup())}),e.j41(1,"ion-label",11),e.EFF(2),e.k0s()()}if(2&o){const i=e.XpG();e.R7$(2),e.JRh(i.lang.text.WebRTCDevManager.saveSetup)}}function F(o,a){if(1&o){const i=e.RV6();e.j41(0,"img",21),e.bIt("click",function(){e.eBV(i);const n=e.XpG().index,r=e.XpG();return e.Njj(r.copy_info(n))}),e.k0s()}if(2&o){const i=e.XpG().index,t=e.XpG();e.Y8G("src",t.QRCodes[i],e.B4B)}}function V(o,a){if(1&o){const i=e.RV6();e.j41(0,"ion-accordion",15)(1,"ion-item",17)(2,"ion-label"),e.EFF(3),e.k0s()(),e.j41(4,"div",18),e.DNE(5,F,1,1,"img",19),e.j41(6,"ion-item",10),e.bIt("click",function(){const n=e.eBV(i).index,r=e.XpG();return e.Njj(r.RemoveServer(n))}),e.j41(7,"ion-label",20),e.EFF(8),e.k0s()()()()}if(2&o){const i=a.$implicit,t=a.index,n=e.XpG();e.Y8G("value",t),e.R7$(3),e.JRh(i.urls[0]),e.R7$(2),e.Y8G("ngIf",n.QRCodes[t]),e.R7$(3),e.JRh(n.lang.text.WebRTCDevManager.Remove)}}function A(o,a){if(1&o){const i=e.RV6();e.j41(0,"ion-icon",27),e.bIt("click",function(){e.eBV(i);const n=e.XpG(3);return e.Njj(n.AddServerUrl())}),e.k0s()}}function O(o,a){if(1&o){const i=e.RV6();e.j41(0,"ion-icon",28),e.bIt("click",function(){e.eBV(i);const n=e.XpG().$implicit,r=e.XpG(2);return e.Njj(r.SubtractServerUrl(n))}),e.k0s()}}function U(o,a){if(1&o){const i=e.RV6();e.j41(0,"ion-item")(1,"ion-input",24),e.mxI("ngModelChange",function(n){const r=e.eBV(i).$implicit,l=e.XpG(2);return e.DH7(l.userInput.urls[r],n)||(l.userInput.urls[r]=n),e.Njj(n)}),e.k0s(),e.DNE(2,A,1,0,"ion-icon",25)(3,O,1,0,"ion-icon",26),e.k0s()}if(2&o){const i=a.$implicit,t=e.XpG(2);e.R7$(),e.Y8G("label",0==i?t.lang.text.WebRTCDevManager.Urls:""),e.R50("ngModel",t.userInput.urls[i]),e.R7$(),e.Y8G("ngIf",0==i),e.R7$(),e.Y8G("ngIf",0!=i)}}function N(o,a){if(1&o){const i=e.RV6();e.j41(0,"ion-content")(1,"ion-item-divider")(2,"ion-label"),e.EFF(3),e.k0s()(),e.DNE(4,U,4,4,"ion-item",14),e.j41(5,"ion-item")(6,"ion-input",22),e.mxI("ngModelChange",function(n){e.eBV(i);const r=e.XpG();return e.DH7(r.userInput.username,n)||(r.userInput.username=n),e.Njj(n)}),e.k0s()(),e.j41(7,"ion-item")(8,"ion-input",23),e.mxI("ngModelChange",function(n){e.eBV(i);const r=e.XpG();return e.DH7(r.userInput.credential,n)||(r.userInput.credential=n),e.Njj(n)}),e.k0s()(),e.j41(9,"ion-item",10),e.bIt("click",function(){e.eBV(i);const n=e.XpG();return e.Njj(n.SaveServer())}),e.j41(10,"ion-label",11),e.EFF(11),e.k0s()()()}if(2&o){const i=e.XpG();e.R7$(3),e.JRh(i.lang.text.WebRTCDevManager.ServerInfo),e.R7$(),e.Y8G("ngForOf",i.UserInputUrlsLength),e.R7$(2),e.Y8G("label",i.lang.text.WebRTCDevManager.Username),e.R50("ngModel",i.userInput.username),e.R7$(2),e.Y8G("label",i.lang.text.WebRTCDevManager.Credential),e.R50("ngModel",i.userInput.credential),e.R7$(3),e.JRh(i.lang.text.WebRTCDevManager.Save)}}const X=[{path:"",component:(()=>{var o;class a{constructor(t,n,r,l,v,I,B,Y){this.lang=t,this.indexed=n,this.global=r,this.p5toast=l,this.nakama=v,this.router=I,this.route=B,this.navCtrl=Y,this.InOut=[],this.VideoInputs=[],this.AudioInputs=[],this.AudioOutputs=[],this.ServerInfos=[],this.QRCodes=[],this.userInput={urls:[""],username:"",credential:""},this.UserInputUrlsLength=[0]}ngOnDestroy(){this.route.queryParams.unsubscribe(),this.global.PageDismissAct["webrtc-manage"]&&this.global.PageDismissAct["webrtc-manage"]({})}ngOnInit(){this.route.queryParams.subscribe(t=>{const n=this.router.getCurrentNavigation().extras.state;this.InOut=n.list||[];for(let r=0,l=this.InOut.length;r<l;r++)this.InOut[r].kind.indexOf("videoinput")>=0&&this.VideoInputs.push(this.InOut[r]),this.InOut[r].kind.indexOf("audioinput")>=0&&this.AudioInputs.push(this.InOut[r]),this.InOut[r].kind.indexOf("audiooutput")>=0&&this.AudioOutputs.push(this.InOut[r])})}ionViewWillEnter(){var t=this;return(0,p.A)(function*(){try{let n=yield t.indexed.loadTextFromUserPath("servers/webrtc_server.json");t.ServerInfos=JSON.parse(n);for(let r=0,l=t.ServerInfos.length;r<l;r++){let I=t.global.readasQRCodeFromString(`${_.d2}pjcone_pwa/?rtcserver=[${t.ServerInfos[r].urls}],${t.ServerInfos[r].username},${t.ServerInfos[r].credential}`);t.QRCodes[r]=I}}catch{}try{let n=localStorage.getItem("VideoInputDev");t.VideoInput.value=Number(n)||0}catch{}try{let n=localStorage.getItem("AudioInputDev");t.AudioInput.value=Number(n)||0}catch{}})()}ionViewDidEnter(){this.global.p5KeyShortCut.AddAct=()=>{this.OpenNewWebRTCServerForm()}}saveSetup(){let t={};this.VideoInput&&void 0!==this.VideoInput.value&&(t.videoinput=this.VideoInputs[this.VideoInput.value],localStorage.setItem("VideoInputDev",this.VideoInput.value)),this.AudioInput&&void 0!==this.AudioInput.value&&(t.audioinput=this.AudioInputs[this.AudioInput.value],localStorage.setItem("AudioInputDev",this.AudioInput.value)),this.AudioOutput&&void 0!==this.AudioOutput.value&&(t.audiooutput=this.AudioOutputs[this.AudioOutput.value]),this.global.PageDismissAct["webrtc-manage"]&&this.global.PageDismissAct["webrtc-manage"]({data:t}),this.navCtrl.pop()}AddServerUrl(){this.userInput.urls.push(""),this.UserInputUrlsLength.push(this.UserInputUrlsLength.length)}SubtractServerUrl(t){this.userInput.urls.splice(t,1),this.UserInputUrlsLength.pop()}OpenNewWebRTCServerForm(){this.RegisterServer.present()}SaveServer(){var t=this;return(0,p.A)(function*(){t.userInput.urls.filter(l=>l);for(let l=t.userInput.urls.length-1;l>=0;l--)t.userInput.urls[l].trim()||t.userInput.urls.splice(l,1);if(!t.userInput.urls.length)return void t.p5toast.show({text:t.lang.text.WebRTCDevManager.IgnoreSave});yield t.nakama.SaveWebRTCServer(t.userInput);let r=t.global.readasQRCodeFromString(`${_.d2}pjcone_pwa/?rtcserver=[${t.userInput.urls}],${t.userInput.username},${t.userInput.credential}`);t.QRCodes.push(r),t.ServerInfos.push(t.userInput),t.userInput={urls:[""],username:"",credential:""},t.UserInputUrlsLength.length=0,t.UserInputUrlsLength.push(0),t.RegisterServer.dismiss()})()}copy_info(t){this.global.WriteValueToClipboard("text/plain",`${_.d2}pjcone_pwa/?rtcserver=[${this.ServerInfos[t].urls}],${this.ServerInfos[t].username},${this.ServerInfos[t].credential}`)}RemoveServer(t){var n=this;return(0,p.A)(function*(){n.ServerInfos.splice(t,1),yield n.indexed.saveTextFileToUserPath(JSON.stringify(n.ServerInfos),"servers/webrtc_server.json")})()}ionViewWillLeave(){delete this.global.p5KeyShortCut.AddAct}}return(o=a).\u0275fac=function(t){return new(t||o)(e.rXU(h.y),e.rXU(f.n),e.rXU(b.z3),e.rXU(R.G),e.rXU(M.X),e.rXU(c.Ix),e.rXU(c.nX),e.rXU(D.q9))},o.\u0275cmp=e.VBU({type:o,selectors:[["app-webrtc-manage-io-dev"]],viewQuery:function(t,n){if(1&t&&(e.GBs(W,5),e.GBs(j,5),e.GBs(S,5),e.GBs(C,5)),2&t){let r;e.mGM(r=e.lsd())&&(n.VideoInput=r.first),e.mGM(r=e.lsd())&&(n.AudioInput=r.first),e.mGM(r=e.lsd())&&(n.AudioOutput=r.first),e.mGM(r=e.lsd())&&(n.RegisterServer=r.first)}},decls:22,vars:10,consts:[["WebRTCServers",""],["RegisterNewWebRTCServer",""],["VideoIn",""],["AudioIn",""],[1,"ion-no-border"],["slot","start"],["defaultHref",""],[4,"ngIf"],["button","",3,"click",4,"ngIf"],[3,"value",4,"ngFor","ngForOf"],["button","",3,"click"],[1,"ion-text-center"],[3,"initialBreakpoint","breakpoints"],["name","videoinput"],[4,"ngFor","ngForOf"],[3,"value"],["name","audioinput"],["button","","slot","header"],["slot","content"],["style","width: 100%; height: auto;","alt","Loading",3,"src","click",4,"ngIf"],["color","danger",1,"ion-text-center"],["alt","Loading",2,"width","100%","height","auto",3,"click","src"],["placeholder","username",1,"ion-text-end",3,"ngModelChange","label","ngModel"],["placeholder","credential",1,"ion-text-end",3,"ngModelChange","label","ngModel"],["placeholder","stun:stun.l.google.com:19302",1,"ion-text-end",3,"ngModelChange","label","ngModel"],["slot","end","color","success","name","add-circle-outline",3,"click",4,"ngIf"],["slot","end","color","danger","name","remove-circle-outline",3,"click",4,"ngIf"],["slot","end","color","success","name","add-circle-outline",3,"click"],["slot","end","color","danger","name","remove-circle-outline",3,"click"]],template:function(t,n){if(1&t){const r=e.RV6();e.j41(0,"ion-header",4)(1,"ion-toolbar")(2,"ion-title"),e.EFF(3),e.k0s(),e.j41(4,"ion-buttons",5),e.nrm(5,"ion-back-button",6),e.k0s()()(),e.j41(6,"ion-content"),e.DNE(7,k,7,2,"div",7)(8,P,7,2,"div",7)(9,$,3,1,"ion-item",8),e.j41(10,"ion-item-divider")(11,"ion-label"),e.EFF(12),e.k0s()(),e.j41(13,"ion-accordion-group",null,0),e.DNE(15,V,9,4,"ion-accordion",9),e.k0s(),e.j41(16,"ion-item",10),e.bIt("click",function(){return e.eBV(r),e.Njj(n.OpenNewWebRTCServerForm())}),e.j41(17,"ion-label",11),e.EFF(18),e.k0s()(),e.j41(19,"ion-modal",12,1),e.DNE(21,N,12,7,"ng-template"),e.k0s()()}2&t&&(e.R7$(3),e.JRh(n.lang.text.WebRTCDevManager.Title),e.R7$(4),e.Y8G("ngIf",n.VideoInputs.length),e.R7$(),e.Y8G("ngIf",n.AudioInputs.length),e.R7$(),e.Y8G("ngIf",n.InOut.length),e.R7$(3),e.JRh(n.lang.text.WebRTCDevManager.ManageServer),e.R7$(3),e.Y8G("ngForOf",n.ServerInfos),e.R7$(3),e.JRh(n.lang.text.WebRTCDevManager.AddServer),e.R7$(),e.Y8G("initialBreakpoint",.5)("breakpoints",e.lJ4(9,G)))},dependencies:[g.Sq,g.bT,d.BC,d.vS,s.xk,s.YH,s.QW,s.W9,s.eU,s.iq,s.$w,s.uz,s.Dg,s.he,s.KO,s.f0,s.BC,s.ai,s.Sb,s.Je,s.Gw,s.el]}),a})()}];let y=(()=>{var o;class a{}return(o=a).\u0275fac=function(t){return new(t||o)},o.\u0275mod=e.$C({type:o}),o.\u0275inj=e.G2t({imports:[c.iI.forChild(X),c.iI]}),a})(),E=(()=>{var o;class a{}return(o=a).\u0275fac=function(t){return new(t||o)},o.\u0275mod=e.$C({type:o}),o.\u0275inj=e.G2t({imports:[g.MD,d.YN,s.bv,y]}),a})()}}]);