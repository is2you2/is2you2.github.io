"use strict";(self.webpackChunkapp=self.webpackChunkapp||[]).push([[6556],{6556:(oe,v,_)=>{_.r(v),_.d(v,{UserFsDirPageModule:()=>re});var x=_(177),b=_(4341),u=_(5374),F=_(9858),g=_(467),D=_(92),y=_(8326),e=_(3953),U=_(755),P=_(3656),I=_(4234),k=_(482),R=_(9900),j=_(345),C=_(5547),T=_(4237);const S=["FileSel"];function G(r,d){if(1&r){const o=e.RV6();e.j41(0,"ion-icon",15),e.bIt("click",function(){e.eBV(o);const t=e.XpG();return e.Njj(t.toggle_thumbnail())}),e.k0s()}}function $(r,d){if(1&r){const o=e.RV6();e.j41(0,"ion-icon",16),e.bIt("click",function(){e.eBV(o);const t=e.XpG();return e.Njj(t.toggle_thumbnail())}),e.k0s()}}function N(r,d){if(1&r){const o=e.RV6();e.j41(0,"ion-item",18),e.bIt("click",function(){e.eBV(o);const t=e.XpG(2);return e.Njj(t.SelectImportFolder())}),e.nrm(1,"ion-icon",19),e.j41(2,"ion-label"),e.EFF(3),e.k0s()()}if(2&r){const o=e.XpG(2);e.R7$(3),e.SpI(" ",o.lang.text.UserFsDir.ImportFolder," ")}}function L(r,d){if(1&r){const o=e.RV6();e.j41(0,"div"),e.DNE(1,N,4,1,"ion-item",13),e.j41(2,"input",17),e.bIt("change",function(t){e.eBV(o);const n=e.XpG();return e.Njj(n.inputImageSelected(t))}),e.k0s()()}if(2&r){const o=e.XpG();e.R7$(),e.Y8G("ngIf",o.cant_dedicated)}}function E(r,d){if(1&r){const o=e.RV6();e.j41(0,"ion-item",18),e.bIt("click",function(){e.eBV(o);const t=e.XpG();return e.Njj(t.MoveToUpDir())}),e.nrm(1,"ion-icon",10),e.j41(2,"ion-label"),e.EFF(3,".."),e.k0s()()}}function w(r,d){if(1&r){const o=e.RV6();e.j41(0,"ion-item",18),e.bIt("click",function(){e.eBV(o);const t=e.XpG().$implicit,n=e.XpG();return e.Njj(n.SelectFolder(t))}),e.nrm(1,"ion-icon",10),e.j41(2,"ion-label"),e.EFF(3),e.k0s()()}if(2&r){const o=e.XpG().$implicit;e.R7$(3),e.JRh(o.name)}}function X(r,d){if(1&r){const o=e.RV6();e.j41(0,"div",20),e.bIt("contextmenu",function(){const t=e.eBV(o).$implicit,n=e.XpG();return e.Njj(n.DeleteShortcut(t))}),e.DNE(1,w,4,1,"ion-item",13),e.k0s()}if(2&r){const o=d.$implicit,i=e.XpG();e.R7$(),e.Y8G("ngIf",i.CurrentDir==o.dir)}}function B(r,d){1&r&&e.nrm(0,"ion-icon",38)}function V(r,d){1&r&&e.nrm(0,"ion-icon",39)}function A(r,d){1&r&&e.nrm(0,"ion-icon",40)}function M(r,d){1&r&&e.nrm(0,"ion-icon",41)}function O(r,d){1&r&&e.nrm(0,"ion-icon",42)}function Y(r,d){1&r&&e.nrm(0,"ion-icon",43)}function H(r,d){1&r&&e.nrm(0,"ion-icon",44)}function W(r,d){1&r&&e.nrm(0,"ion-icon",45)}function z(r,d){if(1&r&&(e.j41(0,"ion-label",46),e.EFF(1),e.k0s()),2&r){const o=e.XpG(2).$implicit;e.R7$(),e.JRh(o.name)}}function J(r,d){if(1&r&&(e.j41(0,"ion-label"),e.EFF(1),e.k0s()),2&r){const o=e.XpG(2).$implicit;e.R7$(),e.JRh(o.name)}}function K(r,d){if(1&r){const o=e.RV6();e.j41(0,"ion-button",47),e.bIt("click",function(){e.eBV(o);const t=e.XpG(2).$implicit,n=e.XpG();return e.Njj(n.OpenFile(t))}),e.EFF(1),e.k0s()}if(2&r){const o=e.XpG(3);e.R7$(),e.SpI(" ",o.lang.text.UserFsDir.Open," ")}}function Q(r,d){if(1&r){const o=e.RV6();e.j41(0,"ion-button",47),e.bIt("click",function(){e.eBV(o);const t=e.XpG(2).$implicit,n=e.XpG();return e.Njj(n.dismiss_page(t))}),e.EFF(1),e.k0s()}if(2&r){const o=e.XpG(3);e.R7$(),e.SpI(" ",o.lang.text.UserFsDir.Select," ")}}function Z(r,d){if(1&r){const o=e.RV6();e.j41(0,"ion-button",47),e.bIt("click",function(){e.eBV(o);const t=e.XpG(2).$implicit,n=e.XpG();return e.Njj(n.DownloadFile(t))}),e.EFF(1),e.k0s()}if(2&r){const o=e.XpG(3);e.R7$(),e.SpI(" ",o.lang.text.UserFsDir.Download," ")}}function q(r,d){if(1&r){const o=e.RV6();e.j41(0,"div",48),e.bIt("click",function(){e.eBV(o);const t=e.XpG(2).$implicit,n=e.XpG();return e.Njj(n.OpenFile(t))}),e.nrm(1,"img",49),e.k0s()}if(2&r){const o=e.XpG(2).$implicit,i=e.XpG();e.R7$(),e.Aen(i.HideThumbnail?"filter: blur(6px);":""),e.Y8G("src",o.thumbnail,e.B4B)("alt",o.name)}}function ee(r,d){if(1&r){const o=e.RV6();e.j41(0,"ion-accordion",22)(1,"ion-item",23),e.DNE(2,B,1,0,"ion-icon",24)(3,V,1,0,"ion-icon",25)(4,A,1,0,"ion-icon",26)(5,M,1,0,"ion-icon",27)(6,O,1,0,"ion-icon",28)(7,Y,1,0,"ion-icon",29)(8,H,1,0,"ion-icon",30)(9,W,1,0,"ion-icon",31)(10,z,2,1,"ion-label",32)(11,J,2,1,"ion-label",8),e.nrm(12,"ion-icon",33),e.k0s(),e.j41(13,"div",34)(14,"ion-item",9)(15,"ion-label"),e.EFF(16),e.k0s(),e.DNE(17,K,2,1,"ion-button",35)(18,Q,2,1,"ion-button",35)(19,Z,2,1,"ion-button",35),e.j41(20,"ion-button",36),e.bIt("click",function(){e.eBV(o);const t=e.XpG(),n=t.$implicit,s=t.index,l=e.XpG();return e.Njj(l.RemoveFile(n,s))}),e.EFF(21),e.k0s()(),e.DNE(22,q,2,4,"div",37),e.k0s()()}if(2&r){const o=e.XpG().$implicit,i=e.XpG(),t=e.sdS(27);e.Y8G("value",o.path),e.R7$(2),e.Y8G("ngIf","image"==o.viewer),e.R7$(),e.Y8G("ngIf","audio"==o.viewer),e.R7$(),e.Y8G("ngIf","video"==o.viewer),e.R7$(),e.Y8G("ngIf","text"==o.viewer),e.R7$(),e.Y8G("ngIf","godot"==o.viewer),e.R7$(),e.Y8G("ngIf","code"==o.viewer),e.R7$(),e.Y8G("ngIf","blender"==o.viewer),e.R7$(),e.Y8G("ngIf","disabled"==o.viewer),e.R7$(),e.Y8G("ngIf",t.value==o.path),e.R7$(),e.Y8G("ngIf",t.value!=o.path),e.R7$(5),e.JRh(i.lang.text.UserFsDir.Action),e.R7$(),e.Y8G("ngIf","image"!=o.viewer),e.R7$(),e.Y8G("ngIf",i.navParams.selector),e.R7$(),e.Y8G("ngIf",i.cant_dedicated&&!i.navParams.selector),e.R7$(2),e.SpI(" ",i.lang.text.UserFsDir.Delete," "),e.R7$(),e.Y8G("ngIf","image"==o.viewer)}}function te(r,d){if(1&r){const o=e.RV6();e.j41(0,"div",20),e.bIt("contextmenu",function(){const t=e.eBV(o).$implicit,n=e.XpG();return e.Njj(n.DeleteShortcut(t))}),e.DNE(1,ee,23,17,"ion-accordion",21),e.k0s()}if(2&r){const o=d.$implicit,i=e.XpG();e.R7$(),e.Y8G("ngIf",i.CurrentDir==o.dir||i.navParams.selector)}}const ie=[{path:"",component:(()=>{var r;class d{constructor(i,t,n,s,l,a,c,h,m,p,f,se){this.indexed=i,this.loadingCtrl=t,this.lang=n,this.global=s,this.p5toast=l,this.alertCtrl=a,this.sanitizer=c,this.navCtrl=h,this.noti=m,this.nakama=p,this.router=f,this.route=se,this.DirList=[],this.FileList=[],this.cant_dedicated=!1,this.is_ready=!1,this.HideThumbnail=!1,this.CanImportFolder=!0,this.StopIndexing=!1,this.lock_modal_open=!1}ngOnDestroy(){this.route.queryParams.unsubscribe(),this.global.PageDismissAct[this.navParams.dismiss]&&this.global.PageDismissAct[this.navParams.dismiss]({})}toggle_thumbnail(){this.HideThumbnail=!this.HideThumbnail,localStorage.setItem("user-fs-thumbnail",this.HideThumbnail?"1":"0")}ngOnInit(){"DesktopPWA"==D.aH&&setTimeout(()=>{this.CreateDrop()},100),this.CanImportFolder="MobilePWA"!=D.aH,this.route.queryParams.subscribe(i=>{const t=this.router.getCurrentNavigation().extras.state;this.navParams=t||{}})}ionViewDidEnter(){this.global.p5KeyShortCut.Escape=()=>{this.is_ready?""==this.CurrentDir?this.navCtrl.pop():this.MoveToUpDir():(this.initLoadingElement.dismiss(),this.is_ready=!0)}}CreateDrop(){var i=this;let t=document.getElementById("p5Drop_userfs");this.p5canvas=new y(n=>{n.setup=()=>{let h=n.createCanvas(t.clientWidth,t.clientHeight);h.parent(t),n.pixelDensity(.1),h.drop(m=>{let p=n.millis();a<p-400?(l=!1,c.length=0,c.push(m)):(l=!0,c.push(m)),a=p,clearTimeout(s),s=setTimeout((0,g.A)(function*(){if(l)i.MultipleDrops(c);else{let f=yield i.loadingCtrl.create({message:i.lang.text.TodoDetail.WIP});f.present(),i.importSelected(m.file),f.dismiss()}}),400)})};let s,l=!1,a=0,c=[];n.mouseMoved=h=>{h.dataTransfer?(t.style.pointerEvents="all",t.style.backgroundColor="#0008"):(t.style.pointerEvents="none",t.style.backgroundColor="transparent")}})}CreateNewFolder(){var t,i=this;this.alertCtrl.create({header:this.lang.text.UserFsDir.CreateFolder,inputs:[{type:"text",placeholder:this.lang.text.UserFsDir.FolderName}],buttons:[{text:this.lang.text.UserFsDir.Create,handler:(t=(0,g.A)(function*(n){if(n[0])try{let s=`${i.CurrentDir?i.CurrentDir+"/":""}${n[0]}`;yield i.indexed.createDirectory(s);let l=yield i.indexed.GetFileInfoFromDB(s),a={path:s,mode:l.mode,timestamp:l.timestamp,db:i.indexed.ionicDB};a.name=n[0],a.dir=i.CurrentDir,i.DirList.push(a)}catch(s){console.error("\ud3f4\ub354 \uc0dd\uc131 \uc2e4\ud328: ",s),i.p5toast.show({text:`${i.lang.text.UserFsDir.FailedToCreateFolder}: ${s}`})}else i.p5toast.show({text:i.lang.text.UserFsDir.NeedFolderName})}),function(s){return t.apply(this,arguments)})}]}).then(t=>{this.global.p5KeyShortCut.Escape=()=>{t.dismiss()},t.onDidDismiss().then(()=>{this.ionViewDidEnter()}),t.present()})}SelectFiles(){document.getElementById("import_file").click()}MultipleDrops(i){var t=this;return(0,g.A)(function*(){let n=yield t.loadingCtrl.create({message:t.lang.text.TodoDetail.WIP});n.present();for(let s=0,l=i.length;s<l;s++)yield t.importSelected(i[s].file);n.dismiss()})()}inputFileSelected(i){var t=this;return(0,g.A)(function*(){if(i.target.files.length)if(1!=i.target.files.length){let s=yield t.loadingCtrl.create({message:t.lang.text.UserFsDir.MultipleSave});s.present();for(let l=0,a=i.target.files.length;l<a&&!t.StopIndexing;l++)s.message=`${t.lang.text.UserFsDir.MultipleSave}: ${a-l}`,yield t.importSelected(i.target.files[l]);t.noti.ClearNoti(4),s.dismiss()}else{let s=yield t.loadingCtrl.create({message:t.lang.text.TodoDetail.WIP});s.present(),yield t.importSelected(i.target.files[0]),s.dismiss()}})()}importSelected(i){var t=this;return(0,g.A)(function*(){try{let n=`${t.CurrentDir?t.CurrentDir+"/":""}${i.name}`;yield t.indexed.saveBlobToUserPath(i,n);let s=yield t.indexed.GetFileInfoFromDB(n),l={path:n,mode:s.mode,timestamp:s.timestamp,db:t.indexed.ionicDB};l.name=i.name,l.dir=t.CurrentDir,l.file_ext=l.name.split(".").pop(),t.global.set_viewer_category_from_ext(l),"image"==l.viewer&&t.indexed.loadBlobFromUserPath(l.path,"",a=>{let c=URL.createObjectURL(a);l.thumbnail=t.sanitizer.bypassSecurityTrustUrl(c)});try{let a=l.path.split("/");if(5!=a.length||"groups"!=a[3])throw"\uadf8\ub8f9 \uc774\ubbf8\uc9c0 \ud30c\uc77c\uc774 \uc544\ub2d8";t.SetDisplayGroupImageName(l,a)}catch{}for(let a=0,c=t.FileList.length;a<c;a++)if(t.FileList[a].path==n){t.FileList.splice(a,1);break}t.FileList.push(l)}catch(n){console.log("importSelected error: ",n)}})()}ionViewWillEnter(){this.lock_modal_open?this.lock_modal_open=!1:(this.HideThumbnail="1"==localStorage.getItem("user-fs-thumbnail"),this.CurrentDir="",this.LoadAllIndexedFiles(),("DesktopPWA"==D.aH||"MobilePWA"==D.aH)&&(this.cant_dedicated=!0))}dismiss_page(i){var t=this;return(0,g.A)(function*(){if(t.navParams.selector){let n;i&&(n=yield t.indexed.loadBlobFromUserPath(i.path,""),n.name=i.name,n.file_ext=i.file_ext),t.global.PageDismissAct[t.navParams.dismiss]&&t.global.PageDismissAct[t.navParams.dismiss](),t.navCtrl.pop()}})()}LoadAllIndexedFiles(){var i=this;return(0,g.A)(function*(){if(i.initLoadingElement=yield i.loadingCtrl.create({message:i.lang.text.UserFsDir.LoadingExplorer}),i.initLoadingElement.present(),i.DirList.length=0,i.FileList.length=0,i.navParams.selector)if(i.navParams.path){let t=yield i.indexed.GetFileListFromDB(i.navParams.path);yield i.ModulateIndexedFile(t)}else{let t=yield i.indexed.GetFileListFromDB("/files/");yield i.ModulateIndexedFile(t)}else{let t=yield i.indexed.GetFileListFromDB("/");yield i.ModulateIndexedFile(t)}i.navParams.selector?i.FileList.sort((t,n)=>t.timestamp<n.timestamp?1:t.timestamp>n.timestamp?-1:0):(i.FileList.sort((t,n)=>t.path>n.path?1:t.path<n.path?-1:0),i.DirList.sort((t,n)=>t.path>n.path?1:t.path<n.path?-1:0)),i.noti.ClearNoti(5),i.initLoadingElement.dismiss(),i.is_ready=!0})()}ModulateIndexedFile(i){var t=this;return(0,g.A)(function*(){for(let n=0,s=i.length;n<s;n++){if(t.StopIndexing)return;t.initLoadingElement.message=`${t.lang.text.UserFsDir.LoadingExplorer}: ${i.length-n}`,yield t.indexed.GetFileInfoFromDB(i[n],a=>{let c={path:i[n],mode:a.mode,timestamp:a.timestamp};switch(c.name=c.path.substring(c.path.lastIndexOf("/")+1),c.dir=i[n].substring(0,i[n].lastIndexOf("/")),c.mode){case 33206:c.file_ext=c.name.split(".").pop(),t.global.set_viewer_category_from_ext(c),"image"==c.viewer&&t.indexed.loadBlobFromUserPath(c.path,"",p=>{let f=URL.createObjectURL(p);c.thumbnail=t.sanitizer.bypassSecurityTrustUrl(f)});try{let p=c.path.split("/");if(5!=p.length||"groups"!=p[3])throw"\uadf8\ub8f9 \uc774\ubbf8\uc9c0 \ud30c\uc77c\uc774 \uc544\ub2d8";t.SetDisplayGroupImageName(c,p)}catch{}t.FileList.push(c);break;case 16893:0==c.path.indexOf("todo/")&&t.SetDisplayTodoName(c);let h=!1,m=c.path.split("/");try{if(5!=m.length||"channels"!=m[3])throw"\ucc44\ub110 \ud3f4\ub354\uac00 \uc544\ub2d8";t.SetDisplayChannelName(c,m),h=!0}catch{}try{if(h||5!=m.length||"users"!=m[3])throw"\uc0ac\uc6a9\uc790 \ud3f4\ub354\uac00 \uc544\ub2d8";t.SetDisplayUserName(c,m),h=!0}catch{}try{if(h||5!=m.length||"posts"!=m[3])throw"\uac8c\uc2dc\ubb3c \uc791\uc131\uc790 \ud3f4\ub354\uac00 \uc544\ub2d8";t.SetDisplayPostWriterName(c,m),h=!0}catch{}try{if(h||6!=m.length||"posts"!=m[3])throw"\uac8c\uc2dc\ubb3c \ud3f4\ub354\uac00 \uc544\ub2d8";t.SetDisplayPostName(c,m),h=!0}catch{}t.DirList.push(c);break;default:console.log("\uc608\uc0c1\ud558\uc9c0 \ubabb\ud55c \ud30c\uc77c \ubaa8\ub4dc: ",c)}})}t.noti.ClearNoti(5)})()}SetDisplayTodoName(i){var t=this;return(0,g.A)(function*(){try{let n=yield t.indexed.loadTextFromUserPath(`${i.path}/info.todo`),s=JSON.parse(n);i.name=s.title}catch{}})()}SetDisplayUserName(i,t){try{i.name=this.nakama.users[t[1]][t[2]][t[4]].display_name}catch{}}SetDisplayChannelName(i,t){try{i.name=this.nakama.channels_orig[t[1]][t[2]][i.name].title}catch{}}SetDisplayGroupImageName(i,t){try{i.name=`${this.nakama.groups[t[1]][t[2]][t[4].split(".").shift()].name}.img`}catch{}}SetDisplayPostWriterName(i,t){try{i.name=this.nakama.users[t[1]][t[2]][t[4]].display_name}catch{this.nakama.servers[t[1]][t[2]].session.user_id==i.name&&(i.name=this.nakama.users.self.display_name)}}SetDisplayPostName(i,t){var n=this;return(0,g.A)(function*(){try{let s=yield n.indexed.loadTextFromUserPath(`${i.path}/info.json`),l=JSON.parse(s);i.name=l.title}catch(s){console.log("SetDisplayPostName error: ",s)}})()}MoveToUpDir(){this.CurrentDir=this.CurrentDir.substring(0,this.CurrentDir.lastIndexOf("/")),this.FileSel.value=void 0}SelectFolder(i){this.CurrentDir=i.path,this.FileSel.value=void 0}OpenFile(i){var t=this;return(0,g.A)(function*(){if(t.lock_modal_open)return;t.lock_modal_open=!0;let n=[];if(t.navParams.selector){if(t.navParams.path)for(let s=0,l=t.FileList.length;s<l;s++)n.push({content:t.FileList[s]})}else for(let s=0,l=t.FileList.length;s<l;s++)t.FileList[s].dir==t.CurrentDir&&n.push({content:t.FileList[s]});{let s=yield t.indexed.loadBlobFromUserPath(i.path,"");i.size=s.size}t.global.PageDismissAct["userfs-viewer"]=s=>{if(s.data)switch(s.data.type){case"image":return t.global.PageDismissAct["userfs-modify-image"]=function(){var l=(0,g.A)(function*(a){if(a.data){let c=t.global.Base64ToBlob(a.data.img,"image/png");c.name=a.data.name,yield t.importSelected(c),a.data.loadingCtrl.dismiss()}t.ionViewDidEnter(),delete t.global.PageDismissAct["userfs-modify-image"]});return function(a){return l.apply(this,arguments)}}(),void t.global.ActLikeModal("void-draw",{path:s.data.path,width:s.data.width,height:s.data.height,text:s.data.text,isDarkMode:s.data.isDarkMode,scrollHeight:s.data.scrollHeight,dismiss:"userfs-modify-image"});case"text":t.importSelected(s.data.blob)}else t.ionViewDidEnter();delete t.global.PageDismissAct["userfs-viewer"]},t.global.ActLikeModal("ionic-viewer",{info:{content:i},path:i.path,relevance:n})})()}DownloadFile(i){this.indexed.DownloadFileFromUserPath(i.path,"",i.name)}SelectImportFolder(){document.getElementById("folder_sel_id").click()}inputImageSelected(i){var t=this;return(0,g.A)(function*(){let n=yield t.loadingCtrl.create({message:t.lang.text.UserFsDir.LoadingExplorer});n.present();for(let s=0,l=i.target.files.length;s<l;s++){if(t.StopIndexing)return void n.dismiss();yield t.indexed.saveBlobToUserPath(i.target.files[s],i.target.files[s].webkitRelativePath)}t.LoadAllIndexedFiles(),n.dismiss(),t.p5toast.show({text:t.lang.text.UserFsDir.NeedResetToApply})})()}DeleteShortcut(i,t){switch(i.mode){case 16893:this.RemoveDirectoryRecursive(i.path);break;case 33206:this.RemoveFile(i,t);break;default:console.log("\uc624\ub958 \uac80\ud1a0\uc6a9: ",i)}return!1}RemoveDirectoryRecursive(i=this.CurrentDir){var n,t=this;this.alertCtrl.create({header:i.substring(i.lastIndexOf("/")+1)||this.lang.text.UserFsDir.ResetDB,message:this.lang.text.UserFsDir.RemoveThisFolder,buttons:[{text:this.lang.text.UserFsDir.RemoveApply,handler:(n=(0,g.A)(function*(){let s=yield t.loadingCtrl.create({message:t.lang.text.UserFsDir.DeleteFile});s.present();let l=yield t.indexed.GetFileListFromDB(i);for(let a=0,c=l.length;a<c;a++){if(t.StopIndexing)return void s.dismiss();s.message=`${t.lang.text.UserFsDir.DeleteFile}: ${c-a}`,yield t.indexed.removeFileFromUserPath(l[a])}for(let a=t.DirList.length-1;a>=0;a--)0==t.DirList[a].path.indexOf(i)&&t.DirList.splice(a,1);for(let a=t.FileList.length-1;a>=0;a--)0==t.FileList[a].path.indexOf(i)&&t.FileList.splice(a,1);i===t.CurrentDir&&t.MoveToUpDir(),s.dismiss(),t.noti.ClearNoti(4)}),function(){return n.apply(this,arguments)}),cssClass:"redfont"}]}).then(n=>{this.global.p5KeyShortCut.Escape=()=>{n.dismiss()},n.onDidDismiss().then(()=>{this.ionViewDidEnter()}),n.present()})}RemoveFile(i,t){this.alertCtrl.create({header:i.name,message:this.lang.text.ChatRoom.CannotUndone,buttons:[{text:this.lang.text.UserFsDir.DeleteAccept,handler:()=>{this.indexed.removeFileFromUserPath(i.path,()=>{this.FileList.splice(t,1)})},cssClass:"redfont"}]}).then(n=>{this.global.p5KeyShortCut.Escape=()=>{n.dismiss()},n.onDidDismiss().then(()=>{this.ionViewDidEnter()}),n.present()})}ionViewDidLeave(){this.StopIndexing=!0,this.FileList.forEach(i=>{URL.revokeObjectURL(i.thumbnail)}),setTimeout(()=>{this.noti.ClearNoti(4),this.noti.ClearNoti(5)},1e3)}ionViewWillLeave(){delete this.global.p5KeyShortCut.Escape,delete this.global.p5KeyShortCut.Digit}}return(r=d).\u0275fac=function(i){return new(i||r)(e.rXU(U.n),e.rXU(u.Xi),e.rXU(I.y),e.rXU(k.z3),e.rXU(R.G),e.rXU(u.hG),e.rXU(j.up),e.rXU(P.q9),e.rXU(C.r),e.rXU(T.X),e.rXU(F.Ix),e.rXU(F.nX))},r.\u0275cmp=e.VBU({type:r,selectors:[["app-user-fs-dir"]],viewQuery:function(i,t){if(1&i&&e.GBs(S,5),2&i){let n;e.mGM(n=e.lsd())&&(t.FileSel=n.first)}},decls:29,vars:10,consts:[["FileSel",""],[1,"ion-no-border"],["slot","start"],["defaultHref",""],["class","top_icon","slot","end","name","eye-outline",3,"click",4,"ngIf"],["class","top_icon","slot","end","name","eye-off-outline",3,"click",4,"ngIf"],["id","p5Drop_userfs",2,"position","absolute","width","100%","height","100%","display","flex","pointer-events","none"],["hidden","","type","file","id","import_file","accept","*","multiple","",3,"change"],[4,"ngIf"],["button",""],["slot","start","name","folder"],[1,"folder_button",3,"click"],[3,"click"],["button","",3,"click",4,"ngIf"],[3,"contextmenu",4,"ngFor","ngForOf"],["slot","end","name","eye-outline",1,"top_icon",3,"click"],["slot","end","name","eye-off-outline",1,"top_icon",3,"click"],["hidden","","type","file","id","folder_sel_id","webkitdirectory","",3,"change"],["button","",3,"click"],["slot","start","name","arrow-down-circle"],[3,"contextmenu"],[3,"value",4,"ngIf"],[3,"value"],["slot","header"],["slot","start","name","image",4,"ngIf"],["slot","start","name","musical-notes",4,"ngIf"],["slot","start","name","play-circle",4,"ngIf"],["slot","start","name","reader",4,"ngIf"],["slot","start","name","extension-puzzle",4,"ngIf"],["slot","start","name","code-slash-outline",4,"ngIf"],["slot","start","name","cube-outline",4,"ngIf"],["slot","start","name","document",4,"ngIf"],["text-wrap","",4,"ngIf"],[1,"ion-accordion-toggle-icon","hide_accordion_icon"],["slot","content"],["class","ion-text-right button_dist",3,"click",4,"ngIf"],[1,"ion-text-end","button_dist",3,"click"],["class","image_front_form",3,"click",4,"ngIf"],["slot","start","name","image"],["slot","start","name","musical-notes"],["slot","start","name","play-circle"],["slot","start","name","reader"],["slot","start","name","extension-puzzle"],["slot","start","name","code-slash-outline"],["slot","start","name","cube-outline"],["slot","start","name","document"],["text-wrap",""],[1,"ion-text-right","button_dist",3,"click"],[1,"image_front_form",3,"click"],[1,"image_front_view",3,"src","alt"]],template:function(i,t){if(1&i){const n=e.RV6();e.j41(0,"ion-header",1)(1,"ion-toolbar")(2,"ion-title"),e.EFF(3),e.k0s(),e.j41(4,"ion-buttons",2),e.nrm(5,"ion-back-button",3),e.k0s(),e.DNE(6,G,1,0,"ion-icon",4)(7,$,1,0,"ion-icon",5),e.k0s()(),e.j41(8,"ion-content")(9,"div",6)(10,"input",7),e.bIt("change",function(l){return e.eBV(n),e.Njj(t.inputFileSelected(l))}),e.k0s()(),e.j41(11,"ion-list"),e.DNE(12,L,3,1,"div",8),e.j41(13,"div")(14,"ion-item",9),e.nrm(15,"ion-icon",10),e.j41(16,"ion-label"),e.EFF(17,"."),e.k0s(),e.j41(18,"ion-button",11),e.bIt("click",function(){return e.eBV(n),e.Njj(t.CreateNewFolder())}),e.EFF(19),e.k0s(),e.j41(20,"ion-button",11),e.bIt("click",function(){return e.eBV(n),e.Njj(t.SelectFiles())}),e.EFF(21),e.k0s(),e.j41(22,"ion-button",12),e.bIt("click",function(){return e.eBV(n),e.Njj(t.RemoveDirectoryRecursive())}),e.EFF(23),e.k0s()(),e.DNE(24,E,4,0,"ion-item",13),e.k0s(),e.DNE(25,X,2,1,"div",14),e.j41(26,"ion-accordion-group",null,0),e.DNE(28,te,2,1,"div",14),e.k0s()()()}2&i&&(e.R7$(3),e.JRh(t.lang.text.Settings.InAppExplorer),e.R7$(3),e.Y8G("ngIf",!t.HideThumbnail),e.R7$(),e.Y8G("ngIf",t.HideThumbnail),e.R7$(5),e.Y8G("ngIf",""==t.CurrentDir&&!t.navParams.selector&&t.CanImportFolder),e.R7$(7),e.SpI(" ",t.lang.text.UserFsDir.NewFolder," "),e.R7$(2),e.SpI(" ",t.lang.text.UserFsDir.AddFile," "),e.R7$(2),e.SpI(" ",t.lang.text.UserFsDir.RemoveCurrentDir," "),e.R7$(),e.Y8G("ngIf",""!=t.CurrentDir),e.R7$(),e.Y8G("ngForOf",t.DirList),e.R7$(3),e.Y8G("ngForOf",t.FileList))},dependencies:[x.Sq,x.bT,u.xk,u.YH,u.Jm,u.QW,u.W9,u.eU,u.iq,u.uz,u.he,u.nf,u.BC,u.ai,u.el],styles:[".item.sc-ion-label-md-h[_ngcontent-%COMP%], .item[_ngcontent-%COMP%]   .sc-ion-label-md-h[_ngcontent-%COMP%]{overflow:unset}.image_front_form[_ngcontent-%COMP%]{display:flex;justify-content:center;text-align:center}.image_front_view[_ngcontent-%COMP%]{max-height:233px}.top_icon[_ngcontent-%COMP%]{width:28px;height:28px;padding-right:28px;cursor:pointer}.button_dist[_ngcontent-%COMP%]{padding-left:2px}.folder_button[_ngcontent-%COMP%]{padding-right:4px}"]}),d})()}];let ne=(()=>{var r;class d{}return(r=d).\u0275fac=function(i){return new(i||r)},r.\u0275mod=e.$C({type:r}),r.\u0275inj=e.G2t({imports:[F.iI.forChild(ie),F.iI]}),d})(),re=(()=>{var r;class d{}return(r=d).\u0275fac=function(i){return new(i||r)},r.\u0275mod=e.$C({type:r}),r.\u0275inj=e.G2t({imports:[x.MD,b.YN,u.bv,ne]}),d})()}}]);