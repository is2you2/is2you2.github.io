"use strict";(self.webpackChunkapp=self.webpackChunkapp||[]).push([[542],{1186:(ee,P,d)=>{d.d(P,{M:()=>C});const C=(0,d(2726).fo)("SpeechRecognition",{web:()=>d.e(4850).then(d.bind(d,7554)).then(S=>new S.SpeechRecognitionWeb)})},5961:(ee,P,d)=>{d.d(P,{GW:()=>C,dk:()=>S,oK:()=>D});var D=function(g){return g.Prompt="PROMPT",g.Camera="CAMERA",g.Photos="PHOTOS",g}(D||{}),C=function(g){return g.Rear="REAR",g.Front="FRONT",g}(C||{}),S=function(g){return g.Uri="uri",g.Base64="base64",g.DataUrl="dataUrl",g}(S||{})},8162:(ee,P,d)=>{d.d(P,{V1:()=>S,dk:()=>C.dk,oK:()=>C.oK});var D=d(2726),C=d(5961);const S=(0,D.fo)("Camera",{web:()=>d.e(6468).then(d.bind(d,6468)).then(g=>new g.CameraWeb)})},477:(ee,P,d)=>{d.d(P,{$:()=>fe});var D=d(5861),C=d(9868),g=d(3641),u=d(9468),_e=d(3857),x=d(1325),ye=d(6052),ve=d(797);let fe=(()=>{var K;class ne{constructor(i,l,_,e,s,h,U){this.lang=i,this.modalCtrl=l,this.alertCtrl=_,this.loadingCtrl=e,this.global=s,this.navParams=h,this.indexed=U,this.EventListenerAct=A=>{A.detail.register(130,T=>{})},this.isMobile=!1,this.isCropMode=!1,this.WithoutSave=!0}ngOnInit(){}ionViewDidEnter(){var i=this;return(0,D.Z)(function*(){i.global.p5key.KeyShortCut.HistoryAct=l=>{switch(l){case"Z":i.p5voidDraw.history_act(-1);break;case"X":i.p5voidDraw.history_act(1);break;case"C":i.isCropMode?i.p5voidDraw.apply_crop():i.p5voidDraw.change_color();break;case"V":i.p5voidDraw.set_line_weight()}},i.global.p5key.KeyShortCut.AddAct=()=>{i.new_image()},i.global.p5key.KeyShortCut.DeleteAct=()=>{i.isCropMode?i.p5voidDraw.apply_crop():i.dismiss_draw()},i.global.p5key.KeyShortCut.SKeyAct=()=>{i.open_crop_tool()},document.addEventListener("ionBackButton",i.EventListenerAct),i.mainLoading=yield i.loadingCtrl.create({message:i.lang.text.voidDraw.UseThisImage}),i.create_new_canvas({width:i.navParams.data.width,height:i.navParams.data.height,path:i.navParams.data.path}),i.isMobile="DesktopPWA"!=g.n$})()}create_new_canvas(i){i.width=i.width||432,i.height=i.height||432,this.p5voidDraw&&this.p5voidDraw.remove(),this.create_p5voidDraw(i)}create_p5voidDraw(i){var l=this;let _=document.getElementById("voidDraw");this.isCropMode=!1,this.p5voidDraw=new C(e=>{let s,h,U,A,T,W,H,X,z=e.createColorPicker("#000"),te=!1,de=e.min(i.width,i.heigth),k=e.createSlider(1,de/10,de/100);e.setup=(0,D.Z)(function*(){k.parent(_),k.hide(),e.pixelDensity(1),e.noLoop(),e.noFill(),e.imageMode(e.CENTER),A=e.createCanvas(_.clientWidth,_.clientHeight),A.elt.addEventListener("contextmenu",n=>n.preventDefault()),A.parent(_),f.x=e.width/2,f.y=e.height/2,e.set_line_weight=()=>{te=!te,te?k.show():k.hide()},e.change_color=()=>{z.elt.click()},e.save_image=()=>{new C(n=>{n.setup=()=>{n.createCanvas(s.width,s.height),n.pixelDensity(1),h&&n.image(h,0,0),s&&n.image(s,0,0),n.saveFrames("","png",1,1,I=>{let O=I[0].imageData.replace(/"|=|\\/g,"");l.modalCtrl.dismiss({name:`voidDraw_${n.year()}-${n.nf(n.month(),2)}-${n.nf(n.day(),2)}_${n.nf(n.hour(),2)}-${n.nf(n.minute(),2)}-${n.nf(n.second(),2)}.png`,img:O,loadingCtrl:l.mainLoading}),n.remove()})}})},e.history_act=n=>{switch(M=e.min(e.max(0,M+n),L.length),n){case 1:H.style.fill="var(--ion-color-dark)",M==L.length&&(X.style.fill="var(--ion-color-medium)"),ie(s,L[M-1]);break;case-1:X.style.fill="var(--ion-color-dark)",M<1?(H.style.fill="var(--ion-color-medium)",s.background(255,0),e.redraw()):he()}},e.open_crop_tool=()=>{l.isCropMode?(l.isCropMode=!1,e.redraw()):(l.isCropMode=!0,c.x=s.width,c.y=s.height,E.x=0,E.y=0,e.redraw())},e.apply_crop=()=>{l.isMobile&&E.div(w);let n=e.createVector(s.width,s.height);s.resizeCanvas(c.x,c.y),b.sub(E),b.add(n.sub(c).div(2)),he(),h.resizeCanvas(c.x,c.y),h.push(),h.background(255),h.translate(b),U&&h.image(U,0,0),h.pop(),h.redraw(),l.isCropMode=!1,e.SetCanvasViewportInit()},T=e.createElement("table"),T.style("position: absolute; top: 0px;"),T.style(`width: 100%; height: ${y}px;`),T.style("background-color: var(--voidDraw-menu-background);"),T.parent(_);let t=T.elt.insertRow(0),o=t.insertCell(0);o.innerHTML='<ion-icon style="width: 27px; height: 27px" name="add"></ion-icon>',o.style.textAlign="center",o.style.cursor="pointer",o.onclick=()=>{l.new_image()};let r=t.insertCell(1);r.innerHTML='<ion-icon id="CropToolNotReady" style="width: 27px; height: 27px" name="crop"></ion-icon>',r.style.textAlign="center",r.style.cursor="pointer",r.onclick=()=>{l.open_crop_tool()};let v=t.insertCell(2);v.innerHTML='<ion-icon style="width: 27px; height: 27px" name="checkmark"></ion-icon>',v.style.textAlign="center",v.style.cursor="pointer",v.onclick=()=>{l.dismiss_draw()},W=e.createElement("table"),W.style("position: absolute; bottom: 0px;"),W.style(`width: 100%; height: ${y}px;`),W.style("background-color: var(--voidDraw-menu-background);"),W.parent(_);let V=W.elt.insertRow(0),B=V.insertCell(0);B.innerHTML='<ion-icon id="undoIcon" style="width: 27px; height: 27px" name="arrow-undo"></ion-icon>',H=document.getElementById("undoIcon"),H.style.fill="var(--ion-color-medium)",B.style.textAlign="center",B.style.cursor="pointer",B.onclick=()=>{l.p5voidDraw.history_act(-1)};let J=V.insertCell(1);J.innerHTML='<ion-icon id="redoIcon" style="width: 27px; height: 27px" name="arrow-redo"></ion-icon>',X=document.getElementById("redoIcon"),X.style.fill="var(--ion-color-medium)",J.style.textAlign="center",J.style.cursor="pointer",J.onclick=()=>{l.p5voidDraw.history_act(1)};let Q=V.insertCell(2);z.parent(Q),Q.style.textAlign="center",Q.style.cursor="pointer",Q.onclick=()=>{z.elt.click()};let q=V.insertCell(3);if(q.innerHTML='<ion-icon style="width: 27px; height: 27px" name="pencil"></ion-icon>',q.style.textAlign="center",q.style.cursor="pointer",q.onclick=()=>{l.change_line_weight()},e.SetCanvasViewportInit=()=>{A.hide(),e.resizeCanvas(_.clientWidth,_.clientHeight),Z.x=e.width/2,Z.y=e.height/2,f.x=0,f.y=0;let n=_.clientHeight-112;w=_.clientWidth/n<s.width/s.height?_.clientWidth/s.width:n/s.height,A.show(),k.position(e.width-k.width,e.height-k.height-y),e.redraw()},s=e.createGraphics(i.width,i.height,e.WEBGL),s.pixelDensity(1),s.noLoop(),s.noFill(),h=e.createGraphics(i.width,i.height,e.WEBGL),h.pixelDensity(1),h.noLoop(),h.noFill(),h.background(255),h.imageMode(e.CENTER),i.path){let n=yield l.indexed.loadBlobFromUserPath(i.path,""),I=URL.createObjectURL(n);e.loadImage(I,O=>{U=O,h.image(U,0,0),h.redraw(),URL.revokeObjectURL(I),e.SetCanvasViewportInit(),e.redraw()},O=>{console.error("\uadf8\ub9bc\ud310 \ubc30\uacbd \uc774\ubbf8\uc9c0 \ubd88\ub7ec\uc624\uae30 \uc624\ub958: ",O),h.redraw(),URL.revokeObjectURL(I)})}else h.redraw(),e.SetCanvasViewportInit(),e.redraw()});let f=e.createVector(),w=1,Z=e.createVector(0,0),b=e.createVector(),E=e.createVector(),c=e.createVector();e.draw=()=>{if(e.clear(255,255,255,255),e.push(),e.translate(Z),e.scale(w),e.translate(f),h&&e.image(h,0,0),s&&e.image(s,0,0),this.isCropMode)e.push(),e.translate(-s.width/2,-s.height/2),e.translate(E),e.noStroke(),e.fill(0,100),e.rect(0,0,c.x,c.y),e.stroke(255,0,0),e.strokeWeight(8),e.beginShape(e.LINES),e.vertex(0,0),e.vertex(c.x,0),e.vertex(c.x,0),e.vertex(c.x,.8*c.y),e.vertex(0,0),e.vertex(0,c.y),e.vertex(0,c.y),e.vertex(.8*c.x,c.y),e.stroke(255,255,0),e.vertex(.8*c.x,c.y),e.vertex(c.x,c.y),e.vertex(c.x,.8*c.y),e.vertex(c.x,c.y),e.endShape(),e.pop();else if(a&&a.pos&&a.pos.length){e.push(),e.translate(b),e.stroke(a.color),e.strokeWeight(a.weight),e.beginShape();for(let t=0,o=a.pos.length;t<o;t++)e.curveVertex(a.pos[t].x,a.pos[t].y);e.endShape(),e.pop()}e.pop()};let L=[],M=0,he=()=>{s.background(255,0);for(let t=0;t<M;t++)ie(s,L[t])},ie=(t,o=a)=>{t.push(),t.translate(b),t.stroke(o.color),t.strokeWeight(o.weight),t.beginShape();for(let r=0,v=o.pos.length;r<v;r++)t.curveVertex(o.pos[r].x,o.pos[r].y);t.endShape(),t.pop(),t.redraw(),e.redraw()};e.windowResized=()=>{setTimeout(()=>{e.SetCanvasViewportInit()},0)};let a={};const y=56;let oe,Y,re,le,ue,$,ae,se=0,j=!1,p=!1;e.mousePressed=t=>{if(e.mouseY<y||e.mouseY>e.height-y)p=!0;else switch(t.which){case 1:this.isCropMode?ge():we();break;case 3:Y=e.createVector(e.mouseX,e.mouseY),$=f.copy(),oe=e.createVector(e.mouseX,e.mouseY);break;case 2:e.SetCanvasViewportInit()}};let ge=(t,o)=>{let r=R(t,o),v=E.copy().add(c).sub(e.createVector(s.width/2,s.height/2)),V=r.dist(v),B=.2*e.max(s.width,s.height);j=V<B,j?(le=e.createVector(e.mouseX,e.mouseY),ae=c.copy()):re=e.createVector(e.mouseX,e.mouseY).sub(E.mult(w))},we=(t,o)=>{H.style.fill="var(--ion-color-dark)",X.style.fill="var(--ion-color-medium)";let r=R(t,o);r.sub(b);let v={x:r.x,y:r.y};a={pos:[],color:z.color(),weight:Number(k.value())},a.pos.push(v),a.pos.push(v),e.redraw()};e.mouseDragged=t=>{switch(t.which){case 1:if(this.isCropMode&&!p){let o=e.createVector(e.mouseX,e.mouseY);j?c=ae.copy().add(le.copy().sub(o).div(-w)):E=re.copy().sub(o).div(-w),e.redraw()}else{let o=R();o.sub(b),a&&a.pos&&a.pos.push({x:o.x,y:o.y}),e.redraw()}break;case 3:oe=e.createVector(e.mouseX,e.mouseY),f=$.copy().add(oe.sub(Y).div(w)),e.redraw()}},e.mouseWheel=t=>{e.mouseY<y||e.mouseY>e.height-y?p=!0:(Ce(R()),w*=t.deltaY<0?1.1:.9,e.redraw())},e.mouseReleased=t=>{if(1===t.which&&!this.isCropMode&&!p){let o=R();o.sub(b);let r={x:o.x,y:o.y};a&&(a.pos.push(r),a.pos.push(r)),me()}p=!1};let Ce=t=>{Z=e.createVector(e.mouseX,e.mouseY),f=t.mult(-1)},R=(t,o)=>{let r=e.createVector(t||e.mouseX,o||e.mouseY);return r.sub(Z),r.div(w),r.sub(f),r},m=[],N=!1;e.touchStarted=t=>{if(m=t.touches,t.changedTouches[0].clientY<y||t.changedTouches[0].clientY>e.height-y)p=!0;else switch(N=!0,m.length){case 1:this.isCropMode?ge(t.changedTouches[0].clientX,t.changedTouches[0].clientY-y):we(t.changedTouches[0].clientX,t.changedTouches[0].clientY-y);break;case 2:let o=e.createVector(m[0].clientX,m[0].clientY-56),r=e.createVector(m[1].clientX,m[1].clientY-56);se=o.dist(r),Y=o.copy().add(r).div(2),$=f.copy(),ue=w,a=void 0;break;default:N=!1,e.SetCanvasViewportInit()}},e.touchMoved=t=>{if(N){switch(m=t.touches,m.length){case 1:if(this.isCropMode&&!p){let o=e.createVector(t.changedTouches[0].clientX,t.changedTouches[0].clientY-y);j?c=ae.copy().add(le.copy().sub(o).div(-w)):E=re.copy().sub(o).div(-w),e.redraw()}else{let o=R(t.changedTouches[0].clientX,t.changedTouches[0].clientY-y);o.sub(b),a&&a.pos&&a.pos.push({x:o.x,y:o.y}),e.redraw()}break;case 2:{let o=e.createVector(m[0].clientX,m[0].clientY-56),r=e.createVector(m[1].clientX,m[1].clientY-56),v=o.copy().add(r).div(2);w=o.dist(r)/se*ue,f=$.copy().add(v.sub(Y).div(w)),e.redraw()}}return!1}},e.touchEnded=t=>{if(t.changedTouches){switch(m=t.touches,N=!1,m.length){case 0:if(!this.isCropMode&&!p&&a){let o=R(t.changedTouches[0].clientX,t.changedTouches[0].clientY-y);o.sub(b);let r={x:o.x,y:o.y};a.pos.push(r),a.pos.push(r),me()}break;case 1:if(!N)return;xe(),se=0,a=void 0}p=!1}};let xe=()=>{Y=e.createVector(m[0].clientX,m[0].clientY-56),$=f.copy()},me=()=>{L.length=M,a&&(L.push(a),ie(s,a)),M=L.length,Y=void 0,p=!1,a=void 0,e.redraw()}})}new_image(){this.alertCtrl.create({header:this.lang.text.voidDraw.newDraw,inputs:[{name:"width",type:"number",placeholder:`${this.lang.text.voidDraw.width} (${this.lang.text.voidDraw.default_size}: 432)`},{name:"height",type:"number",placeholder:`${this.lang.text.voidDraw.height} (${this.lang.text.voidDraw.default_size}: 432)`}],buttons:[{text:this.lang.text.voidDraw.CreateNew,handler:l=>{l.width=l.width?Number(l.width):432,l.height=l.height?Number(l.height):432,this.create_new_canvas(l)}}]}).then(l=>l.present())}change_line_weight(){this.p5voidDraw.set_line_weight()}open_crop_tool(){this.p5voidDraw.open_crop_tool()}dismiss_draw(){this.isCropMode?this.p5voidDraw.apply_crop():(this.mainLoading.present(),this.WithoutSave=!1,this.p5voidDraw.save_image())}ionViewWillLeave(){delete this.global.p5key.KeyShortCut.HistoryAct,delete this.global.p5key.KeyShortCut.AddAct,delete this.global.p5key.KeyShortCut.DeleteAct,delete this.global.p5key.KeyShortCut.SKeyAct,this.p5voidDraw&&this.p5voidDraw.remove()}ionViewDidLeave(){document.removeEventListener("ionBackButton",this.EventListenerAct),this.WithoutSave&&this.mainLoading.remove()}}return(K=ne).\u0275fac=function(i){return new(i||K)(u.Y36(_e.b),u.Y36(x.IN),u.Y36(x.Br),u.Y36(x.HT),u.Y36(ye.AN),u.Y36(x.X1),u.Y36(ve.H))},K.\u0275cmp=u.Xpm({type:K,selectors:[["app-void-draw"]],decls:8,vars:1,consts:[[1,"ion-no-border"],["slot","start",3,"click"],["defaultHref",""],["id","voidDraw",1,"full_screen",2,"display","flex","overflow","hidden"]],template:function(i,l){1&i&&(u.TgZ(0,"ion-header",0)(1,"ion-toolbar")(2,"ion-title"),u._uU(3),u.qZA(),u.TgZ(4,"ion-buttons",1),u.NdJ("click",function(){return l.modalCtrl.dismiss()}),u._UZ(5,"ion-back-button",2),u.qZA()()(),u.TgZ(6,"ion-content"),u._UZ(7,"div",3),u.qZA()),2&i&&(u.xp6(3),u.Oqu(l.lang.text.ChatRoom.voidDraw))},dependencies:[x.oU,x.Sm,x.W2,x.Gu,x.wd,x.sr,x.cs]}),ne})()}}]);