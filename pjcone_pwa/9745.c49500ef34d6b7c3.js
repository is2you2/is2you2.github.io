"use strict";(self.webpackChunkapp=self.webpackChunkapp||[]).push([[9745],{9745:(q,B,p)=>{p.d(B,{B:()=>ke});var l=p(5861),F=p(6845),v=p(9868),L=p(8049),R=p(9761),t=p(9468),h=p(1325),Y=p(797),W=p(3857),C=p(2372),O=p(9376),x=p(6052),b=p(9080),k=p(4663),D=p(4093),Z=p(6814),U=p(95);const Q=["ShowContentInfoIonic"];function G(a,d){if(1&a){const i=t.EpF();t.TgZ(0,"ion-icon",20),t.NdJ("click",function(){t.CHM(i);const n=t.oxw();return t.KtG(n.ChangeToAnother(-1))}),t.qZA()}}function j(a,d){if(1&a&&(t.TgZ(0,"ion-label",21),t._uU(1),t.qZA()),2&a){const i=t.oxw();t.xp6(1),t.Oqu(i.RelevanceIndex+" / "+i.Relevances.length)}}function z(a,d){if(1&a){const i=t.EpF();t.TgZ(0,"ion-icon",22),t.NdJ("click",function(){t.CHM(i);const n=t.oxw();return t.KtG(n.ChangeToAnother(1))}),t.qZA()}}function X(a,d){if(1&a&&(t.TgZ(0,"ion-label",23),t._uU(1),t.qZA()),2&a){const i=t.oxw();t.xp6(1),t.Oqu(i.FileInfo.filename)}}function ee(a,d){if(1&a){const i=t.EpF();t.TgZ(0,"ion-input",24),t.NdJ("ngModelChange",function(n){t.CHM(i);const r=t.oxw();return t.KtG(r.NewTextFileName=n)}),t.qZA()}if(2&a){const i=t.oxw();t.Q6J("ngModel",i.NewTextFileName)("placeholder",i.FileInfo.filename)}}function te(a,d){if(1&a){const i=t.EpF();t.TgZ(0,"ion-button",25),t.NdJ("click",function(){t.CHM(i);const n=t.oxw();return t.KtG(n.close_text_edit())}),t._UZ(1,"ion-icon",26),t.qZA()}}function ne(a,d){if(1&a){const i=t.EpF();t.TgZ(0,"ion-button",25),t.NdJ("click",function(){t.CHM(i);const n=t.oxw();return t.KtG(n.SaveText())}),t._UZ(1,"ion-icon",27),t.qZA()}}function ie(a,d){if(1&a){const i=t.EpF();t.TgZ(0,"ion-button",28),t.NdJ("click",function(){t.CHM(i);const n=t.oxw();return t.KtG(n.DownloadAllListFiles())}),t._UZ(1,"ion-icon",29),t.qZA()}if(2&a){const i=t.oxw();t.Q6J("disabled",i.isDownloading||i.MessageInfo.content.transfer_index&&"download"==i.MessageInfo.content.transfer_index.OnTransfer)}}function ae(a,d){1&a&&(t.TgZ(0,"ion-button",30),t._UZ(1,"ion-icon",31),t.qZA())}function oe(a,d){if(1&a){const i=t.EpF();t.TgZ(0,"ion-item",34),t.NdJ("click",function(){t.CHM(i);const n=t.oxw(3);return t.KtG(n.open_text_editor())}),t.TgZ(1,"ion-label"),t._uU(2),t.qZA()()}if(2&a){const i=t.oxw(3);t.xp6(2),t.Oqu(i.lang.text.ContentViewer.EditText)}}function le(a,d){if(1&a){const i=t.EpF();t.TgZ(0,"ion-item",34),t.NdJ("click",function(){t.CHM(i);const n=t.oxw(3);return t.KtG(n.modify_image())}),t.TgZ(1,"ion-label"),t._uU(2),t.qZA()()}if(2&a){const i=t.oxw(3);t.xp6(2),t.Oqu(i.lang.text.ContentViewer.Edit)}}function se(a,d){if(1&a){const i=t.EpF();t.TgZ(0,"ion-item",34),t.NdJ("click",function(){t.CHM(i);const n=t.oxw(3);return t.KtG(n.open_bottom_modal())}),t.TgZ(1,"ion-label"),t._uU(2),t.qZA()()}if(2&a){const i=t.oxw(3);t.xp6(2),t.Oqu(i.lang.text.ContentViewer.ContentInfo)}}function re(a,d){if(1&a){const i=t.EpF();t.TgZ(0,"ion-item",34),t.NdJ("click",function(){t.CHM(i);const n=t.oxw(3);return t.KtG(n.ShareContent())}),t.TgZ(1,"ion-label"),t._uU(2),t.qZA()()}if(2&a){const i=t.oxw(3);t.xp6(2),t.Oqu(i.lang.text.ContentViewer.ShareContent)}}function ce(a,d){if(1&a){const i=t.EpF();t.TgZ(0,"ion-item",34),t.NdJ("click",function(){t.CHM(i);const n=t.oxw(3);return t.KtG(n.download_file())}),t.TgZ(1,"ion-label"),t._uU(2),t.qZA()()}if(2&a){const i=t.oxw(3);t.xp6(2),t.Oqu(i.lang.text.ContentViewer.Download)}}function _e(a,d){if(1&a){const i=t.EpF();t.TgZ(0,"ion-item",34),t.NdJ("click",function(){t.CHM(i);const n=t.oxw(3);return t.KtG(n.RemoveFile())}),t.TgZ(1,"ion-label"),t._uU(2),t.qZA()()}if(2&a){const i=t.oxw(3);t.xp6(2),t.Oqu(i.lang.text.ContentViewer.RemoveFile)}}function de(a,d){if(1&a&&(t.TgZ(0,"ion-content")(1,"ion-list"),t.YNc(2,oe,3,1,"ion-item",33),t.YNc(3,le,3,1,"ion-item",33),t.YNc(4,se,3,1,"ion-item",33),t.YNc(5,re,3,1,"ion-item",33),t.YNc(6,ce,3,1,"ion-item",33),t.YNc(7,_e,3,1,"ion-item",33),t.qZA()()),2&a){const i=t.oxw(2);t.xp6(2),t.Q6J("ngIf",!i.NeedDownloadFile&&"text"==i.FileInfo.viewer&&!i.HasNoEditButton),t.xp6(1),t.Q6J("ngIf",!i.NeedDownloadFile&&"audio"!=i.FileInfo.viewer&&!i.HasNoEditButton),t.xp6(1),t.Q6J("ngIf",i.FileInfo.content_creator),t.xp6(1),t.Q6J("ngIf",!i.NeedDownloadFile),t.xp6(1),t.Q6J("ngIf",!i.NeedDownloadFile&&!i.FileInfo.url),t.xp6(1),t.Q6J("ngIf",!i.NeedDownloadFile&&i.OpenInChannelChat)}}function ge(a,d){1&a&&(t.TgZ(0,"ion-popover",32),t.YNc(1,de,8,6,"ng-template"),t.qZA())}function fe(a,d){1&a&&t._UZ(0,"div",37)}function he(a,d){1&a&&t._UZ(0,"div",38)}function me(a,d){if(1&a&&(t.TgZ(0,"td"),t.YNc(1,fe,1,0,"div",35),t.YNc(2,he,1,0,"div",36),t.qZA()),2&a){const i=t.oxw();t.xp6(1),t.Q6J("ngIf","pck"!=i.FileInfo.file_ext),t.xp6(1),t.Q6J("ngIf","pck"==i.FileInfo.file_ext)}}function pe(a,d){if(1&a){const i=t.EpF();t.TgZ(0,"td")(1,"ion-grid")(2,"ion-row",39)(3,"ion-col",40)(4,"ion-button",41),t.NdJ("click",function(){t.CHM(i);const n=t.oxw();return t.KtG(n.DownloadCurrentFile())}),t._uU(5),t.qZA()()()()()}if(2&a){const i=t.oxw();t.xp6(4),t.Q6J("disabled",i.isDownloading||i.MessageInfo.content.transfer_index&&"download"==i.MessageInfo.content.transfer_index.OnTransfer),t.xp6(1),t.hij(" ",i.MessageInfo.content.transfer_index&&"download"==i.MessageInfo.content.transfer_index.OnTransfer?i.lang.text.ContentViewer.FileDownloading:i.lang.text.ContentViewer.DownloadThisFile," ")}}function ue(a,d){if(1&a){const i=t.EpF();t.TgZ(0,"ion-item",34),t.NdJ("click",function(){t.CHM(i);const n=t.oxw(2);return t.KtG(n.copy_url(n.FileInfo.url))}),t.TgZ(1,"ion-label"),t._uU(2),t.qZA(),t.TgZ(3,"ion-label",42),t._uU(4),t.qZA()()}if(2&a){const i=t.oxw(2);t.xp6(2),t.Oqu(i.lang.text.ContentInfo.SourceFrom),t.xp6(2),t.Oqu(i.content_creator.various_display)}}function xe(a,d){if(1&a&&(t.TgZ(0,"ion-item")(1,"ion-label"),t._uU(2),t.qZA(),t.TgZ(3,"ion-label",42),t._uU(4),t.qZA()()),2&a){const i=t.oxw(2);t.xp6(2),t.Oqu(i.lang.text.ContentInfo.FileSize),t.xp6(2),t.Oqu(i.CurrentFileSize)}}function ve(a,d){1&a&&t._UZ(0,"ion-icon",52)}function Ie(a,d){1&a&&t._UZ(0,"ion-icon",53)}function we(a,d){1&a&&t._UZ(0,"ion-icon",54)}function be(a,d){1&a&&t._UZ(0,"ion-icon",55)}function Te(a,d){1&a&&t._UZ(0,"ion-icon",56)}function Ce(a,d){1&a&&(t.TgZ(0,"ion-avatar"),t._UZ(1,"img",57),t.qZA())}function ye(a,d){if(1&a){const i=t.EpF();t.TgZ(0,"div")(1,"div",45),t._uU(2),t.TgZ(3,"ion-chip",46),t.NdJ("click",function(){const r=t.CHM(i).$implicit,c=t.oxw(2);return t.KtG(c.copy_url(r.user_id))}),t.YNc(4,ve,1,0,"ion-icon",47),t.YNc(5,Ie,1,0,"ion-icon",48),t.YNc(6,we,1,0,"ion-icon",49),t.YNc(7,be,1,0,"ion-icon",50),t.YNc(8,Te,1,0,"ion-icon",51),t.YNc(9,Ce,2,0,"ion-avatar",17),t.TgZ(10,"ion-label"),t._uU(11),t.qZA()()()()}if(2&a){const i=d.$implicit,e=t.oxw(2);t.xp6(2),t.hij(" ",i.timeDisplay," "),t.xp6(2),t.Q6J("ngIf","loaded"==i.various),t.xp6(1),t.Q6J("ngIf","camera"==i.various),t.xp6(1),t.Q6J("ngIf","link"==i.various),t.xp6(1),t.Q6J("ngIf","long_text"==i.various),t.xp6(1),t.Q6J("ngIf","textedit"==i.various),t.xp6(1),t.Q6J("ngIf","voidDraw"==i.various),t.xp6(2),t.Oqu(i.publisher||i.display_name||e.lang.text.Profile.noname_user)}}function Pe(a,d){if(1&a){const i=t.EpF();t.TgZ(0,"ion-content")(1,"ion-item-divider")(2,"ion-label"),t._uU(3),t.qZA()(),t.TgZ(4,"ion-item",34),t.NdJ("click",function(){t.CHM(i);const n=t.oxw();return t.KtG(n.copy_url(n.content_creator.user_id))}),t.TgZ(5,"ion-label"),t._uU(6),t.qZA(),t.TgZ(7,"ion-label",42),t._uU(8),t.qZA()(),t.YNc(9,ue,5,2,"ion-item",33),t.YNc(10,xe,5,2,"ion-item",17),t.TgZ(11,"ion-item")(12,"ion-label"),t._uU(13),t.qZA(),t.TgZ(14,"ion-label",42),t._uU(15),t.qZA()(),t.TgZ(16,"ion-item-divider")(17,"ion-label"),t._uU(18),t.qZA()(),t.YNc(19,ye,12,8,"div",43),t.TgZ(20,"ion-item",34),t.NdJ("click",function(){t.CHM(i),t.oxw();const n=t.MAs(25);return t.KtG(n.dismiss())}),t.TgZ(21,"ion-label",44),t._uU(22),t.qZA()()()}if(2&a){const i=t.oxw();t.xp6(3),t.Oqu(i.lang.text.ContentInfo.WorkLogs),t.xp6(3),t.Oqu(i.lang.text.ContentInfo.LastPost),t.xp6(2),t.hij(" ",i.content_creator.publisher||i.content_creator.display_name||i.lang.text.Profile.noname_user,""),t.xp6(1),t.Q6J("ngIf",i.content_creator.various),t.xp6(1),t.Q6J("ngIf",!i.FileInfo.url),t.xp6(3),t.Oqu(i.lang.text.ContentInfo.TimeAt),t.xp6(2),t.Oqu(i.content_creator.timeDisplay),t.xp6(3),t.Oqu(i.lang.text.ContentInfo.WorkHistory),t.xp6(1),t.Q6J("ngForOf",i.content_related_creator),t.xp6(3),t.Oqu(i.lang.text.ContentInfo.CloseModal)}}const Fe=function(){return[.5,1]};let ke=(()=>{var a;class d{constructor(e,n,r,c,_,o,s,f,I,w,m,y){this.modalCtrl=e,this.navParams=n,this.indexed=r,this.lang=c,this.file=_,this.p5toast=o,this.alertCtrl=s,this.loadingCtrl=f,this.global=I,this.nakama=w,this.mClipboard=m,this.noti=y,this.useP5Navigator=!0,this.RelevanceIndex=0,this.HaveRelevances=!1,this.NeedDownloadFile=!1,this.isDownloading=!1,this.OpenInChannelChat=!1,this.isChannelOnline=!0,this.EventListenerAct=E=>{E.detail.register(120,J=>{})},this.isTextEditMode=!1,this.NewTextFileName="",this.image_info={},this.forceWrite=!1}ngOnInit(){var e=this;return(0,l.Z)(function*(){e.MessageInfo=e.navParams.get("info"),e.OpenInChannelChat=void 0!==e.MessageInfo.code,e.CurrentViewId=e.MessageInfo.message_id,e.FileInfo=e.MessageInfo.content,e.ContentBox=document.getElementById("ContentBox"),e.FileHeader=document.getElementById("FileHeader"),e.isOfficial=e.navParams.get("isOfficial"),e.target=e.navParams.get("target");try{e.isChannelOnline="online"==e.nakama.channels_orig[e.isOfficial][e.target][e.MessageInfo.channel_id].info.status,e.isChannelOnline=e.isChannelOnline||"online"==e.nakama.channels_orig[e.isOfficial][e.target][e.MessageInfo.channel_id].status||"pending"==e.nakama.channels_orig[e.isOfficial][e.target][e.MessageInfo.channel_id].status}catch{}if("text"===(e.targetDB=e.navParams.get("targetDB"),e.HasNoEditButton=e.navParams.get("no_edit")||!1,e.FileInfo.is_new));else{if(e.Relevances=e.navParams.get("relevance"),e.Relevances){for(let n=0,r=e.Relevances.length;n<r;n++)if(e.Relevances[n].message_id&&e.MessageInfo.message_id){if(e.Relevances[n].message_id==e.MessageInfo.message_id){e.RelevanceIndex=n+1;break}}else if(e.Relevances[n].content.path==e.MessageInfo.content.path){e.RelevanceIndex=n+1;break}e.HaveRelevances=e.Relevances.length>1}else e.HaveRelevances=!1;e.CreateContentInfo()}})()}reinit_content_data(e){var n=this;return(0,l.Z)(function*(){if(n.NewTextFileName="",n.NeedDownloadFile=!0,n.isTextEditMode=!1,n.MessageInfo=e,n.CurrentViewId=n.MessageInfo.message_id,n.FileInfo=n.MessageInfo.content,URL.revokeObjectURL(n.FileURL),n.FileInfo.url)n.FileURL=n.FileInfo.url,n.CreateContentInfo(),n.NeedDownloadFile=!1,n.ionViewDidEnter();else{let r=n.FileInfo.path||`servers/${n.isOfficial}/${n.target}/channels/${e.channel_id}/files/msg_${e.message_id}.${e.content.file_ext}`;n.image_info.path=r,n.NeedDownloadFile=yield n.indexed.checkIfFileExist(`${r}.history`,void 0,n.targetDB);try{n.blob=yield n.indexed.loadBlobFromUserPath(r,n.FileInfo.type,void 0,n.targetDB),n.CreateContentInfo(),n.ionViewDidEnter()}catch{n.FileURL=void 0,n.blob=void 0,n.isDownloading=!1,n.NeedDownloadFile=!0,n.CreateContentInfo(),n.p5canvas&&n.p5canvas.remove(),n.p5canvas=new v(_=>{_.setup=()=>{_.noCanvas()}}),n.ChangeContentWithKeyInput()}}})()}DownloadAllListFiles(){this.alertCtrl.create({header:this.lang.text.ContentViewer.DownloadAllFiles,message:this.lang.text.ContentViewer.DownloadLoadedList,buttons:[{text:this.lang.text.ContentViewer.DownloadThisFile,handler:()=>{this.DownloadInOrder()}}]}).then(e=>e.present())}DownloadInOrder(){var e=this;return(0,l.Z)(function*(){("Android"==F.n$||"iOS"==F.n$)&&e.noti.noti.schedule({id:6,title:e.lang.text.ContentViewer.DownloadThisFile,progressBar:{indeterminate:!0},sound:null,smallIcon:"res://diychat",color:"b0b0b0"});for(let n=0,r=e.Relevances.length;n<r;n++)e.nakama.OnTransfer[e.isOfficial]||(e.nakama.OnTransfer[e.isOfficial]={}),e.nakama.OnTransfer[e.isOfficial][e.target]||(e.nakama.OnTransfer[e.isOfficial][e.target]={}),e.nakama.OnTransfer[e.isOfficial][e.target][e.Relevances[n].channel_id]||(e.nakama.OnTransfer[e.isOfficial][e.target][e.Relevances[n].channel_id]={}),e.nakama.OnTransfer[e.isOfficial][e.target][e.Relevances[n].channel_id][e.Relevances[n].message_id]||(e.nakama.OnTransfer[e.isOfficial][e.target][e.Relevances[n].channel_id][e.Relevances[n].message_id]={});for(let n=0,r=e.Relevances.length;n<r;n++){("Android"==F.n$||"iOS"==F.n$)&&e.noti.noti.schedule({id:6,title:`${e.lang.text.ContentViewer.DownloadThisFile}: ${r-n}`,progressBar:{value:n,maxValue:r},sound:null,smallIcon:"res://diychat",color:"b0b0b0"});let c=`servers/${e.isOfficial}/${e.target}/channels/${e.Relevances[n].channel_id}/files/msg_${e.Relevances[n].message_id}.${e.Relevances[n].content.file_ext}`;if(!(yield e.indexed.checkIfFileExist(c,void 0,e.targetDB)))try{yield e.DownloadCurrentFile(n)}catch(o){console.log(o)}}e.noti.ClearNoti(6)})()}ChangeToAnother(e){let n=this.RelevanceIndex+e;n<=0||n>this.Relevances.length||(this.p5canvas&&this.p5canvas.remove(),this.RelevanceIndex=n,this.FileInfo={file_ext:""},setTimeout(()=>{this.reinit_content_data(this.Relevances[this.RelevanceIndex-1])},70))}DownloadCurrentFile(e){var n=this;return(0,l.Z)(function*(){n.isDownloading=!0;let r=0,c=n.Relevances[null!=e?e:n.RelevanceIndex-1],_=`servers/${n.isOfficial}/${n.target}/channels/${c.channel_id}/files/msg_${c.message_id}.${c.content.file_ext}`;try{let s=yield n.indexed.loadTextFromUserPath(`${_}.history`,void 0,n.targetDB);r=JSON.parse(s).index}catch{}let o=c.message_id;yield n.nakama.ReadStorage_From_channel(c,_,n.isOfficial,n.target,r),n.CurrentViewId==o&&n.reinit_content_data(c)})()}formatBytes(e,n=2){if(!+e)return"0 Bytes";const c=n<0?0:n,o=Math.floor(Math.log(e)/Math.log(1024));return`${parseFloat((e/Math.pow(1024,o)).toFixed(c))} ${["Bytes","KiB","MiB","GiB","TiB","PiB","EiB","ZiB","YiB"][o]}`}CreateContentInfo(){try{if(this.CurrentFileSize=this.formatBytes(this.FileInfo.size||this.FileInfo.filesize),this.content_creator=this.FileInfo.content_creator,this.content_creator.timeDisplay=new Date(this.content_creator.timestamp).toLocaleString(),this.content_related_creator=this.FileInfo.content_related_creator,this.content_creator.user_id)try{this.content_creator.is_me=this.nakama.servers[this.isOfficial][this.target].session.user_id==this.content_creator.user_id}catch{}try{this.content_creator.publisher=this.content_creator.is_me?this.nakama.users.self.display_name:this.nakama.users[this.isOfficial][this.target][this.content_creator.user_id].display_name}catch{}this.set_various_display(this.content_creator);for(let e=0,n=this.content_related_creator.length;e<n;e++){if(this.content_related_creator[e].user_id)try{this.content_related_creator[e].is_me=this.nakama.servers[this.isOfficial][this.target].session.user_id==this.content_related_creator[e].user_id}catch{}this.content_related_creator[e].timeDisplay=new Date(this.content_related_creator[e].timestamp).toLocaleString()}}catch{}try{this.content_related_creator[0].publisher=this.content_related_creator[0].is_me?this.nakama.users.self.display_name:this.nakama.users[this.isOfficial][this.target][this.content_related_creator[0].user_id].display_name,this.content_related_creator[0].timestamp==this.content_related_creator[1].timestamp&&(this.content_related_creator[0].publisher=this.content_related_creator[1].is_me?this.nakama.users.self.display_name:this.nakama.users[this.isOfficial][this.target][this.content_related_creator[1].user_id].display_name,this.content_related_creator.splice(1,1))}catch{try{this.content_related_creator[0].publisher=this.content_related_creator[1].display_name,this.content_related_creator[0].timestamp==this.content_related_creator[1].timestamp&&(this.content_related_creator[0].publisher=this.content_related_creator[1].display_name,this.content_related_creator.splice(1,1))}catch{}try{this.content_related_creator[0].publisher||(this.content_related_creator[0].publisher=this.content_related_creator[0].display_name)}catch{}}try{this.content_related_creator.sort((e,n)=>e.timestamp>n.timestamp?-1:e.timestamp<n.timestamp?1:0)}catch{}}set_various_display(e){switch(e.various_display=this.lang.text.GlobalAct.UnknownSource,e.various){case"camera":e.various_display=this.lang.text.GlobalAct.FromCamera;break;case"link":e.various_display=this.FileInfo.url;break;case"loaded":e.various_display=this.lang.text.GlobalAct.variousCreator;break;case"voidDraw":e.various_display=this.lang.text.GlobalAct.FromVoidDraw;break;case"long_text":e.various_display=this.lang.text.GlobalAct.FromAutoLongText;break;case"textedit":e.various_display=this.lang.text.GlobalAct.FromTextEditor}}close_text_edit(){this.FileInfo.is_new?this.modalCtrl.dismiss():this.reinit_content_data(this.MessageInfo)}ionViewDidEnter(){var e=this;return(0,l.Z)(function*(){e.FileInfo.url?e.FileURL=e.FileInfo.url:e.FileInfo.is_new||(e.blob||(e.blob=yield e.indexed.loadBlobFromUserPath(e.FileInfo.path||e.navParams.get("path"),e.FileInfo.type,void 0,e.targetDB)),e.FileURL=URL.createObjectURL(e.blob)),e.forceWrite=!1;let n=document.getElementById("content_viewer_canvas");switch(n&&(n.style.backgroundImage=""),document.removeEventListener("ionBackButton",e.EventListenerAct),e.p5canvas&&e.p5canvas.remove(),e.FileInfo.viewer){case"image":e.p5canvas=new v(o=>{o.setup=(0,l.Z)(function*(){n.style.maxWidth="100%",n.style.overflow="hidden",e.ContentBox.style.overflow="hidden",o.noCanvas();let g=o.createElement("img");g.elt.hidden=!0,g.elt.src=e.FileURL,g.elt.onload=()=>{n.style.backgroundImage=`url(${e.FileURL})`,n.style.backgroundRepeat="no-repeat",n.style.pointerEvents="none",e.image_info.width=g.elt.naturalWidth,e.image_info.height=g.elt.naturalHeight,f=o.createVector(g.elt.naturalWidth,g.elt.naturalHeight),s(),g.remove()},o.noLoop()});let s=()=>{if(e.image_info.width/e.image_info.height<n.clientWidth/n.clientHeight){let g=e.image_info.width*n.clientHeight/e.image_info.height;n.style.backgroundSize=`${g}px`,n.style.backgroundPositionX=(n.clientWidth-g)/2+"px",n.style.backgroundPositionY="0px"}else n.style.backgroundSize=`${n.clientWidth}px`,n.style.backgroundPositionX="0px",n.style.backgroundPositionY=n.clientHeight/2-f.y*(n.clientWidth/f.x)/2+"px";V=!0};o.windowResized=()=>{setTimeout(()=>{s()},50)};let f,I=o.createVector(),w=o.createVector(),m=o.createVector(),y=1,E=()=>{n.style.backgroundPositionX=`${I.x+m.x}px`,n.style.backgroundPositionY=`${I.y+m.y}px`},J=(g,M)=>{let u=y,P=y*M,A=Number(n.style.backgroundPositionX.split("px")[0]),H=Number(n.style.backgroundPositionY.split("px")[0]),Oe=(u-P)*o.map(g.x,A,A+u,0,1),De=(u-P)/f.x*f.y*o.map(g.y,H,H+u/f.x*f.y,0,1);n.style.backgroundPositionX=`${A+Oe}px`,n.style.backgroundPositionY=`${H+De}px`,n.style.backgroundSize=`${P}px`};o.mousePressed=()=>{e.useP5Navigator&&(o.mouseButton==o.CENTER&&s(),"DesktopPWA"==F.n$&&(I=o.createVector(Number(n.style.backgroundPositionX.split("px")[0]),Number(n.style.backgroundPositionY.split("px")[0])),w=o.createVector(o.mouseX,o.mouseY)))},o.mouseWheel=g=>{e.useP5Navigator&&(y=Number(n.style.backgroundSize.split("px")[0]),J(o.createVector(n.clientWidth/2,n.clientHeight/2),1-g.delta/1e3))},o.mouseDragged=()=>{e.useP5Navigator&&"DesktopPWA"==F.n$&&(m=o.createVector(o.mouseX,o.mouseY),m.sub(w),E())};let $,T={},N=!1,V=!0;o.touchStarted=g=>{if(e.useP5Navigator){for(let u=0,P=g.changedTouches.length;u<P;u++)T[g.changedTouches[u].identifier]=o.createVector(g.changedTouches[u].clientX,g.changedTouches[u].clientY);switch(Object.keys(T).length){case 1:I=o.createVector(Number(n.style.backgroundPositionX.split("px")[0]),Number(n.style.backgroundPositionY.split("px")[0])),w=T[g.changedTouches[0].identifier].copy();break;case 2:I=o.createVector(Number(n.style.backgroundPositionX.split("px")[0]),Number(n.style.backgroundPositionY.split("px")[0]));let u=T[0].copy();$=u.dist(T[1]),w=u.add(T[1]).div(2).copy(),y=Number(n.style.backgroundSize.split("px")[0]),E();break;default:N=!0,s()}}},o.touchMoved=g=>{if(e.useP5Navigator&&!N){for(let u=0,P=g.changedTouches.length;u<P;u++)T[g.changedTouches[u].identifier]=o.createVector(g.changedTouches[u].clientX,g.changedTouches[u].clientY);switch(Object.keys(T).length){case 1:m=T[g.changedTouches[0].identifier].copy(),m.sub(w),V||E();break;case 2:V=!1;let u=T[0].copy(),P=u.dist(T[1]);m=u.add(T[1]).div(2).copy();let A=m.copy();m.sub(w),E(),J(A,P/$)}}},o.touchEnded=g=>{if(e.useP5Navigator&&"changedTouches"in g){for(let u=0,P=g.changedTouches.length;u<P;u++)delete T[g.changedTouches[u].identifier];switch(Object.keys(T).length){case 1:I=o.createVector(Number(n.style.backgroundPositionX.split("px")[0]),Number(n.style.backgroundPositionY.split("px")[0])),w=T[Object.keys(T)[0]].copy();break;case 0:V&&!N&&(m.x>50?e.ChangeToAnother(-1):m.x<-50&&e.ChangeToAnother(1)),N=!1}}}});break;case"audio":e.p5canvas=new v(o=>{var s;o.setup=()=>{o.noCanvas(),o.noLoop(),s=o.createAudio([e.FileURL],()=>{n.appendChild(s.elt),s.elt.hidden=!0,setTimeout(()=>{f(),s.elt.hidden=!1},50),s.showControls(),s.play()})};let f=()=>{let I=e.ContentBox.offsetWidth;s.elt.setAttribute("style","position: relative; top: 50%; left: 50%; transform: translateX(-50%) translateY(-50%);"),s.size(I,25)};o.windowResized=()=>{setTimeout(()=>{f()},50)}});break;case"video":e.p5canvas=new v(o=>{var s;o.setup=()=>{o.noCanvas(),o.noLoop(),s=o.createVideo([e.FileURL],()=>{n.appendChild(s.elt),s.elt.hidden=!0,setTimeout(()=>{e.image_info.width=s.elt.videoWidth,e.image_info.height=s.elt.videoHeight,f(),s.elt.hidden=!1},50),s.showControls(),s.play()}),o.VideoMedia=s};let f=()=>{let I=e.ContentBox.offsetWidth,w=e.ContentBox.offsetHeight-e.FileHeader.offsetHeight,m=s.width,y=s.height;s.elt.setAttribute("style","position: relative; top: 50%; left: 50%; transform: translateX(-50%) translateY(-50%);"),m<y?(y=w,m=m/s.height*y):(m=I,y=y/s.width*m||w/2),s.size(m,y)};o.windowResized=()=>{setTimeout(()=>{f()},50)}});break;case"text":e.p5canvas=new v(o=>{o.setup=()=>{o.noCanvas(),o.noLoop();let s=o.createElement("textarea");s.elt.disabled=!0,s.elt.className="infobox",s.elt.setAttribute("style","height: 100%; display: block;"),s.elt.textContent="",n.appendChild(s.elt),o.TextArea=s.elt,e.FileInfo.is_new?e.open_text_editor(s.elt):o.loadStrings(e.FileURL,f=>{s.elt.textContent=f.join("\n")},f=>{n.textContent=e.lang.text.ContentViewer.CannotOpenText,e.FileInfo.else=!0})}});break;case"godot":document.addEventListener("ionBackButton",e.EventListenerAct);let r,c=e.MessageInfo.message_id;try{let o=yield e.indexed.loadBlobFromUserPath((e.FileInfo.path||e.navParams.get("path"))+"_thumbnail.png","",void 0,e.targetDB);r=URL.createObjectURL(o)}catch{}!e.NeedDownloadFile&&e.CurrentViewId==c&&setTimeout((0,l.Z)(function*(){let o=!1;if(e.indexed.godotDB)try{let s=yield e.indexed.loadBlobFromUserPath(e.FileInfo.path||e.navParams.get("path"),"",void 0,e.indexed.ionicDB);yield e.indexed.GetGodotIndexedDB(),yield e.indexed.saveBlobToUserPath(s,"tmp_files/duplicate/viewer.pck",void 0,e.indexed.godotDB),o=!0}catch(s){console.log("\ub0b4\ubd80 \ud30c\uc77c \uc5c6\uc74c: ",s)}if(yield e.global.CreateGodotIFrame("content_viewer_canvas",{path:"tmp_files/duplicate/viewer.pck",alt_path:e.FileInfo.path||e.navParams.get("path"),ext:e.FileInfo.file_ext,url:e.FileInfo.url,background:r,receive_image:(s=(0,l.Z)(function*(f,I,w){let m="tmp_files/modify_image.png";yield e.indexed.saveBase64ToUserPath(","+f,m),e.modalCtrl.dismiss({type:"image",path:m,width:I,height:w,msg:e.MessageInfo,index:e.RelevanceIndex-1})}),function(I,w,m){return s.apply(this,arguments)})},"start_load_pck"),!o){try{let s=yield e.indexed.loadBlobFromUserPath(e.FileInfo.path||e.navParams.get("path"),"",void 0,e.indexed.ionicDB);yield e.indexed.GetGodotIndexedDB(),yield e.indexed.saveBlobToUserPath(s,"tmp_files/duplicate/viewer.pck",void 0,e.indexed.godotDB)}catch(s){console.log("\ub0b4\ubd80 \ud30c\uc77c \uc5c6\uc74c_dp: ",s)}yield e.global.CreateGodotIFrame("content_viewer_canvas",{path:"tmp_files/duplicate/viewer.pck",alt_path:e.FileInfo.path||e.navParams.get("path"),ext:e.FileInfo.file_ext,url:e.FileInfo.url,background:r,receive_image:function(){var s=(0,l.Z)(function*(f,I,w){let m="tmp_files/modify_image.png";yield e.indexed.saveBase64ToUserPath(","+f,m),e.modalCtrl.dismiss({type:"image",path:m,width:I,height:w,msg:e.MessageInfo,index:e.RelevanceIndex-1})});return function(I,w,m){return s.apply(this,arguments)}}()},"start_load_pck")}var s;r&&URL.revokeObjectURL(r),e.FileInfo.url?e.global.godot_window.download_url():e.global.godot_window.start_load_pck()}),100);break;case"disabled":e.p5canvas=new v(o=>{o.setup=()=>{o.noCanvas()}});let _=yield e.loadingCtrl.create({message:e.lang.text.TodoDetail.WIP});_.present(),_.dismiss(),e.download_file()}e.ChangeContentWithKeyInput()})()}ChangeContentWithKeyInput(){this.p5canvas&&(this.p5canvas.keyPressed=e=>{switch(e.code){case"KeyA":case"ArrowLeft":this.ChangeToAnother(-1);break;case"KeyD":case"ArrowRight":this.ChangeToAnother(1);break;case"KeyS":this.NeedDownloadFile&&this.DownloadCurrentFile()}})}open_bottom_modal(){this.ShowContentInfoIonic.onDidDismiss().then(e=>{this.useP5Navigator=!0}),this.useP5Navigator=!1,this.ShowContentInfoIonic.present()}open_text_editor(e=this.p5canvas.TextArea){e.disabled=!1,setTimeout(()=>{this.isTextEditMode=!0,e.focus()},500)}SaveText(){var e=this;return(0,l.Z)(function*(){let n=new Blob([e.p5canvas.TextArea.value],{type:e.FileInfo.type});if(n.name=e.NewTextFileName||e.FileInfo.filename,e.OpenInChannelChat)e.modalCtrl.dismiss({type:"text",blob:n,contentRelated:e.FileInfo.content_related_creator});else{let r=yield e.loadingCtrl.create({message:e.lang.text.TodoDetail.WIP});r.present();let c=`tmp_files/texteditor/${e.FileInfo.filename}`;console.log(e.FileInfo),e.FileInfo.path||(e.FileInfo.path=c),yield e.indexed.saveBlobToUserPath(n,c,void 0,e.targetDB),r.dismiss(),e.p5toast.show({text:e.lang.text.ContentViewer.fileSaved}),e.modalCtrl.dismiss({type:"text",blob:n,path:c,index:e.RelevanceIndex-1})}})()}modify_image(){var e=this;return(0,l.Z)(function*(){switch(e.FileInfo.viewer){case"image":{let c=yield e.loadingCtrl.create({message:e.lang.text.TodoDetail.WIP});c.present();try{let _;e.image_info.path=e.FileInfo.path||e.navParams.get("path"),e.FileInfo.url&&(e.image_info.path="tmp_files/modify_image.png",_=yield fetch(e.FileInfo.url).then(o=>o.blob()),yield e.indexed.saveBlobToUserPath(_,e.image_info.path)),e.modalCtrl.dismiss({type:"image",...e.image_info,path:e.image_info.path,msg:e.MessageInfo,index:e.RelevanceIndex-1})}catch(_){e.p5toast.show({text:`${e.lang.text.ContentViewer.CannotEditFile}: ${_}`})}c.dismiss()}break;case"text":let n=yield e.loadingCtrl.create({message:e.lang.text.TodoDetail.WIP});n.present(),e.image_info.width=e.p5canvas.TextArea.clientWidth,e.image_info.height=e.p5canvas.TextArea.scrollHeight,e.p5canvas.pixelDensity(1),e.p5canvas.createCanvas(e.image_info.width,e.image_info.height),e.p5canvas.textSize(16),e.p5canvas.textWrap(e.p5canvas.WORD);let r=.05*e.p5canvas.width;e.p5canvas.text(e.p5canvas.TextArea.textContent,r,r,e.p5canvas.width-2*r),e.p5canvas.saveFrames("","png",1,1,function(){var c=(0,l.Z)(function*(_){try{n.dismiss(),e.image_info.path="tmp_files/modify_image.png",yield e.indexed.saveBase64ToUserPath(_[0].imageData.replace(/"|=|\\/g,""),e.image_info.path),e.modalCtrl.dismiss({type:"image",...e.image_info,msg:e.MessageInfo,index:e.RelevanceIndex-1})}catch(o){console.log("\ud30c\uc77c \uc800\uc7a5 \uc624\ub958: ",o)}});return function(_){return c.apply(this,arguments)}}());break;case"video":try{let c=yield e.loadingCtrl.create({message:e.lang.text.TodoDetail.WIP});c.present(),e.p5canvas.pixelDensity(1),e.p5canvas.VideoMedia.pause(),e.p5canvas.VideoMedia.size(e.image_info.width,e.image_info.height),e.p5canvas.createCanvas(e.image_info.width,e.image_info.height),e.p5canvas.image(e.p5canvas.VideoMedia,0,0,e.p5canvas.width,e.p5canvas.height),e.p5canvas.saveFrames("","png",1,1,function(){var _=(0,l.Z)(function*(o){try{c.dismiss(),e.image_info.path="tmp_files/modify_image.png",yield e.indexed.saveBase64ToUserPath(o[0].imageData.replace(/"|=|\\/g,""),e.image_info.path),e.modalCtrl.dismiss({type:"image",...e.image_info,msg:e.MessageInfo,index:e.RelevanceIndex-1})}catch(s){console.log("\ud30c\uc77c \uc800\uc7a5 \uc624\ub958: ",s)}});return function(o){return _.apply(this,arguments)}}())}catch(c){console.log("\uc7ac\uc0dd\uc911\uc778 \ube44\ub514\uc624 \uc774\ubbf8\uc9c0 \ucd94\ucd9c \uc624\ub958: ",c)}break;case"godot":e.global.godot_window.modify_image();break;default:console.log("\ud3b8\uc9d1 \ubd88\uac00 \ud30c\uc77c \uc815\ubcf4: ",e.FileInfo)}})()}download_file(){"DesktopPWA"==F.n$||"MobilePWA"==F.n$?this.indexed.DownloadFileFromUserPath(this.FileInfo.path,this.FileInfo.type,this.FileInfo.filename,this.targetDB):this.alertCtrl.create({header:this.lang.text.ContentViewer.Filename,inputs:[{name:"filename",placeholder:this.FileInfo.filename,type:"text"}],buttons:[{text:this.lang.text.ContentViewer.saveFile,handler:e=>{this.DownloadFileAct(e)}}]}).then(e=>e.present())}DownloadFileAct(e){var n=this;return(0,l.Z)(function*(){let r=yield n.loadingCtrl.create({message:n.lang.text.TodoDetail.WIP});r.present();let c=e.filename?e.filename.replace(/:|\?|\/|\\|<|>/g,""):n.FileInfo.filename,_=yield n.indexed.loadBlobFromUserPath(n.FileInfo.path,n.FileInfo.type,void 0,n.targetDB);n.forceWrite&&!e.filename?n.file.writeExistingFile(n.file.externalDataDirectory,c,_).then(o=>{n.forceWrite=!1,r.dismiss(),n.p5toast.show({text:`${n.lang.text.ContentViewer.OverWriteFile}: ${c}`})}):n.file.writeFile(n.file.externalDataDirectory,c,_).then(o=>{r.dismiss(),n.p5toast.show({text:n.lang.text.ContentViewer.fileSaved})}).catch(o=>{12===(r.dismiss(),o.code)?(n.p5toast.show({text:n.lang.text.ContentViewer.AlreadyExist}),n.forceWrite=!0,n.download_file()):console.log("\uc900\ube44\ub418\uc9c0 \uc54a\uc740 \uc624\ub958 \ubc18\ud658: ",o)})})()}ShareContent(){let e=this.nakama.rearrange_channels();for(let n=e.length-1;n>=0;n--)("missing"==e[n].status||"offline"==e[n].status)&&e.splice(n,1);e.length?this.modalCtrl.create({component:L.D,componentProps:{file:this.FileInfo,channels:e}}).then(n=>{n.onDidDismiss().then(r=>{r.data&&this.modalCtrl.dismiss()}),n.present()}):this.p5toast.show({text:this.lang.text.ShareContentToOther.NoChannelToShare})}RemoveFile(){this.alertCtrl.create({header:this.lang.text.ContentViewer.RemoveFile,message:this.FileInfo.path,buttons:[{text:this.lang.text.TodoDetail.remove,handler:()=>{this.RemoveFileAct()}}]}).then(e=>e.present())}RemoveFileAct(){var e=this;return(0,l.Z)(function*(){URL.revokeObjectURL(e.FileURL),delete e.FileInfo.thumbnail,delete e.FileInfo.text,yield e.indexed.removeFileFromUserPath(e.FileInfo.path,void 0,e.targetDB),e.RelevanceIndex-=1,e.ChangeToAnother(1)})()}ionViewWillLeave(){var e=this;return(0,l.Z)(function*(){switch(document.removeEventListener("ionBackButton",e.EventListenerAct),e.FileInfo.viewer){case"video":try{let r,c,n=e.p5canvas.VideoMedia.size();n.width>n.height?(r=192,c=n.height/n.width*192):(r=n.width/n.height*192,c=192),e.p5canvas.createCanvas(r,c),e.p5canvas.imageMode(e.p5canvas.CORNER),e.p5canvas.image(e.p5canvas.VideoMedia,0,0,r*e.image_info.width/n.width,c*e.image_info.height/n.height),e.p5canvas.fill(255,128),e.p5canvas.rect(0,0,r,c),e.p5canvas.textWrap(e.p5canvas.CHAR),e.p5canvas.textSize(16);let _=c/16;e.p5canvas.push(),e.p5canvas.translate(_/6,_/6),e.p5canvas.fill(0),e.p5canvas.text(e.FileInfo.filename,_,_,r-2*_,c-2*_),e.p5canvas.filter(e.p5canvas.BLUR,3),e.p5canvas.pop(),e.p5canvas.fill(255),e.p5canvas.text(e.FileInfo.filename,_,_,r-2*_,c-2*_),e.p5canvas.saveFrames("","png",1,1,function(){var o=(0,l.Z)(function*(s){try{let f=s[0].imageData.replace(/"|=|\\/g,"");yield e.indexed.saveBase64ToUserPath(f,`${e.FileInfo.path}_thumbnail.png`,void 0,e.targetDB),e.FileInfo.thumbnail=f,e.global.modulate_thumbnail(e.FileInfo,"")}catch(f){console.log("\uc378\ub124\uc77c \uc800\uc7a5 \uc624\ub958: ",f)}});return function(s){return o.apply(this,arguments)}}())}catch(n){console.log("\ube44\ub514\uc624 \uc378\ub124\uc77c \uc0dd\uc131 \ucde8\uc18c: ",n)}break;case"godot":try{e.global.godot_window.filename=e.FileInfo.filename,e.global.godot_window.create_thumbnail(e.FileInfo),(yield e.indexed.GetFileListFromDB("tmp_files",void 0,e.indexed.godotDB)).forEach(r=>e.indexed.removeFileFromUserPath(r,void 0,e.indexed.godotDB))}catch{}}e.p5canvas&&e.p5canvas.remove(),URL.revokeObjectURL(e.FileURL);try{(yield e.file.checkFile(e.file.externalDataDirectory,`viewer_tmp.${e.FileInfo.file_ext}`))&&(yield e.file.removeFile(e.file.externalDataDirectory,`viewer_tmp.${e.FileInfo.file_ext}`))}catch{}})()}copy_url(e){this.mClipboard.copy(e).catch(n=>R.Z.write(e))}}return(a=d).\u0275fac=function(e){return new(e||a)(t.Y36(h.IN),t.Y36(h.X1),t.Y36(Y.H),t.Y36(W.b),t.Y36(C.$),t.Y36(O.F),t.Y36(h.Br),t.Y36(h.HT),t.Y36(x.AN),t.Y36(b.a),t.Y36(k.T),t.Y36(D.J))},a.\u0275cmp=t.Xpm({type:a,selectors:[["app-ionic-viewer"]],viewQuery:function(e,n){if(1&e&&t.Gf(Q,5),2&e){let r;t.iGM(r=t.CRH())&&(n.ShowContentInfoIonic=r.first)}},decls:27,vars:16,consts:[[1,"ion-no-border"],["id","Toolbar"],["slot","start",3,"click"],["defaultHref",""],["class","relevance_change","style","padding-right: 4px;","slot","end","name","arrow-back-circle-outline",3,"click",4,"ngIf"],["slot","end",4,"ngIf"],["class","relevance_change","style","padding-right: 16px; padding-left: 4px;","slot","end","name","arrow-forward-circle-outline",3,"click",4,"ngIf"],["id","ContentBox"],[1,"main_table_elt"],[2,"height","0"],["id","FileHeader",2,"max-width","100vw"],["text-wrap","","style","overflow-x: auto;",4,"ngIf"],["type","text","text-warp","","style","overflow-x: auto; overflow-y: hidden;",3,"ngModel","placeholder","ngModelChange",4,"ngIf"],[3,"click",4,"ngIf"],["class","ion-align-items-center",3,"disabled","click",4,"ngIf"],["id","menu_trigger",4,"ngIf"],["trigger","menu_trigger","dismissOnSelect","",4,"ngIf"],[4,"ngIf"],[3,"initialBreakpoint","breakpoints"],["ShowContentInfoIonic",""],["slot","end","name","arrow-back-circle-outline",1,"relevance_change",2,"padding-right","4px",3,"click"],["slot","end"],["slot","end","name","arrow-forward-circle-outline",1,"relevance_change",2,"padding-right","16px","padding-left","4px",3,"click"],["text-wrap","",2,"overflow-x","auto"],["type","text","text-warp","",2,"overflow-x","auto","overflow-y","hidden",3,"ngModel","placeholder","ngModelChange"],[3,"click"],["name","close-circle-outline"],["name","save-outline"],[1,"ion-align-items-center",3,"disabled","click"],["name","code-download-outline"],["id","menu_trigger"],["name","ellipsis-vertical"],["trigger","menu_trigger","dismissOnSelect",""],["button","",3,"click",4,"ngIf"],["button","",3,"click"],["class","full_screen","id","content_viewer_canvas",4,"ngIf"],["class","full_screen","style","display: flex;","id","content_viewer_canvas",4,"ngIf"],["id","content_viewer_canvas",1,"full_screen"],["id","content_viewer_canvas",1,"full_screen",2,"display","flex"],[1,"ion-align-items-center"],["size","12",1,"ion-text-center"],["color","warning","shape","round",1,"ion-align-items-center",3,"disabled","click"],[1,"ion-text-end"],[4,"ngFor","ngForOf"],[1,"ion-text-center"],[1,"history_center"],["color","primary","mode","ios","outline","true",3,"click"],["name","document-attach-outline",4,"ngIf"],["name","camera-outline",4,"ngIf"],["name","link-outline",4,"ngIf"],["name","text-outline",4,"ngIf"],["name","document-text-outline",4,"ngIf"],["name","document-attach-outline"],["name","camera-outline"],["name","link-outline"],["name","text-outline"],["name","document-text-outline"],["src","assets/icon/voidDraw.png"]],template:function(e,n){1&e&&(t.TgZ(0,"ion-header",0)(1,"ion-toolbar",1)(2,"ion-title"),t._uU(3),t.qZA(),t.TgZ(4,"ion-buttons",2),t.NdJ("click",function(){return n.modalCtrl.dismiss()}),t._UZ(5,"ion-back-button",3),t.qZA(),t.YNc(6,G,1,0,"ion-icon",4),t.YNc(7,j,2,1,"ion-label",5),t.YNc(8,z,1,0,"ion-icon",6),t.qZA()(),t.TgZ(9,"ion-content",7)(10,"table",8)(11,"tr",9)(12,"td")(13,"ion-list-header",10),t.YNc(14,X,2,1,"ion-label",11),t.YNc(15,ee,1,2,"ion-input",12),t.YNc(16,te,2,0,"ion-button",13),t.YNc(17,ne,2,0,"ion-button",13),t.YNc(18,ie,2,1,"ion-button",14),t.YNc(19,ae,2,0,"ion-button",15),t.YNc(20,ge,2,0,"ion-popover",16),t.qZA()()(),t.TgZ(21,"tr"),t.YNc(22,me,3,2,"td",17),t.YNc(23,pe,6,2,"td",17),t.qZA()(),t.TgZ(24,"ion-modal",18,19),t.YNc(26,Pe,23,10,"ng-template"),t.qZA()()),2&e&&(t.xp6(3),t.Oqu(n.lang.text.ContentViewer.Title),t.xp6(3),t.Q6J("ngIf",n.HaveRelevances),t.xp6(1),t.Q6J("ngIf",n.HaveRelevances),t.xp6(1),t.Q6J("ngIf",n.HaveRelevances),t.xp6(6),t.Q6J("ngIf",!n.isTextEditMode),t.xp6(1),t.Q6J("ngIf",n.isTextEditMode),t.xp6(1),t.Q6J("ngIf",n.isTextEditMode),t.xp6(1),t.Q6J("ngIf",n.isTextEditMode),t.xp6(1),t.Q6J("ngIf",n.isChannelOnline&&n.HaveRelevances&&!n.isTextEditMode),t.xp6(1),t.Q6J("ngIf",!n.isTextEditMode),t.xp6(1),t.Q6J("ngIf",!n.isTextEditMode),t.xp6(2),t.Q6J("ngIf",!n.NeedDownloadFile),t.xp6(1),t.Q6J("ngIf",n.NeedDownloadFile),t.xp6(1),t.Q6J("initialBreakpoint",.5)("breakpoints",t.DdM(15,Fe)))},dependencies:[Z.sg,Z.O5,U.JJ,U.On,h.BJ,h.oU,h.YG,h.Sm,h.hM,h.wI,h.W2,h.jY,h.Gu,h.gu,h.pK,h.Ie,h.rH,h.Q$,h.q_,h.yh,h.Nd,h.wd,h.sr,h.ki,h.d8,h.j9,h.cs],styles:[".main_table_elt[_ngcontent-%COMP%]{width:100%;height:100%;border:0;margin:0}.relevance_change[_ngcontent-%COMP%]{width:25px;height:25px}.history_center[_ngcontent-%COMP%]{text-align:center}"]}),d})()},8049:(q,B,p)=>{p.d(B,{D:()=>W});var l=p(9468),F=p(3857),v=p(1325),S=p(7488),L=p(9080),R=p(6814);function t(C,O){1&C&&l._UZ(0,"div",12)}function h(C,O){if(1&C&&l._UZ(0,"img",13),2&C){const x=l.oxw().$implicit;l.Akn("online"==x.status||3==x.redirect.type&&"pending"==x.status?"filter: grayscale(0) contrast(1)":"filter: grayscale(.9) contrast(1.4)"),l.Q6J("src",x.info.img,l.LSH)}}function Y(C,O){if(1&C){const x=l.EpF();l.TgZ(0,"ion-item",4),l.NdJ("click",function(){const D=l.CHM(x).$implicit,Z=l.oxw();return l.KtG(Z.go_to_chatroom(D))}),l.TgZ(1,"div",5),l.YNc(2,t,1,0,"div",6),l.qZA(),l.TgZ(3,"div",7),l.YNc(4,h,1,3,"img",8),l.qZA(),l.TgZ(5,"ion-label")(6,"div",9)(7,"table")(8,"tr")(9,"td"),l._uU(10),l.qZA(),l.TgZ(11,"td",10),l._uU(12),l.qZA()()()(),l.TgZ(13,"div",11),l._uU(14),l.qZA()()()}if(2&C){const x=O.$implicit,b=l.oxw();l.xp6(1),l.Akn("background-color: "+b.statusBar.colors[x.status||"offline"]),l.xp6(1),l.Q6J("ngIf",x.is_new),l.xp6(2),l.Q6J("ngIf",x.info),l.xp6(6),l.hij(" ",x.info?x.info.name||x.info.display_name||b.lang.text.ChatRoom.noname_chatroom:x.title||b.lang.text.ChatRoom.noname_chatroom," "),l.xp6(2),l.hij(" ","("+x.server.target+")"," "),l.xp6(2),l.hij(" ",x.last_comment||x.noti||b.lang.text.Subscribes.noMessageHistory," ")}}let W=(()=>{var C;class O{constructor(b,k,D,Z,U){this.lang=b,this.navParams=k,this.modalCtrl=D,this.statusBar=Z,this.nakama=U}ngOnInit(){this.channels=this.navParams.get("channels")}go_to_chatroom(b){this.nakama.go_to_chatroom_without_admob_act(b,this.navParams.get("file")),this.modalCtrl.dismiss(!0)}}return(C=O).\u0275fac=function(b){return new(b||C)(l.Y36(F.b),l.Y36(v.X1),l.Y36(v.IN),l.Y36(S.g),l.Y36(L.a))},C.\u0275cmp=l.Xpm({type:C,selectors:[["app-share-content-to-other"]],decls:11,vars:3,consts:[[1,"ion-no-border"],["slot","start",3,"click"],["defaultHref",""],["button","",3,"click",4,"ngFor","ngForOf"],["button","",3,"click"],[1,"additional_form","status_bar_double"],["class","new_circle",4,"ngIf"],[1,"additional_form","bg_img_form"],["class","profile_img",3,"style","src",4,"ngIf"],[1,"form_margin","header"],[1,"server_target"],[1,"form_margin","content"],[1,"new_circle"],[1,"profile_img",3,"src"]],template:function(b,k){1&b&&(l.TgZ(0,"ion-header",0)(1,"ion-toolbar")(2,"ion-title"),l._uU(3),l.qZA(),l.TgZ(4,"ion-buttons",1),l.NdJ("click",function(){return k.modalCtrl.dismiss()}),l._UZ(5,"ion-back-button",2),l.qZA()()(),l.TgZ(6,"ion-content")(7,"ion-item-divider")(8,"ion-label"),l._uU(9),l.qZA()(),l.YNc(10,Y,15,7,"ion-item",3),l.qZA()),2&b&&(l.xp6(3),l.Oqu(k.lang.text.ShareContentToOther.Title),l.xp6(6),l.Oqu(k.lang.text.ShareContentToOther.AvailableChannels),l.xp6(1),l.Q6J("ngForOf",k.channels))},dependencies:[R.sg,R.O5,v.oU,v.Sm,v.W2,v.Gu,v.Ie,v.rH,v.Q$,v.wd,v.sr,v.cs],styles:[".server_target[_ngcontent-%COMP%]{color:#888;padding-left:4px}.content[_ngcontent-%COMP%]{color:#888;height:24px;display:table-cell;vertical-align:middle;padding:0 16px}"]}),O})()}}]);