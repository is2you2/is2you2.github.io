"use strict";(self.webpackChunkapp=self.webpackChunkapp||[]).push([[6698],{6698:(J,p,r)=>{r.r(p),r.d(p,{AddGroupPageModule:()=>k});var g=r(9808),l=r(4182),a=r(3996),c=r(9705),h=r(5016),m=r(3260),e=r(9863),_=r(3336),f=r(261),v=r(4606),A=r(5742),x=r(1282);function I(n,d){if(1&n){const i=e.EpF();e.TgZ(0,"ion-item",25),e.NdJ("click",function(){const o=e.CHM(i).index;return e.oxw(2).select_server(o)}),e.TgZ(1,"ion-label"),e._uU(2),e.qZA()()}if(2&n){const i=d.$implicit;e.xp6(2),e.Oqu(i.name)}}function Z(n,d){if(1&n){const i=e.EpF();e.TgZ(0,"ion-accordion-group",18,19),e.NdJ("click",function(){return e.CHM(i),e.oxw().isExpanded=!0}),e.TgZ(2,"ion-accordion",20)(3,"ion-item",21)(4,"ion-label"),e._uU(5),e.qZA(),e.TgZ(6,"ion-label",22),e._uU(7),e.qZA()(),e.TgZ(8,"ion-list",23),e.YNc(9,I,3,1,"ion-item",24),e.qZA()()()}if(2&n){const i=e.oxw();e.Q6J("disabled",i.isSaveClicked)("value",i.isExpanded),e.xp6(5),e.Oqu(i.lang.text.AddGroup.SelectServer),e.xp6(2),e.Oqu(i.servers[i.index].name),e.xp6(2),e.Q6J("ngForOf",i.servers)}}function T(n,d){if(1&n&&(e.TgZ(0,"ion-item",26)(1,"ion-label"),e._uU(2),e.qZA()()),2&n){const i=e.oxw();e.xp6(2),e.Oqu(i.lang.text.AddGroup.AfterCreateGroup)}}function G(n,d){if(1&n&&e._UZ(0,"img",27),2&n){const i=e.oxw();e.Q6J("src",i.QRCodeSRC,e.LSH)}}const b=[{path:"",component:(()=>{class n{constructor(i,t,s,o,u,S){this.navCtrl=i,this.p5toast=t,this.nakama=s,this.statusBar=o,this.lang=u,this.global=S,this.userInput={server:void 0,id:void 0,name:void 0,description:void 0,max_count:void 0,lang_tag:void 0,open:!1,creator_id:void 0,img:void 0},this.servers=[],this.index=0,this.isExpanded=!0,this.cant_use_clipboard=!1,this.imageURL_disabled=!1,this.imageURL_placeholder=this.lang.text.Profile.pasteURI,this.isSaveClicked=!1,this.isSavedWell=!1}ngOnInit(){let i=JSON.parse(localStorage.getItem("add-group"));i&&(this.userInput=i),this.servers=this.nakama.get_all_server_info(!0,!0),this.userInput.server=this.servers[this.index]}select_server(i){this.index=i,this.userInput.server=this.servers[i],this.isExpanded=!1}imageURLPasted(){"DesktopPWA"==h.n$&&(this.imageURL_disabled=!0,m.Z.read().then(i=>{0==i.indexOf("http")?(this.userInput.img=i,this.imageURL_placeholder=i):0==i.indexOf("data:image")?this.nakama.limit_image_size({target:{result:[i]}},t=>this.userInput.img=t.canvas.toDataURL()):this.p5toast.show({text:this.lang.text.Profile.copyURIFirst})}),setTimeout(()=>{this.imageURL_disabled=!1},1500))}isPublicToggle(){this.userInput.open=!this.userInput.open}save(){if("online"!=this.statusBar.groupServer[this.servers[this.index].isOfficial][this.servers[this.index].target])return void this.p5toast.show({text:this.lang.text.AddGroup.cannot_use_selected_server});let i=this.nakama.servers[this.servers[this.index].isOfficial][this.servers[this.index].target].client,t=this.nakama.servers[this.servers[this.index].isOfficial][this.servers[this.index].target].session;this.userInput.owner=t.user_id,this.isSaveClicked=!0,this.userInput.lang_tag=this.userInput.lang_tag||this.lang.lang,this.userInput.max_count=this.userInput.max_count||2,i.createGroup(t,{name:this.userInput.name,lang_tag:this.userInput.lang_tag,description:this.userInput.description,max_count:this.userInput.max_count,open:this.userInput.open}).then(s=>{this.userInput.id=s.id,this.userInput.creator_id=this.nakama.servers[this.servers[this.index].isOfficial][this.servers[this.index].target].session.user_id,this.QRCodeSRC=this.global.readasQRCodeFromId({type:"group",id:this.userInput.id,title:this.userInput.name}),this.nakama.save_group_info(this.userInput,this.servers[this.index].isOfficial,this.servers[this.index].target),this.nakama.join_chat_with_modulation(s.id,3,this.servers[this.index].isOfficial,this.servers[this.index].target,o=>{this.isSavedWell=!0,localStorage.removeItem("add-group"),this.p5toast.show({text:this.lang.text.AddGroup.group_created}),setTimeout(()=>{this.navCtrl.back()},500)})}).catch(s=>{switch(console.error("\uadf8\ub8f9 \uc0dd\uc131 \uc2e4\ud328: ",s),s.status){case 400:setTimeout(()=>{this.p5toast.show({text:this.lang.text.AddGroup.NeedSetGroupName}),this.isSaveClicked=!1},500);break;case 409:setTimeout(()=>{this.p5toast.show({text:this.lang.text.AddGroup.AlreadyExist}),this.isSaveClicked=!1},500);break;default:setTimeout(()=>{this.p5toast.show({text:`${this.lang.text.AddGroup.UnexpectedErr}: ${s}`}),this.isSaveClicked=!1},500)}})}ionViewWillLeave(){this.isSavedWell||localStorage.setItem("add-group",JSON.stringify(this.userInput))}buttonClickLinkInputFile(){document.getElementById("file_sel").click()}inputImageSelected(i){var t;let s=new FileReader;s=null!==(t=s._realReader)&&void 0!==t?t:s,s.onload=o=>{this.nakama.limit_image_size(o,u=>this.userInput.img=u.canvas.toDataURL())},s.readAsDataURL(i.target.files[0])}}return n.\u0275fac=function(i){return new(i||n)(e.Y36(a.SH),e.Y36(_.F),e.Y36(f.a),e.Y36(v.g),e.Y36(A.b),e.Y36(x.A))},n.\u0275cmp=e.Xpm({type:n,selectors:[["app-add-group"]],decls:51,vars:33,consts:[["slot","start"],["defaultHref","settings"],["value","colors","expand","inset",3,"disabled","value","click",4,"ngIf"],["button","",3,"disabled"],[1,"ion-text-right",3,"ngModel","placeholder","ngModelChange"],["button","",3,"disabled","click"],[1,"additional_form","bg_img_form"],[1,"profile_img",2,"filter","grayscale(0) contrast(1)",3,"src"],[3,"hidden","disabled","click"],["color","medium"],["hidden","","type","file","id","file_sel","accept","image/*",3,"change"],["disabled","",4,"ngIf"],["style","width: 100%; height: auto;","alt","Loading",3,"src",4,"ngIf"],[1,"infobox",3,"disabled","ngModel","placeholder","ngModelChange"],[3,"disabled"],["type","number","min","2","placeholder","2",1,"ion-text-right",3,"ngModel","ngModelChange"],["slot","end",2,"pointer-events","none",3,"ngModel","ngModelChange"],[1,"ion-text-center"],["value","colors","expand","inset",3,"disabled","value","click"],["accordionGroup",""],["value","colors"],["slot","header"],[1,"ion-text-right"],["slot","content"],["button","",3,"click",4,"ngFor","ngForOf"],["button","",3,"click"],["disabled",""],["alt","Loading",2,"width","100%","height","auto",3,"src"]],template:function(i,t){1&i&&(e.TgZ(0,"ion-header")(1,"ion-toolbar")(2,"ion-title"),e._uU(3),e.qZA(),e.TgZ(4,"ion-buttons",0),e._UZ(5,"ion-back-button",1),e.qZA()()(),e.TgZ(6,"ion-content"),e.YNc(7,Z,10,5,"ion-accordion-group",2),e.TgZ(8,"ion-item-divider")(9,"ion-label"),e._uU(10),e.qZA()(),e.TgZ(11,"ion-item",3)(12,"ion-label"),e._uU(13),e.qZA(),e.TgZ(14,"ion-input",4),e.NdJ("ngModelChange",function(o){return t.userInput.name=o}),e.qZA()(),e.TgZ(15,"ion-item",5),e.NdJ("click",function(){return t.buttonClickLinkInputFile()}),e.TgZ(16,"div",6),e._UZ(17,"img",7),e.qZA(),e.TgZ(18,"ion-label")(19,"p"),e._uU(20),e.qZA(),e.TgZ(21,"h2"),e._uU(22),e.qZA()()(),e.TgZ(23,"ion-item",8),e.NdJ("click",function(){return t.imageURLPasted()}),e.TgZ(24,"ion-label",9),e._uU(25),e.qZA()(),e.TgZ(26,"input",10),e.NdJ("change",function(o){return t.inputImageSelected(o)}),e.qZA(),e.TgZ(27,"ion-item-divider")(28,"ion-label"),e._uU(29),e.qZA()(),e.YNc(30,T,3,1,"ion-item",11),e.YNc(31,G,1,1,"img",12),e.TgZ(32,"ion-item-divider")(33,"ion-label"),e._uU(34),e.qZA()(),e.TgZ(35,"textarea",13),e.NdJ("ngModelChange",function(o){return t.userInput.description=o}),e.qZA(),e.TgZ(36,"ion-item",3)(37,"ion-label"),e._uU(38),e.qZA(),e.TgZ(39,"ion-input",4),e.NdJ("ngModelChange",function(o){return t.userInput.lang_tag=o}),e.qZA()(),e.TgZ(40,"ion-item",14)(41,"ion-label"),e._uU(42),e.qZA(),e.TgZ(43,"ion-input",15),e.NdJ("ngModelChange",function(o){return t.userInput.max_count=o}),e.qZA()(),e.TgZ(44,"ion-item",5),e.NdJ("click",function(){return t.isPublicToggle()}),e.TgZ(45,"ion-label"),e._uU(46),e.qZA(),e.TgZ(47,"ion-toggle",16),e.NdJ("ngModelChange",function(o){return t.userInput.open=o}),e.qZA()(),e.TgZ(48,"ion-item",5),e.NdJ("click",function(){return t.save()}),e.TgZ(49,"ion-label",17),e._uU(50),e.qZA()()()),2&i&&(e.xp6(3),e.Oqu(t.lang.text.Settings.CreateGroup),e.xp6(4),e.Q6J("ngIf",t.servers.length),e.xp6(3),e.Oqu(t.lang.text.AddGroup.GroupInfo),e.xp6(1),e.Q6J("disabled",t.isSaveClicked),e.xp6(2),e.Oqu(t.lang.text.AddGroup.DisplayName),e.xp6(1),e.Q6J("ngModel",t.userInput.name)("placeholder",t.lang.text.AddGroup.DisplayName_placeholder),e.xp6(1),e.Q6J("disabled",t.isSaveClicked),e.xp6(2),e.Q6J("src",t.userInput.img,e.LSH),e.xp6(3),e.Oqu(t.userInput.server.name+" ("+t.userInput.server.target+")"),e.xp6(2),e.Oqu(t.userInput.name||t.lang.text.AddGroup.ClicktoChangeGroupImg),e.xp6(1),e.Q6J("hidden",t.cant_use_clipboard)("disabled",t.isSaveClicked||t.imageURL_disabled),e.xp6(2),e.Oqu(t.imageURL_placeholder),e.xp6(4),e.Oqu(t.lang.text.AddGroup.JoinThisGroup),e.xp6(1),e.Q6J("ngIf",!t.QRCodeSRC),e.xp6(1),e.Q6J("ngIf",t.QRCodeSRC),e.xp6(3),e.Oqu(t.lang.text.AddGroup.GroupDetail),e.xp6(1),e.Q6J("disabled",t.isSaveClicked)("ngModel",t.userInput.description)("placeholder",t.lang.text.AddGroup.GroupDetail_placeholder),e.xp6(1),e.Q6J("disabled",t.isSaveClicked),e.xp6(2),e.Oqu(t.lang.text.AddGroup.LanguageTag),e.xp6(1),e.Q6J("ngModel",t.userInput.lang_tag)("placeholder",t.lang.lang),e.xp6(1),e.Q6J("disabled",t.isSaveClicked),e.xp6(2),e.Oqu(t.lang.text.AddGroup.MemberMaxLimit),e.xp6(1),e.Q6J("ngModel",t.userInput.max_count),e.xp6(1),e.Q6J("disabled",t.isSaveClicked),e.xp6(2),e.Oqu(t.lang.text.AddGroup.IsOpen),e.xp6(1),e.Q6J("ngModel",t.userInput.open),e.xp6(1),e.Q6J("disabled",t.isSaveClicked),e.xp6(2),e.Oqu(t.lang.text.AddGroup.submit))},directives:[a.Gu,a.sr,a.wd,a.Sm,a.oU,a.cs,a.W2,g.O5,a.eh,a.We,a.Ie,a.Q$,a.q_,g.sg,a.rH,a.pK,a.j9,l.JJ,l.On,l.Fj,a.as,a.ho,a.w],styles:[""]}),n})()}];let C=(()=>{class n{}return n.\u0275fac=function(i){return new(i||n)},n.\u0275mod=e.oAB({type:n}),n.\u0275inj=e.cJS({imports:[[c.Bz.forChild(b)],c.Bz]}),n})(),k=(()=>{class n{}return n.\u0275fac=function(i){return new(i||n)},n.\u0275mod=e.oAB({type:n}),n.\u0275inj=e.cJS({imports:[[g.ez,l.u5,a.Pc,C]]}),n})()}}]);