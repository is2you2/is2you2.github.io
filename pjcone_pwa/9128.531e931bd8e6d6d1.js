"use strict";(self.webpackChunkapp=self.webpackChunkapp||[]).push([[9128],{9128:(z,y,r)=>{r.r(y),r.d(y,{SubscribesPageModule:()=>L});var b=r(177),C=r(4341),m=r(5374),S=r(9858),p=r(467),v=r(6587),P=r(3483),$=r(9543),t=r(3953),R=r(3656),F=r(9900),A=r(4237),j=r(8065),G=r(4234),I=r(3295),D=r(755);const T=()=>[0,1,2];function M(s,d){if(1&s){const n=t.RV6();t.j41(0,"div",7),t.bIt("click",function(){t.eBV(n);const i=t.XpG();return t.Njj(i.scanQRCode())}),t.nrm(1,"ion-icon",8),t.k0s()}}function X(s,d){if(1&s){const n=t.RV6();t.j41(0,"ion-item",13),t.bIt("click",function(){t.eBV(n);const i=t.XpG().$implicit,o=t.XpG(3);return t.Njj(o.check_notifications(i))}),t.j41(1,"ion-label"),t.EFF(2),t.k0s()()}if(2&s){const n=t.XpG().$implicit,e=t.XpG(3);t.R7$(2),t.JRh(e.nakama.notifications_rearrange[n].request)}}function N(s,d){if(1&s&&(t.j41(0,"div"),t.DNE(1,X,3,1,"ion-item",21),t.k0s()),2&s){const n=d.$implicit,e=t.XpG(3);t.R7$(),t.Y8G("ngIf",e.nakama.notifications_rearrange.length>n)}}function E(s,d){if(1&s&&(t.j41(0,"ion-accordion-group",16,0)(2,"ion-accordion",17)(3,"ion-item",18)(4,"ion-label"),t.EFF(5),t.k0s()(),t.j41(6,"div",19),t.DNE(7,N,2,1,"div",20),t.k0s()()()),2&s){const n=t.XpG(2);t.Y8G("value",!1),t.R7$(5),t.JRh(n.lang.text.Subscribes.has_noties),t.R7$(2),t.Y8G("ngForOf",t.lJ4(3,T))}}function O(s,d){if(1&s&&t.nrm(0,"div",31),2&s){const n=t.XpG().$implicit,e=t.XpG(3);t.Aen("background-color: "+e.statusBar.colors[n.status||"offline"])}}function U(s,d){if(1&s&&t.nrm(0,"div",32),2&s){const n=t.XpG().$implicit;t.Aen("background-image: linear-gradient(to right, #0000, #"+(n.color||"abcdef")+"44)")}}function B(s,d){if(1&s&&(t.j41(0,"td",33),t.EFF(1),t.k0s()),2&s){const n=t.XpG().$implicit,e=t.XpG(3);t.R7$(),t.SpI(" ","("+(n.local?e.lang.text.AddGroup.UseLocalStorage:n.server.name||n.server.target)+")"," ")}}function Y(s,d){if(1&s){const n=t.RV6();t.j41(0,"ion-item",23),t.bIt("click",function(){const i=t.eBV(n).$implicit,o=t.XpG(3);return t.Njj(o.go_to_chatroom(i))})("contextmenu",function(){const i=t.eBV(n).$implicit,o=t.XpG(3);return t.Njj(o.ChannelContextMenu(i))}),t.j41(1,"div",24),t.nrm(2,"img",25),t.DNE(3,O,1,2,"div",26),t.k0s(),t.DNE(4,U,1,2,"div",27),t.j41(5,"ion-label")(6,"div",28)(7,"table")(8,"tr")(9,"td"),t.EFF(10),t.k0s(),t.DNE(11,B,2,1,"td",29),t.k0s()()(),t.j41(12,"div",30),t.EFF(13),t.k0s()()()}if(2&s){const n=d.$implicit,e=t.XpG(3);t.R7$(2),t.Aen("online"==n.status||3==n.redirect.type&&"pending"==n.status?"filter: grayscale(0) contrast(1)":"filter: grayscale(.9) contrast(1.4)"),t.Y8G("src",n.info&&n.info.img||(n.local||n.info&&1==n.info.max_count?"assets/data/local.svg":"assets/data/channel.svg"),t.B4B),t.R7$(),t.Y8G("ngIf",!n.local),t.R7$(),t.Y8G("ngIf",n.is_new),t.R7$(6),t.SpI(" ",n.info?n.info.name||n.info.display_name||e.lang.text.ChatRoom.noname_chatroom:n.title||e.lang.text.ChatRoom.noname_chatroom," "),t.R7$(),t.Y8G("ngIf",e.nakama.showServer),t.R7$(2),t.SpI(" ",n.last_comment||n.noti||e.lang.text.Subscribes.noMessageHistory," ")}}function w(s,d){if(1&s&&(t.j41(0,"div")(1,"ion-item-divider")(2,"ion-label"),t.EFF(3),t.k0s()(),t.DNE(4,Y,14,8,"ion-item",22),t.k0s()),2&s){const n=t.XpG(2);t.R7$(3),t.JRh(n.lang.text.Subscribes.JoinedChannels),t.R7$(),t.Y8G("ngForOf",n.nakama.channels)}}function K(s,d){if(1&s){const n=t.RV6();t.j41(0,"div")(1,"div",34),t.bIt("click",function(){t.eBV(n);const i=t.XpG(2);return t.Njj(i.add_new_group())}),t.nrm(2,"ion-icon",35),t.j41(3,"div")(4,"ion-label",36),t.EFF(5),t.k0s()()()()}if(2&s){const n=t.XpG(2);t.R7$(5),t.JRh(n.lang.text.Subscribes.NoChat)}}function V(s,d){if(1&s){const n=t.RV6();t.j41(0,"ion-content"),t.DNE(1,E,8,4,"ion-accordion-group",9),t.j41(2,"div",10)(3,"ion-item-divider")(4,"ion-label"),t.EFF(5),t.k0s(),t.j41(6,"ion-button",11),t.bIt("click",function(){t.eBV(n);const i=t.XpG();return t.Njj(i.open_link("https://is2you2.github.io/"))}),t.EFF(7),t.k0s()(),t.nrm(8,"div",12),t.k0s(),t.j41(9,"ion-item-divider")(10,"ion-label"),t.EFF(11),t.k0s()(),t.j41(12,"ion-item",13),t.bIt("click",function(){t.eBV(n);const i=t.XpG();return t.Njj(i.go_to_page("group-server"))}),t.j41(13,"div",14),t.nrm(14,"img",15),t.k0s(),t.j41(15,"ion-label"),t.EFF(16),t.k0s()(),t.DNE(17,w,5,2,"div",6)(18,K,6,1,"div",6),t.k0s()}if(2&s){const n=t.XpG();t.R7$(),t.Y8G("ngIf",n.nakama.notifications_rearrange.length),t.R7$(),t.Y8G("hidden",n.isAdHiding),t.R7$(3),t.JRh(n.lang.text.Settings.CommunityAds),t.R7$(2),t.SpI(" ",n.lang.text.Settings.AdsContact," "),t.R7$(4),t.JRh(n.lang.text.Subscribes.myProfile),t.R7$(3),t.Aen(n.nakama.users.self.online?"filter: grayscale(0) contrast(1);":"filter: grayscale(.9) contrast(1.4);"),t.Y8G("src",n.nakama.users.self.img,t.B4B),t.R7$(2),t.JRh(n.nakama.users.self.display_name||n.lang.text.Profile.noname_user),t.R7$(),t.Y8G("ngIf",n.nakama.channels.length),t.R7$(),t.Y8G("ngIf",!n.nakama.channels.length)}}const J=[{path:"",component:(()=>{var s;class d{constructor(e,i,o,a,_,g,l,u,c,h){this.modalCtrl=e,this.p5toast=i,this.nakama=o,this.statusBar=a,this.lang=_,this.global=g,this.navCtrl=l,this.indexed=u,this.alertCtrl=c,this.loadingCtrl=h,this.availables=[],this.isAdHiding=!0,this.cant_dedicated=!1,this.StartScan=!1,this.lock_chatroom=!1}ngOnInit(){this.indexed.loadTextFromUserPath("servers/self/profile.img",(e,i)=>{e&&i&&(this.nakama.users.self.img=i.replace(/"|=|\\/g,""))})}checkAdsInfo(){var e=this;return(0,p.A)(function*(){try{let i=yield fetch(`${v.d2}pjcone_ads/${e.lang.lang}.txt`);if(!i.ok)throw"\uad11\uace0\uac00 \uc5c6\ub294 \uac83\uc73c\ub85c \ub2e8\uc815\ud569\ub2c8\ub2e4";{let o=yield(yield i.blob()).text();e.indexed.saveTextFileToUserPath(o,"ads_list.txt");let a=o.split("\n");e.listAvailableAds(a)}}catch{e.indexed.loadTextFromUserPath("ads_list.txt",(o,a)=>{o&&a&&e.listAvailableAds(a.split("\n"))})}})()}listAvailableAds(e){let o,i=(new Date).getTime();this.availables.length=0;for(let _=0,g=e.length;_<g;_++){let l=e[_].split(",");Number(l[0])<i?i<Number(l[1])&&this.availables.push([Number(l[0]),Number(l[1]),l[2]]):o?Number(l[0])<o&&(o=Number(l[0])):o=Number(l[0])}this.AD_Div.childNodes.forEach(_=>{_.remove()}),this.availables.length?this.displayRandomAds():o&&(this.refreshAds=setTimeout(()=>{this.checkAdsInfo()},o-(new Date).getTime()))}displayRandomAds(){this.isAdHiding=!0;let e=Math.floor(Math.random()*this.availables.length),i=this.availables[e];this.refreshAds=setTimeout(()=>{this.indexed.loadTextFromUserPath("ads_list.txt",(a,_)=>{a&&_&&this.listAvailableAds(_.split("\n"))})},i[1]-(new Date).getTime());let o=document.createElement("iframe");o.id="AdFrame",o.setAttribute("src",i[2]),o.setAttribute("frameborder","0"),o.setAttribute("class","full_screen"),this.isAdHiding=!1,this.AD_Div.appendChild(o)}open_link(e){window.open(e,"_system")}try_add_shortcut(){this.global.p5key&&this.global.p5key.KeyShortCut?this.AddShortcut():setTimeout(()=>{this.try_add_shortcut()},100)}AddShortcut(){this.global.p5key&&this.global.p5key.KeyShortCut&&(this.global.p5key.KeyShortCut.Backquote=()=>{this.go_to_page("group-server")},this.global.p5key.KeyShortCut.Digit=e=>{this.nakama.channels.length>e?this.go_to_chatroom(this.nakama.channels[e]):this.add_new_group()}),this.global.p5key&&this.global.p5key.KeyShortCut&&!this.global.p5key.KeyShortCut.AddAct&&(this.global.p5key.KeyShortCut.AddAct=()=>{this.add_new_group()})}ChannelContextMenu(e){var i=this;let o=e.server.isOfficial,a=e.server.target,_=e.info.name||e.info.display_name;switch(_=2==e.redirect.type?_||this.lang.text.Profile.noname_user:_||this.lang.text.ChatRoom.noname_chatroom,e.redirect.type){case 3:if("online"==e.status||"pending"==e.status){this.modalCtrl.create({component:$.k,componentProps:{info:this.nakama.groups[o][a][e.group_id],server:{isOfficial:o,target:a}}}).then(g=>{let l=this.global.p5key.KeyShortCut;this.global.p5key.KeyShortCut={},g.onDidDismiss().then(()=>{this.global.p5key.KeyShortCut=l}),g.present()});break}case 2:"online"==e.status||"pending"==e.status?this.alertCtrl.create({header:_,message:this.lang.text.ChatRoom.UnlinkChannel,buttons:[{text:this.lang.text.ChatRoom.LogOut,handler:(g=(0,p.A)(function*(){try{yield i.nakama.servers[o][a].socket.leaveChat(e.id),i.nakama.channels_orig[o][a][e.id].status="missing"}catch(l){console.error("\ucc44\ub110\uc5d0\uc11c \ub098\uc624\uae30 \uc2e4\ud328: ",l)}i.nakama.rearrange_channels()}),function(){return g.apply(this,arguments)}),cssClass:"redfont"}]}).then(g=>g.present()):this.alertCtrl.create({header:_,message:this.lang.text.ChatRoom.RemoveChannelLogs,buttons:[{text:this.lang.text.ChatRoom.Delete,handler:function(){var g=(0,p.A)(function*(){let l=yield i.loadingCtrl.create({message:i.lang.text.TodoDetail.WIP});l.present(),yield i.nakama.remove_group_list(i.nakama.channels_orig[o][a][e.id].info,o,a,!0),delete i.nakama.channels_orig[o][a][e.id],i.nakama.remove_channel_files(o,a,e.id);try{let c=localStorage.getItem("fallback_fs");if(!c)throw"\uc0ac\uc6a9\uc790 \uc9c0\uc815 \uc11c\ubc84 \uc5c6\uc74c";let h=c.split(":"),x=`${h[0].replace(/(\b25[0-5]|\b2[0-4][0-9]|\b[01]?[0-9][0-9]?)(\.(25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)){3}/g,"")?"https:":"http:"}//${h[0]}:${h[1]||9002}/`,f=`${e.id}_${i.nakama.users.self.display_name}`;try{f=`${e.info.id}_${i.nakama.servers[o][a].session.user_id}`}catch{}i.global.remove_files_from_storage_with_key(x,f)}catch{}try{i.global.remove_files_from_storage_with_key(`${[e.info.server.useSSL?"https:":"http:"]}//${e.info.server.address}:9002/`,`${e.info.id}_${i.nakama.servers[o][a].session.user_id}`)}catch{}let u=yield i.indexed.GetFileListFromDB(`servers/${o}/${a}/channels/${e.id}`);for(let c=0,h=u.length;c<h;c++)l.message=`${i.lang.text.UserFsDir.DeleteFile}: ${h-c}`,yield i.indexed.removeFileFromUserPath(u[c]);l.dismiss(),i.nakama.rearrange_channels()});return function(){return g.apply(this,arguments)}}(),cssClass:"redfont"}]}).then(g=>g.present());break;case 0:this.alertCtrl.create({header:_,message:this.lang.text.ChatRoom.RemoveChannelLogs,buttons:[{text:this.lang.text.ChatRoom.Delete,handler:function(){var g=(0,p.A)(function*(){let l=yield i.loadingCtrl.create({message:i.lang.text.TodoDetail.WIP});l.present(),delete i.nakama.channels_orig[o][a][e.id];try{yield i.indexed.removeFileFromUserPath(`servers/${o}/${a}/groups/${e.id}.img`)}catch(c){console.log("\uadf8\ub8f9 \uc774\ubbf8\uc9c0 \uc0ad\uc81c \uc624\ub958: ",c)}i.nakama.save_groups_with_less_info();try{let c=localStorage.getItem("fallback_fs");if(!c)throw"\uc0ac\uc6a9\uc790 \uc9c0\uc815 \uc11c\ubc84 \uc5c6\uc74c";let h=c.split(":"),x=`${h[0].replace(/(\b25[0-5]|\b2[0-4][0-9]|\b[01]?[0-9][0-9]?)(\.(25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)){3}/g,"")?"https:":"http:"}//${h[0]}:${h[1]||9002}/`,f=`${e.id}_${i.nakama.users.self.display_name}`;try{f=`${e.info.id}_${i.nakama.servers[o][a].session.user_id}`}catch{}i.global.remove_files_from_storage_with_key(x,f)}catch{}let u=yield i.indexed.GetFileListFromDB(`servers/${o}/${a}/channels/${e.id}`);for(let c=0,h=u.length;c<h;c++)l.message=`${i.lang.text.UserFsDir.DeleteFile}: ${h-c}`,yield i.indexed.removeFileFromUserPath(u[c]);l.dismiss(),i.nakama.rearrange_channels()});return function(){return g.apply(this,arguments)}}(),cssClass:"redfont"}]}).then(g=>g.present())}var g;return!1}ionViewWillEnter(){this.AD_Div=document.getElementById("advertise"),this.checkAdsInfo()}ionViewDidEnter(){this.nakama.subscribe_lock=!0,("DesktopPWA"==v.aH||"MobilePWA"==v.aH)&&(this.cant_dedicated=!0),this.try_add_shortcut()}go_to_page(e){this.navCtrl.navigateForward(`portal/settings/${e}`)}scanQRCode(){return(0,p.A)(function*(){})()}StopScan(){}go_to_chatroom(e){this.lock_chatroom||(this.lock_chatroom=!0,this.nakama.go_to_chatroom_without_admob_act(e),("online"!=e.status||"pending"!=e.status)&&delete e.is_new,this.lock_chatroom=!1)}check_notifications(e){let i=this.nakama.notifications_rearrange[e].server;this.nakama.check_notifications(this.nakama.notifications_rearrange[e],i.isOfficial,i.target)}add_new_group(){this.modalCtrl.create({component:P.k}).then(e=>{let i=this.global.p5key.KeyShortCut;this.global.p5key.KeyShortCut={},e.onDidDismiss().then(()=>{this.global.p5key.KeyShortCut=i,this.try_add_shortcut()}),e.present()})}ionViewWillLeave(){this.nakama.subscribe_lock=!1,delete this.global.p5key.KeyShortCut.Backquote,delete this.global.p5key.KeyShortCut.Digit,delete this.global.p5key.KeyShortCut.AddAct,this.StopScan()}}return(s=d).\u0275fac=function(e){return new(e||s)(t.rXU(m.W3),t.rXU(F.G),t.rXU(A.X),t.rXU(j.j),t.rXU(G.y),t.rXU(I.z3),t.rXU(R.q9),t.rXU(D.n),t.rXU(m.hG),t.rXU(m.Xi))},s.\u0275cmp=t.VBU({type:s,selectors:[["app-subscribes"]],decls:9,vars:5,consts:[["accordionGroup",""],[1,"ion-no-border"],["class","qr_code_scan",3,"click",4,"ngIf"],[1,"add_group",3,"click"],["button","","name","add-circle-outline",2,"width","24px","height","24px"],[1,"header_online_circle",3,"click"],[4,"ngIf"],[1,"qr_code_scan",3,"click"],["name","scan-circle-outline",2,"width","24px","height","24px"],["value","colors","expand","inset",3,"value",4,"ngIf"],[3,"hidden"],["slot","end","fill","clear","shape","round",3,"click"],["id","advertise",1,"advertise_banner"],["button","",3,"click"],[1,"additional_form","bg_img_form"],[1,"profile_img",3,"src"],["value","colors","expand","inset",3,"value"],["value","colors"],["slot","header"],["slot","content"],[4,"ngFor","ngForOf"],["button","",3,"click",4,"ngIf"],["button","",3,"click","contextmenu",4,"ngFor","ngForOf"],["button","",3,"click","contextmenu"],[1,"channel_image","channel_image_div"],["alt","ch_img",1,"channel_image",3,"src"],["class","status_circle",3,"style",4,"ngIf"],["class","additional_form new_bg_form",3,"style",4,"ngIf"],[1,"channel_text_form","header"],["class","server_target",4,"ngIf"],[1,"channel_text_form","content"],[1,"status_circle"],[1,"additional_form","new_bg_form"],[1,"server_target"],[1,"disconnect_info",3,"click"],["color","medium","name","chatbubble-ellipses-outline",2,"width","60px","height","60px"],["color","medium"]],template:function(e,i){1&e&&(t.j41(0,"ion-header",1)(1,"ion-toolbar")(2,"ion-title"),t.EFF(3),t.k0s(),t.DNE(4,M,2,0,"div",2),t.j41(5,"div",3),t.bIt("click",function(){return i.add_new_group()}),t.nrm(6,"ion-icon",4),t.k0s(),t.j41(7,"div",5),t.bIt("click",function(){return i.nakama.toggle_all_session(!0)}),t.k0s()()(),t.DNE(8,V,19,11,"ion-content",6)),2&e&&(t.R7$(3),t.JRh(i.lang.text.Subscribes.Title),t.R7$(),t.Y8G("ngIf",!i.cant_dedicated),t.R7$(3),t.Aen("background-color: "+i.statusBar.colors[i.statusBar.settings.groupServer]+"; cursor: pointer;"),t.R7$(),t.Y8G("ngIf",!i.StartScan))},dependencies:[b.Sq,b.bT,m.xk,m.YH,m.Jm,m.W9,m.eU,m.iq,m.uz,m.Dg,m.he,m.BC,m.ai],styles:[".advertise_banner[_ngcontent-%COMP%]{width:100%;max-height:150px}.header[_ngcontent-%COMP%]{padding-bottom:4px}.content[_ngcontent-%COMP%]{color:#888;height:24px;line-height:24px;vertical-align:middle;overflow:hidden}.channel_image_div[_ngcontent-%COMP%]{position:absolute}.channel_image[_ngcontent-%COMP%]{width:52px;height:52px;border-radius:64px;object-fit:cover}.status_bar[_ngcontent-%COMP%]{width:5px;height:76%}.channel_text_form[_ngcontent-%COMP%]{margin-left:64px}.status_circle[_ngcontent-%COMP%]{position:relative;top:-56px;left:38px;width:12px;height:12px;border-radius:12px}.md[_ngcontent-%COMP%]   .qr_code_scan[_ngcontent-%COMP%]{position:absolute;right:116px;top:16px;cursor:pointer}.ios[_ngcontent-%COMP%]   .qr_code_scan[_ngcontent-%COMP%]{position:absolute;right:116px;top:10px;cursor:pointer}.md[_ngcontent-%COMP%]   .add_group[_ngcontent-%COMP%]{position:absolute;right:68px;top:16px;cursor:pointer}.ios[_ngcontent-%COMP%]   .add_group[_ngcontent-%COMP%]{position:absolute;right:68px;top:10px;cursor:pointer}"]}),d})()},{path:"chat-room",loadChildren:()=>Promise.all([r.e(2076),r.e(6134)]).then(r.bind(r,6134)).then(s=>s.ChatRoomPageModule)},{path:"qrelse",loadChildren:()=>r.e(851).then(r.bind(r,851)).then(s=>s.QRelsePageModule)}];let H=(()=>{var s;class d{}return(s=d).\u0275fac=function(e){return new(e||s)},s.\u0275mod=t.$C({type:s}),s.\u0275inj=t.G2t({imports:[S.iI.forChild(J),S.iI]}),d})(),L=(()=>{var s;class d{}return(s=d).\u0275fac=function(e){return new(e||s)},s.\u0275mod=t.$C({type:s}),s.\u0275inj=t.G2t({imports:[b.MD,C.YN,m.bv,H]}),d})()}}]);