"use strict";(self.webpackChunkapp=self.webpackChunkapp||[]).push([[7680],{4580:(Y,R,a)=>{a.d(R,{m:()=>$});var P=a(5193),t=a(4496),h=a(4500),E=a(5020),G=a(7136),m=a(5624),y=a(9240),O=a(4668),k=a(1368);function e(d,C){if(1&d&&(t.I0R(0,"ion-select-option",7),t.OEk(1),t.C$Y()),2&d){const c=C.$implicit;t.E7m("value",c),t.yG2(),t.oRS("",c.name," ")}}function T(d,C){if(1&d&&(t.I0R(0,"ion-select-option",7),t.OEk(1),t.C$Y()),2&d){const c=C.$implicit;t.E7m("value",c),t.yG2(),t.cNF(c.name+" ("+c.server.name+")")}}function A(d,C){if(1&d&&(t.I0R(0,"ion-select-option",7),t.OEk(1),t.C$Y()),2&d){const c=C.$implicit;t.E7m("value",c),t.yG2(),t.oRS(" ",c.urls[0],"")}}function b(d,C){if(1&d){const c=t.KQA();t.I0R(0,"ion-item",8),t.qCj("click",function(){t.usT(c);const r=t.GaO();return t.CGJ(r.scanQRCode())}),t.I0R(1,"ion-label",9),t.OEk(2),t.C$Y()()}if(2&d){const c=t.GaO();t.E7m("disabled",!c.ActKeyLength),t.yG2(2),t.cNF(c.lang.text.QuickQRShare.SendData)}}function D(d,C){if(1&d&&t.wR5(0,"img",10),2&d){const c=t.GaO();t.E7m("src",c.QRCodeSRC,t.K6U)}}let $=(()=>{var d;class C{constructor(l,r,g,f,Q,M){this.lang=l,this.global=r,this.nakama=g,this.modalCtrl=f,this.navParams=Q,this.indexed=M,this.ActKeyLength=!1,this.userInput={servers:[],groups:[],rtcserver:[]},this.servers=[],this.groups=[],this.rtcServer=[],this.NoReturn=!1}ngOnInit(){this.NoReturn=this.navParams.get("NoReturn"),this.servers=this.nakama.get_all_server_info(),this.groups=this.nakama.rearrange_group_list(),this.indexed.loadTextFromUserPath("servers/webrtc_server.json",(l,r)=>{l&&r&&(this.rtcServer=JSON.parse(r))});for(let l=this.groups.length-1;l>=0;l--)"missing"==this.groups[l].status&&this.groups.splice(l,1)}SelectGroupServer(l){this.userInput.servers=l.detail.value||[],this.information_changed()}SelectGroupChannel(l){this.userInput.groups=l.detail.value||[],this.information_changed()}SelectRTCServer(l){this.userInput.rtcserver=l.detail.value||[],this.information_changed()}information_changed(){this.result_address=`${P.uM}pjcone_pwa/`;let l="",r=0;for(let g=0,f=this.userInput.servers.length;g<f;g++)l+=r?"&":"?",l+="server=",l+=`${this.userInput.servers[g].name||""},${this.userInput.servers[g].address||""},${this.userInput.servers[g].useSSL||""},${this.userInput.servers[g].port||7350},${this.userInput.servers[g].key||""}`,r++;for(let g=0,f=this.userInput.groups.length;g<f;g++)l+=r?"&":"?",l+="group=",l+=`${this.userInput.groups[g].name},${this.userInput.groups[g].id}`,r++;if(this.userInput.rtcserver.length)for(let g=0,f=this.userInput.rtcserver.length;g<f;g++)l+=r?"&":"?",l+="rtcserver=",l+=`[${this.userInput.rtcserver[g].urls}],${this.userInput.rtcserver[g].username},${this.userInput.rtcserver[g].credential}`,r++;l?(this.result_address+=l,this.QRCodeSRC=this.global.readasQRCodeFromString(this.result_address),this.ActKeyLength=!0):(this.QRCodeSRC="",this.ActKeyLength=!1)}scanQRCode(){this.modalCtrl.dismiss(this.result_address)}}return(d=C).\u0275fac=function(l){return new(l||d)(t.GI1(h.o),t.GI1(E.A1),t.GI1(G.h),t.GI1(m.qS),t.GI1(y.a6),t.GI1(O.k))},d.\u0275cmp=t.In1({type:d,selectors:[["app-qr-share"]],decls:24,vars:14,consts:[[1,"ion-no-border"],["slot","start",3,"click"],["defaultHref",""],["multiple","true",3,"label","placeholder","ionChange"],[3,"value",4,"ngFor","ngForOf"],["button","",3,"disabled","click",4,"ngIf"],["style","width: 100%; height: auto;","alt","QRCodeSRC",3,"src",4,"ngIf"],[3,"value"],["button","",3,"disabled","click"],[1,"ion-text-center"],["alt","QRCodeSRC",2,"width","100%","height","auto",3,"src"]],template:function(l,r){1&l&&(t.I0R(0,"ion-header",0)(1,"ion-toolbar")(2,"ion-title"),t.OEk(3),t.C$Y(),t.I0R(4,"ion-buttons",1),t.qCj("click",function(){return r.modalCtrl.dismiss()}),t.wR5(5,"ion-back-button",2),t.C$Y()()(),t.I0R(6,"ion-content")(7,"ion-item-divider")(8,"ion-label"),t.OEk(9),t.C$Y()(),t.I0R(10,"ion-item")(11,"ion-select",3),t.qCj("ionChange",function(f){return r.SelectGroupServer(f)}),t.yuY(12,e,2,2,"ion-select-option",4),t.C$Y()(),t.I0R(13,"ion-item")(14,"ion-select",3),t.qCj("ionChange",function(f){return r.SelectGroupChannel(f)}),t.yuY(15,T,2,2,"ion-select-option",4),t.C$Y()(),t.I0R(16,"ion-item")(17,"ion-select",3),t.qCj("ionChange",function(f){return r.SelectRTCServer(f)}),t.yuY(18,A,2,2,"ion-select-option",4),t.C$Y()(),t.yuY(19,b,3,2,"ion-item",5),t.I0R(20,"ion-item-divider")(21,"ion-label"),t.OEk(22),t.C$Y()(),t.yuY(23,D,1,1,"img",6),t.C$Y()),2&l&&(t.yG2(3),t.cNF(r.lang.text.Settings.quickQRshare),t.yG2(6),t.cNF(r.lang.text.QuickQRShare.SelectData),t.yG2(2),t.E7m("label",r.lang.text.QuickQRShare.GroupServer)("placeholder",r.lang.text.QuickQRShare.EmptyData),t.yG2(),t.E7m("ngForOf",r.servers),t.yG2(2),t.E7m("label",r.lang.text.QuickQRShare.Group)("placeholder",r.lang.text.QuickQRShare.EmptyData),t.yG2(),t.E7m("ngForOf",r.groups),t.yG2(2),t.E7m("label",r.lang.text.WebRTCDevManager.Title)("placeholder",r.lang.text.QuickQRShare.EmptyData),t.yG2(),t.E7m("ngForOf",r.rtcServer),t.yG2(),t.E7m("ngIf",!r.NoReturn),t.yG2(3),t.cNF(r.lang.text.QuickQRShare.ReceiveData),t.yG2(),t.E7m("ngIf",r.QRCodeSRC))},dependencies:[k.ay,k.u_,m.GS,m._i,m.wB,m.Yb,m.S8,m.QR,m.Cy,m.gd,m.tM,m.Md,m.IT,m.Im]}),C})()},7680:(Y,R,a)=>{a.r(R),a.d(R,{SettingsPageModule:()=>N});var P=a(1368),t=a(4716),h=a(5624),E=a(3332),G=a(1528),m=a(4708),y=a(5193),O=a(9596),k=a(4580),e=a(4496),T=a(9240),A=a(4180),b=a(7136),D=a(4668),$=a(4500),d=a(6819),C=a(5020),c=a(544),l=a(3824);const r=["LangSel"];function g(s,_){if(1&s){const u=e.KQA();e.I0R(0,"div")(1,"ion-item-divider")(2,"ion-label"),e.OEk(3),e.C$Y()(),e.I0R(4,"ion-item",6),e.qCj("click",function(){e.usT(u);const n=e.GaO();return e.CGJ(n.go_to_page("admin-tools"))}),e.I0R(5,"ion-label"),e.OEk(6),e.C$Y()()()}if(2&s){const u=e.GaO();e.yG2(3),e.cNF(u.lang.text.Settings.admin_tools),e.yG2(3),e.cNF(u.lang.text.Settings.ServerAdmin)}}function f(s,_){if(1&s){const u=e.KQA();e.I0R(0,"ion-item",6),e.qCj("click",function(){e.usT(u);const n=e.GaO();return e.CGJ(n.go_to_page("translator"))}),e.I0R(1,"ion-label"),e.OEk(2),e.C$Y()()}if(2&s){const u=e.GaO();e.yG2(2),e.cNF(u.lang.text.Settings.AppTranslator)}}function Q(s,_){if(1&s){const u=e.KQA();e.I0R(0,"ion-item",6),e.qCj("click",function(){e.usT(u);const n=e.GaO();return e.CGJ(n.open_playstore())}),e.I0R(1,"ion-label"),e.OEk(2),e.C$Y()()}if(2&s){const u=e.GaO();e.yG2(2),e.cNF(u.lang.text.Settings.OpenPlayStore)}}const F=[{path:"",component:(()=>{var s;class _{constructor(i,n,o,v,p,I,S,j,K,L,W){this.modalCtrl=i,this.nav=n,this.statusBar=o,this.nakama=v,this.indexed=p,this.lang=I,this.noti=S,this.global=j,this.file=K,this.p5toast=L,this.loadingCtrl=W,this.cant_dedicated=!1,this.is_nativefier=y.O$,this.as_admin=[],this.availables=[],this.isAdHiding=!0,this.self={}}ngOnInit(){("DesktopPWA"==y.s1||"MobilePWA"==y.s1)&&(this.cant_dedicated=!0),this.AD_Div=document.getElementById("advertise"),this.checkAdsInfo(),this.check_if_admin(),this.nakama.on_socket_disconnected.settings_admin_check=()=>{this.check_if_admin()}}check_if_admin(){this.as_admin=this.nakama.get_all_server_info(!0,!0);for(let i=this.as_admin.length-1;i>=0;i--)this.as_admin[i].is_admin||this.as_admin.splice(i,1)}checkAdsInfo(){var i=this;return(0,G.c)(function*(){try{let n=yield fetch(`${y.uM}pjcone_ads/${i.lang.lang}.txt`);if(n.ok){let o=yield(yield n.blob()).text();i.indexed.saveTextFileToUserPath(o,"ads_list.txt");let v=o.split("\n");i.listAvailableAds(v)}}catch{i.indexed.loadTextFromUserPath("ads_list.txt",(o,v)=>{o&&v&&i.listAvailableAds(v.split("\n"))})}})()}listAvailableAds(i){let o,n=(new Date).getTime();this.availables.length=0;for(let p=0,I=i.length;p<I;p++){let S=i[p].split(",");Number(S[0])<n?n<Number(S[1])&&this.availables.push([Number(S[0]),Number(S[1]),S[2]]):o?Number(S[0])<o&&(o=Number(S[0])):o=Number(S[0])}let v=this.AD_Div.childNodes;this.isAdHiding=!0,v.forEach(p=>{p.remove()}),this.availables.length?this.displayRandomAds():o&&(this.refreshAds=setTimeout(()=>{this.indexed.loadTextFromUserPath("ads_list.txt",(p,I)=>{p&&I&&this.listAvailableAds(I.split("\n"))})},o-(new Date).getTime()))}displayRandomAds(){let i=Math.floor(Math.random()*this.availables.length),n=this.availables[i];this.refreshAds=setTimeout(()=>{this.indexed.loadTextFromUserPath("ads_list.txt",(v,p)=>{v&&p&&this.listAvailableAds(p.split("\n"))})},n[1]-(new Date).getTime());let o=document.createElement("iframe");o.id="AdFrame",o.setAttribute("src",n[2]),o.setAttribute("frameborder","0"),o.setAttribute("class","full_screen"),this.isAdHiding=!1,this.AD_Div.appendChild(o)}open_link(i){window.open(i,"_system")}ionViewWillEnter(){this.profile_filter="online"==this.statusBar.settings.groupServer?"filter: grayscale(0) contrast(1);":"filter: grayscale(.9) contrast(1.4);",this.check_if_admin()}ionViewDidEnter(){this.global.p5key.KeyShortCut.Escape=()=>{this.nav.pop()};let i=[];i.push(()=>this.go_to_page("noti-alert")),i.push(()=>this.go_to_qr_share()),i.push(()=>this.open_inapp_explorer()),i.push(()=>this.go_to_page("weblink-gen")),i.push(()=>this.go_to_webrtc_manager()),i.push(()=>this.download_serverfile()),this.as_admin.length&&i.push(()=>this.go_to_page("admin-tools")),i.push(()=>this.go_to_page("creator")),"ko"!=this.lang.lang&&i.push(()=>this.go_to_page("translator")),i.push(()=>this.LangClicked()),i.push(()=>this.go_to_page("licenses")),this.cant_dedicated&&i.push(()=>this.open_playstore()),this.global.p5key.KeyShortCut.Digit=n=>{i[n]&&i[n]()}}open_inapp_explorer(){this.nav.navigateForward("user-fs-dir",{animation:m.uw})}LangClicked(){this.LangSel.open()}LanguageChanged(i){this.lang.lang=i.detail.value,this.lang.load_selected_lang()}go_to_page(i){this.nav.navigateForward(`portal/settings/${i}`,{animation:m.uw})}download_serverfile(){var i=this;return(0,G.c)(function*(){if("Android"==y.s1||"iOS"==y.s1){let n=yield i.loadingCtrl.create({message:i.lang.text.TodoDetail.WIP});n.present();let o="nakama.zip",v=yield fetch("assets/data/nakama.zip").then(p=>p.blob());try{yield i.file.writeFile(i.file.externalDataDirectory,o,v),n.dismiss(),i.p5toast.show({text:i.lang.text.ContentViewer.fileSaved})}catch(p){console.log("download_serverfile: ",p);try{yield i.file.writeExistingFile(i.file.externalDataDirectory,o,v),n.dismiss(),i.p5toast.show({text:i.lang.text.ContentViewer.fileSaved})}catch(I){console.log("download_serverfile_rewrite: ",I),n.dismiss(),i.p5toast.show({text:i.lang.text.ContentViewer.fileSaveFailed})}}}else{let n=document.createElement("a");n.download="nakama.zip",n.href="assets/data/nakama.zip",document.body.appendChild(n),n.click(),document.body.removeChild(n),n.remove(),i.p5toast.show({text:i.lang.text.ContentViewer.fileSaved})}})()}go_to_qr_share(){this.modalCtrl.create({component:k.m,componentProps:{NoReturn:!0}}).then(i=>{delete this.global.p5key.KeyShortCut.Escape,delete this.global.p5key.KeyShortCut.Digit,i.onDidDismiss().then(()=>{this.ionViewDidEnter()}),i.present()})}go_to_webrtc_manager(){this.modalCtrl.create({component:O.I}).then(i=>{delete this.global.p5key.KeyShortCut.Escape,delete this.global.p5key.KeyShortCut.Digit,i.onDidDismiss().then(()=>{this.ionViewDidEnter()}),i.present()})}open_playstore(){window.open("https://play.google.com/store/apps/details?id=org.pjcone.portal","_system")}ionViewWillLeave(){delete this.global.p5key.KeyShortCut.Escape,delete this.global.p5key.KeyShortCut.Digit}ngOnDestroy(){delete this.nakama.on_socket_disconnected.settings_admin_check,clearTimeout(this.refreshAds)}}return(s=_).\u0275fac=function(i){return new(i||s)(e.GI1(h.qS),e.GI1(T.wX),e.GI1(A.Y),e.GI1(b.h),e.GI1(D.k),e.GI1($.o),e.GI1(d.s),e.GI1(C.A1),e.GI1(c.S),e.GI1(l.O),e.GI1(h.Kg))},s.\u0275cmp=e.In1({type:s,selectors:[["app-settings"]],viewQuery:function(i,n){if(1&i&&e.CC$(r,5),2&i){let o;e.wto(o=e.Gqi())&&(n.LangSel=o.first)}},decls:61,vars:21,consts:[[1,"ion-no-border"],["slot","start"],["defaultHref","portal/main"],[3,"hidden"],["slot","end","fill","clear","shape","round",3,"click"],["id","advertise",1,"advertise_banner"],["button","",3,"click"],["value","Devkit"],["slot","header"],["slot","content"],[4,"ngIf"],["button","",3,"click",4,"ngIf"],["name","language",1,"icon_margin"],[2,"pointer-events","none",3,"label","value","placeholder","ionChange"],["LangSel",""],["value","en"],["value","ko"]],template:function(i,n){1&i&&(e.I0R(0,"ion-header",0)(1,"ion-toolbar")(2,"ion-title"),e.OEk(3),e.C$Y(),e.I0R(4,"ion-buttons",1),e.wR5(5,"ion-back-button",2),e.C$Y()()(),e.I0R(6,"ion-content")(7,"div",3)(8,"ion-item-divider")(9,"ion-label"),e.OEk(10),e.C$Y(),e.I0R(11,"ion-button",4),e.qCj("click",function(){return n.open_link("https://is2you2.github.io/")}),e.OEk(12),e.C$Y()(),e.wR5(13,"div",5),e.C$Y(),e.I0R(14,"ion-item-divider")(15,"ion-label"),e.OEk(16),e.C$Y()(),e.I0R(17,"ion-item",6),e.qCj("click",function(){return n.go_to_page("noti-alert")}),e.I0R(18,"ion-label"),e.OEk(19),e.C$Y()(),e.I0R(20,"ion-item",6),e.qCj("click",function(){return n.go_to_qr_share()}),e.I0R(21,"ion-label"),e.OEk(22),e.C$Y()(),e.I0R(23,"ion-item",6),e.qCj("click",function(){return n.open_inapp_explorer()}),e.I0R(24,"ion-label"),e.OEk(25),e.C$Y()(),e.I0R(26,"ion-accordion-group")(27,"ion-accordion",7)(28,"ion-item",8)(29,"ion-label"),e.OEk(30),e.C$Y()(),e.I0R(31,"div",9)(32,"ion-item",6),e.qCj("click",function(){return n.go_to_page("weblink-gen")}),e.I0R(33,"ion-label"),e.OEk(34),e.C$Y()(),e.I0R(35,"ion-item",6),e.qCj("click",function(){return n.go_to_webrtc_manager()}),e.I0R(36,"ion-label"),e.OEk(37),e.C$Y()(),e.I0R(38,"ion-item",6),e.qCj("click",function(){return n.download_serverfile()}),e.I0R(39,"ion-label"),e.OEk(40),e.C$Y()()()()(),e.yuY(41,g,7,2,"div",10),e.I0R(42,"ion-item-divider")(43,"ion-label"),e.OEk(44),e.C$Y()(),e.I0R(45,"ion-item",6),e.qCj("click",function(){return n.go_to_page("creator")}),e.I0R(46,"ion-label"),e.OEk(47),e.C$Y()(),e.yuY(48,f,3,1,"ion-item",11),e.I0R(49,"ion-item",6),e.qCj("click",function(){return n.LangClicked()}),e.wR5(50,"ion-icon",12),e.I0R(51,"ion-select",13,14),e.qCj("ionChange",function(v){return n.LanguageChanged(v)}),e.I0R(53,"ion-select-option",15),e.OEk(54,"English"),e.C$Y(),e.I0R(55,"ion-select-option",16),e.OEk(56,"\ud55c\uad6d\uc5b4"),e.C$Y()()(),e.I0R(57,"ion-item",6),e.qCj("click",function(){return n.go_to_page("licenses")}),e.I0R(58,"ion-label"),e.OEk(59),e.C$Y()(),e.yuY(60,Q,3,1,"ion-item",11),e.C$Y()),2&i&&(e.yG2(3),e.cNF(n.lang.text.Settings.Title),e.yG2(4),e.E7m("hidden",n.isAdHiding),e.yG2(3),e.cNF(n.lang.text.Settings.CommunityAds),e.yG2(2),e.oRS(" ",n.lang.text.Settings.AdsContact," "),e.yG2(4),e.cNF(n.lang.text.Settings.env_info),e.yG2(3),e.cNF(n.lang.text.Settings.NotificationSetting),e.yG2(3),e.cNF(n.lang.text.Settings.quickQRshare),e.yG2(3),e.cNF(n.lang.text.Settings.InAppExplorer),e.yG2(5),e.cNF(n.lang.text.Settings.DevKit),e.yG2(4),e.cNF(n.lang.text.Settings.WebLinkGen),e.yG2(3),e.cNF(n.lang.text.WebRTCDevManager.Title),e.yG2(3),e.cNF(n.lang.text.Settings.ServerFiles),e.yG2(),e.E7m("ngIf",n.as_admin.length),e.yG2(3),e.cNF(n.lang.text.Settings.AppInfo),e.yG2(3),e.cNF(n.lang.text.Settings.AppCreator),e.yG2(),e.E7m("ngIf","ko"!=n.lang.lang),e.yG2(3),e.E7m("label",n.lang.text.Settings.AppLanguage)("value",n.lang.lang)("placeholder",n.lang.lang),e.yG2(8),e.cNF(n.lang.text.Settings.LicenseNotice),e.yG2(),e.E7m("ngIf",n.cant_dedicated))},dependencies:[P.u_,h.cm,h.qU,h.sn,h.GS,h._i,h.wB,h.Ko,h.Yb,h.S8,h.QR,h.Cy,h.gd,h.tM,h.Md,h.IT,h.Im],styles:[".advertise_banner[_ngcontent-%COMP%]{width:100%;max-height:150px}.img_icon_size[_ngcontent-%COMP%]{width:21px;height:21px;margin-right:16px}.icon_margin[_ngcontent-%COMP%]{margin-right:16px}"]}),_})()},{path:"licenses",loadChildren:()=>a.e(6768).then(a.bind(a,6768)).then(s=>s.LicensesPageModule)},{path:"group-server",loadChildren:()=>a.e(8928).then(a.bind(a,8928)).then(s=>s.GroupServerPageModule)},{path:"add-group",loadChildren:()=>Promise.all([a.e(9492),a.e(148)]).then(a.bind(a,7768)).then(s=>s.AddGroupPageModule)},{path:"group-detail",loadChildren:()=>a.e(1588).then(a.bind(a,9208)).then(s=>s.GroupDetailPageModule)},{path:"translator",loadChildren:()=>a.e(9236).then(a.bind(a,9236)).then(s=>s.TranslatorPageModule)},{path:"creator",loadChildren:()=>a.e(4984).then(a.bind(a,4984)).then(s=>s.CreatorPageModule)},{path:"qr-share",loadChildren:()=>a.e(5056).then(a.bind(a,5056)).then(s=>s.QrSharePageModule)},{path:"noti-alert",loadChildren:()=>a.e(7816).then(a.bind(a,7816)).then(s=>s.NotiAlertPageModule)},{path:"admin-tools",loadChildren:()=>a.e(6710).then(a.bind(a,6710)).then(s=>s.AdminToolsPageModule)},{path:"weblink-gen",loadChildren:()=>a.e(3544).then(a.bind(a,3544)).then(s=>s.WeblinkGenPageModule)}];let x=(()=>{var s;class _{}return(s=_).\u0275fac=function(i){return new(i||s)},s.\u0275mod=e.a4G({type:s}),s.\u0275inj=e.s3X({imports:[E.qQ.forChild(F),E.qQ]}),_})(),N=(()=>{var s;class _{}return(s=_).\u0275fac=function(i){return new(i||s)},s.\u0275mod=e.a4G({type:s}),s.\u0275inj=e.s3X({imports:[P.MD,t.y,h.wZ,x]}),_})()}}]);