"use strict";(self.webpackChunkapp=self.webpackChunkapp||[]).push([[634],{634:(P,g,i)=>{i.r(g),i.d(g,{CommunityServerPageModule:()=>M});var u=i(9808),l=i(4182),o=i(3996),m=i(501),c=i(6505),h=i(358),e=i(2096),v=i(4606),S=i(2855),C=i(5742),f=i(2313),y=i(3336);function p(s,a){if(1&s&&e._UZ(0,"img",10),2&s){const n=e.oxw();e.Q6J("src",n.QRCodeSRC,e.LSH)}}const _=[{path:"",component:(()=>{class s{constructor(n,t,d,r,w){this.statusBar=n,this.wsc=t,this.lang=d,this.sanitizer=r,this.p5toast=w,this.info="",this.address_override="",this.useSSL=!1}ngOnInit(){this.address_override=this.wsc.address_override,this.useSSL="wss"==this.wsc.socket_header,new c(n=>{n.setup=()=>{n.loadStrings(`assets/data/infos/${this.lang.lang}/community-server.txt`,t=>{this.info=t.join("\n"),n.remove()})}}),this.readasQRCodeFromId()}readasQRCodeFromId(){try{let n={type:"comm_server",value:{address_override:this.address_override.replace(/[^0-9.]/g,""),useSSL:this.useSSL}},t=new h({content:`[${JSON.stringify(n)}]`,padding:4,width:8,height:8,color:"#bbb",background:"#111",ecl:"M"}).svg();this.QRCodeSRC=this.sanitizer.bypassSecurityTrustUrl(`data:image/svg+xml;base64,${btoa(t)}`)}catch(n){this.p5toast.show({text:`${this.lang.text.LinkAccount.failed_to_gen_qr}: ${n}`})}}reconn_community_server(){"offline"==this.statusBar.settings.communityServer?this.wsc.initialize():this.wsc.client.close()}on_address_changed(n){n.detail.value!=this.wsc.address_override&&(this.wsc.address_override=this.address_override.replace(/[^0-9.]/g,""),this.wsc.address_override||(this.useSSL=!1,this.toggle_useSSL()),localStorage.setItem("wsc_address_override",this.wsc.address_override),this.wsc.client.close()),this.readasQRCodeFromId()}toggle_useSSL(){this.useSSL=!this.useSSL,this.wsc.socket_header=this.useSSL?"wss":"ws",localStorage.setItem("wsc_socket_header",this.wsc.socket_header),this.wsc.client.close(),this.readasQRCodeFromId()}}return s.\u0275fac=function(n){return new(n||s)(e.Y36(v.g),e.Y36(S.Z),e.Y36(C.b),e.Y36(f.H7),e.Y36(y.F))},s.\u0275cmp=e.Xpm({type:s,selectors:[["app-community-server"]],decls:24,vars:12,consts:[["slot","start"],["defaultHref","settings"],["disabled","",1,"infobox",2,"height","350px",3,"ngModel","ngModelChange"],["button","",3,"click"],[1,"additional_form","status_bar_single"],[1,"form_margin"],["type","text",1,"ion-text-end",3,"ngModel","ngModelChange","ionChange"],["button","",3,"disabled","click"],["slot","end",2,"pointer-events","none",3,"ngModel","ngModelChange"],["style","width: 100%; height: auto;","alt","Loading",3,"src",4,"ngIf"],["alt","Loading",2,"width","100%","height","auto",3,"src"]],template:function(n,t){1&n&&(e.TgZ(0,"ion-header")(1,"ion-toolbar")(2,"ion-title"),e._uU(3),e.qZA(),e.TgZ(4,"ion-buttons",0),e._UZ(5,"ion-back-button",1),e.qZA()()(),e.TgZ(6,"ion-content")(7,"ion-item-divider")(8,"ion-label"),e._uU(9),e.qZA()(),e.TgZ(10,"textarea",2),e.NdJ("ngModelChange",function(r){return t.info=r}),e.qZA(),e.TgZ(11,"ion-item-divider")(12,"ion-label"),e._uU(13),e.qZA()(),e.TgZ(14,"ion-item",3),e.NdJ("click",function(){return t.reconn_community_server()}),e._UZ(15,"div",4),e.TgZ(16,"ion-label",5),e._uU(17),e.qZA(),e.TgZ(18,"ion-input",6),e.NdJ("ngModelChange",function(r){return t.address_override=r})("ionChange",function(r){return t.on_address_changed(r)}),e.qZA()(),e.TgZ(19,"ion-item",7),e.NdJ("click",function(){return t.toggle_useSSL()}),e.TgZ(20,"ion-label"),e._uU(21),e.qZA(),e.TgZ(22,"ion-toggle",8),e.NdJ("ngModelChange",function(r){return t.useSSL=r}),e.qZA()(),e.YNc(23,p,1,1,"img",9),e.qZA()),2&n&&(e.xp6(3),e.Oqu(t.lang.text.Settings.commServer),e.xp6(6),e.Oqu(t.lang.text.CommunityServer.AboutCommServer),e.xp6(1),e.Q6J("ngModel",t.info),e.xp6(3),e.Oqu(t.lang.text.CommunityServer.ServerStatus),e.xp6(2),e.Akn("background-color: "+t.statusBar.colors[t.statusBar.settings.communityServer]),e.xp6(2),e.Oqu(t.lang.text.CommunityServer.AddressInfo),e.xp6(1),e.Q6J("ngModel",t.address_override),e.xp6(1),e.Q6J("disabled",!t.address_override),e.xp6(2),e.Oqu(t.lang.text.CommunityServer.isSSL),e.xp6(1),e.Q6J("ngModel",t.useSSL),e.xp6(1),e.Q6J("ngIf",t.address_override))},directives:[o.Gu,o.sr,o.wd,o.Sm,o.oU,o.cs,o.W2,o.rH,o.Q$,l.Fj,l.JJ,l.On,o.Ie,o.pK,o.j9,o.ho,o.w,u.O5],styles:[""]}),s})()}];let Z=(()=>{class s{}return s.\u0275fac=function(n){return new(n||s)},s.\u0275mod=e.oAB({type:s}),s.\u0275inj=e.cJS({imports:[[m.Bz.forChild(_)],m.Bz]}),s})(),M=(()=>{class s{}return s.\u0275fac=function(n){return new(n||s)},s.\u0275mod=e.oAB({type:s}),s.\u0275inj=e.cJS({imports:[[u.ez,l.u5,o.Pc,Z]]}),s})()}}]);