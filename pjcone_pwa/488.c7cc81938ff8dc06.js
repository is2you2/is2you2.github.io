"use strict";(self.webpackChunkapp=self.webpackChunkapp||[]).push([[488],{6069:(k,v,a)=>{a.d(v,{R:()=>T});var s=a(2096),g=a(3996),h=a(5742),f=a(4182);let T=(()=>{class u{constructor(_,l,e){this.navParams=_,this.modalCtrl=l,this.lang=e,this.info="QR\ucf54\ub4dc \ub610\ub294 \ubc14\ucf54\ub4dc\ub97c \uc778\uc2dd\ud558\uc600\uc73c\ub098 \uc774 \uc571\uc5d0\uc11c \uc0ac\uc6a9\ud558\ub294 \uad6c\uc131\uc774 \uc544\ub2d9\ub2c8\ub2e4.",this.result={}}ngOnInit(){this.result=this.navParams.get("result")}}return u.\u0275fac=function(_){return new(_||u)(s.Y36(g.X1),s.Y36(g.IN),s.Y36(h.b))},u.\u0275cmp=s.Xpm({type:u,selectors:[["app-qrelse"]],decls:22,vars:6,consts:[["slot","start",3,"click"],["defaultHref","subscribes"],["disabled","",1,"infobox",3,"ngModel","ngModelChange"]],template:function(_,l){1&_&&(s.TgZ(0,"ion-header")(1,"ion-toolbar")(2,"ion-title"),s._uU(3,"\ub0b4\uc6a9 \uc77d\uae30"),s.qZA(),s.TgZ(4,"ion-buttons",0),s.NdJ("click",function(){return l.modalCtrl.dismiss()}),s._UZ(5,"ion-back-button",1),s.qZA()()(),s.TgZ(6,"ion-content")(7,"ion-item-divider")(8,"ion-label"),s._uU(9),s.qZA()(),s.TgZ(10,"textarea",2),s.NdJ("ngModelChange",function(b){return l.lang.text.QRElse.info=b}),s.qZA(),s._UZ(11,"ion-item-divider"),s.TgZ(12,"ion-item")(13,"ion-label")(14,"p"),s._uU(15),s.qZA(),s.TgZ(16,"h2"),s._uU(17),s.qZA()()(),s.TgZ(18,"ion-item-divider")(19,"ion-label"),s._uU(20),s.qZA()(),s.TgZ(21,"textarea",2),s.NdJ("ngModelChange",function(b){return l.result.text=b}),s.qZA()()),2&_&&(s.xp6(9),s.Oqu(l.lang.text.QRElse.Title),s.xp6(1),s.Q6J("ngModel",l.lang.text.QRElse.info),s.xp6(5),s.Oqu(l.lang.text.QRElse.format),s.xp6(2),s.Oqu(l.result.format),s.xp6(3),s.Oqu(l.lang.text.QRElse.contents),s.xp6(1),s.Q6J("ngModel",l.result.text))},directives:[g.Gu,g.sr,g.wd,g.Sm,g.oU,g.cs,g.W2,g.rH,g.Q$,f.Fj,f.JJ,f.On,g.Ie],styles:[""]}),u})()},488:(k,v,a)=>{a.r(v),a.d(v,{SubscribesPageModule:()=>D});var s=a(9808),g=a(4182),h=a(3996),f=a(501),T=a(655),u=a(5016),x=a(3041),_=a(6069),l=a(1716),e=a(2096),b=a(9645),C=a(3336),P=a(4606);let A=(()=>{class i{constructor(t){this.statusBar=t,this.list={}}initialize(t,n,o,c){if(!this.statusBar.tools[t])throw new Error(`\uadf8\ub7f0 \ud234\uc740 \uc5c6\uc2b5\ub2c8\ub2e4: ${t}`);if(this.statusBar.tools[t]="pending","DesktopPWA"!=u.n$&&"MobilePWA"!=u.n$){if(null!=this.list[t])return void console.warn("\ub3d9\uc77c\ud55c \uc11c\ubc84 \uad6c\uc131\uc774 \uc774\ubbf8 \uc874\uc7ac\ud568: ",this.list);this.list[t]={},this.list[t].server||(this.list[t].server=cordova.plugins.wsserver),this.list[t].server.start(n,{onFailure:(d,m,p)=>{this.onServerClose(t)},onOpen:d=>{this.list[t].target==d.remoteAddr?this.list[t].users=d.uuid:(console.log("\ud5c8\uc6a9\ub418\uc9c0 \uc54a\uc740 \uc0ac\uc6a9\uc790: ",this.list[t].target,"/=",d.remoteAddr),this.list[t].server.close({uuid:d.uuid},4001,"\ud5c8\uc6a9\ub418\uc9c0 \uc54a\uc740 \uc0ac\uc6a9\uc790")),this.onClientConnected(t)},onMessage:(d,m)=>{try{let p=JSON.parse(m);c(p)}catch(p){console.error(`Tool-server_json \ubcc0\ud658 \uc624\ub958_${m}: ${p}`)}},onClose:(d,m,p,S)=>{this.stop(t)},origins:[],protocols:[],tcpNoDelay:!0},(d,m)=>{this.onServerOpen(t),o()},d=>{this.onServerClose(t)})}else this.onServerClose(t)}stop(t){"DesktopPWA"!=u.n$&&"MobilePWA"!=u.n$&&this.list[t].server.stop((n,o)=>{this.onServerClose(t),delete this.list[t]})}onServerOpen(t){console.log("test onServerOpen: ",t),this.statusBar.tools[t]="online"}onClientConnected(t){this.statusBar.tools[t]="certified"}onServerClose(t){this.statusBar.tools[t]="missing",setTimeout(()=>{this.statusBar.tools[t]="offline"},500)}check_addresses(t,n){"DesktopPWA"!=u.n$&&"MobilePWA"!=u.n$&&(this.list[t].server||(this.list[t].server=cordova.plugins.wsserver),this.list[t].server.getInterfaces(o=>{n(o)}))}send_to(t,n){let o=Object.keys(this.list[t].users)[0];this.list[t].server.send({uuid:o},n)}}return i.\u0275fac=function(t){return new(t||i)(e.LFG(P.g))},i.\u0275prov=e.Yz7({token:i,factory:i.\u0275fac,providedIn:"root"}),i})();var Z=a(2855);let O=(()=>{class i{constructor(t){this.wsc=t}initialize(t){this.client=new WebSocket(`${this.wsc.socket_header}://${this.wsc.address_override||u.GA}:12020`),this.client.onopen=o=>{this.client.send(JSON.stringify(t))},setTimeout(()=>{this.client.close()},5e3)}}return i.\u0275fac=function(t){return new(t||i)(e.LFG(Z.Z))},i.\u0275prov=e.Yz7({token:i,factory:i.\u0275fac,providedIn:"root"}),i})();var M=a(9912),y=a(5742);function w(i,r){if(1&i){const t=e.EpF();e.TgZ(0,"ion-item",10),e.NdJ("click",function(){e.CHM(t);const o=e.oxw().$implicit;return e.oxw(2).check_notifications(o)}),e.TgZ(1,"ion-label"),e._uU(2),e.qZA()()}if(2&i){const t=e.oxw().$implicit,n=e.oxw(2);e.xp6(2),e.Oqu(n.nakama.notifications_rearrange[t].request)}}function Q(i,r){if(1&i&&(e.TgZ(0,"div"),e.YNc(1,w,3,1,"ion-item",9),e.qZA()),2&i){const t=r.$implicit,n=e.oxw(2);e.xp6(1),e.Q6J("ngIf",n.nakama.notifications_rearrange.length>t)}}const R=function(){return[0,1,2]};function E(i,r){if(1&i&&(e.TgZ(0,"ion-accordion-group",3,4)(2,"ion-accordion",5)(3,"ion-item",6)(4,"ion-label"),e._uU(5),e.qZA()(),e.TgZ(6,"ion-list",7),e.YNc(7,Q,2,1,"div",8),e.qZA()()()),2&i){const t=e.oxw();e.Q6J("value",!1),e.xp6(5),e.Oqu(t.lang.text.Subscribes.has_noties),e.xp6(2),e.Q6J("ngForOf",e.DdM(3,R))}}function B(i,r){if(1&i){const t=e.EpF();e.TgZ(0,"div")(1,"ion-item-divider")(2,"ion-label"),e._uU(3),e.qZA()(),e.TgZ(4,"ion-item",10),e.NdJ("click",function(){return e.CHM(t),e.oxw().scanQRCode()}),e.TgZ(5,"ion-label",11),e._uU(6),e.qZA()()()}if(2&i){const t=e.oxw();e.xp6(3),e.Oqu(t.lang.text.Subscribes.almighty_link),e.xp6(3),e.Oqu(t.lang.text.Subscribes.almighty_button)}}function I(i,r){if(1&i&&(e.TgZ(0,"ion-item",12)(1,"ion-label"),e._uU(2),e.qZA()()),2&i){const t=e.oxw();e.xp6(2),e.Oqu(t.lang.text.Subscribes.noChatList)}}function J(i,r){1&i&&e._UZ(0,"div",21)}function N(i,r){if(1&i&&e._UZ(0,"img",22),2&i){const t=e.oxw().$implicit;e.Akn("online"==t.status?"filter: grayscale(0) contrast(1)":"filter: grayscale(.9) contrast(1.4)"),e.Q6J("src",t.info.img,e.LSH)}}function $(i,r){if(1&i){const t=e.EpF();e.TgZ(0,"ion-item",10),e.NdJ("click",function(){const c=e.CHM(t).$implicit;return e.oxw(2).go_to_chatroom(c)}),e.TgZ(1,"div",14),e.YNc(2,J,1,0,"div",15),e.qZA(),e.TgZ(3,"div",16),e.YNc(4,N,1,3,"img",17),e.qZA(),e.TgZ(5,"ion-label")(6,"div",18)(7,"table")(8,"tr")(9,"td"),e._uU(10),e.qZA(),e.TgZ(11,"td",19),e._uU(12),e.qZA()()()(),e.TgZ(13,"div",20),e._uU(14),e.qZA()()()}if(2&i){const t=r.$implicit,n=e.oxw(2);e.xp6(1),e.Akn("background-color: "+n.statusBar.colors[t.status||"offline"]),e.xp6(1),e.Q6J("ngIf",t.is_new),e.xp6(2),e.Q6J("ngIf",t.info),e.xp6(6),e.hij(" ",t.info?t.info.name||t.info.display_name||n.lang.text.Subscribes.noTitiedChat:t.title||n.lang.text.Subscribes.noTitiedChat," "),e.xp6(2),e.hij(" ","("+t.server.target+")"," "),e.xp6(2),e.hij(" ",t.last_comment||t.noti||n.lang.text.Subscribes.noMessageHistory," ")}}function U(i,r){if(1&i&&(e.TgZ(0,"div"),e.YNc(1,$,15,7,"ion-item",13),e.qZA()),2&i){const t=e.oxw();e.xp6(1),e.Q6J("ngForOf",t.nakama.channels)}}const Y=[{path:"",component:(()=>{class i{constructor(t,n,o,c,d,m,p,S,F){this.modalCtrl=t,this.codescan=n,this.p5toast=o,this.tools=c,this.weblink=d,this.nakama=m,this.statusBar=p,this.wsc=S,this.lang=F,this.cant_scan=!1,this.lock_chatroom=!1}ngOnInit(){("DesktopPWA"==u.n$||"MobilePWA"==u.n$)&&(this.cant_scan=!0),this.add_admob_banner()}ionViewDidEnter(){this.nakama.subscribe_lock=!0,this.nakama.resumeBanner()}add_admob_banner(){return(0,T.mG)(this,void 0,void 0,function*(){l.TQ.addListener(l.Wp.SizeChanged,n=>{this.nakama.appMargin=n.height;const o=document.querySelector("ion-router-outlet");0===this.nakama.appMargin?o.style.marginBottom="":this.nakama.appMargin>0&&(o.style.marginBottom=this.nakama.appMargin+"px")});const t={adId:"ca-app-pub-6577630868247944/4829889344",adSize:l.ci.ADAPTIVE_BANNER,position:l.N4.BOTTOM_CENTER};try{if(!(yield fetch(`${u.Oy}pjcone_ads/admob.txt`)).ok)throw new Error("\uc5c6\ub294\uac70\ub098 \ub2e4\ub984\uc5c6\uc9c0")}catch(n){l.TQ.showBanner(t).then(()=>{this.nakama.isBannerShowing=!0})}})}scanQRCode(){this.codescan.scan({disableSuccessBeep:!0,disableAnimations:!0,resultDisplayDuration:0}).then(t=>{if(!t.cancelled)try{let n=JSON.parse(t.text.trim());if(this.wsc.client.readyState!=this.wsc.client.OPEN)return void this.p5toast.show({text:this.lang.text.Subscribes.needLinkWithCommServ});for(let o=0,c=n.length;o<c;o++)switch(n[o].type){case"link":this.weblink.initialize({pid:n[o].value,uuid:this.nakama.uuid});break;case"tools":this.create_tool_server(n[o].value);break;case"server":this.nakama.add_group_server(n[o].value);break;case"group":this.nakama.try_add_group(n[o]);break;default:throw new Error("\uc9c0\uc815\ub41c \ud2c0 \uc544\ub2d8")}}catch(n){console.error("scanQRCode_failed: ",n),this.modalCtrl.create({component:_.R,componentProps:{result:t}}).then(o=>o.present())}}).catch(t=>{console.error(t),this.p5toast.show({text:this.lang.text.Subscribes.CameraPermissionDenied,lateable:!0})})}create_tool_server(t){let n,o=c=>console.warn(`${t.name}_create_tool_server_onMessage: ${c}`);if("engineppt"!==t.name)throw new Error(`\uc9c0\uc815\ub41c \ud234 \uc815\ubcf4\uac00 \uc544\ub2d8: ${t}`);n=12021,o=c=>{console.log("engineppt init test: ",c)},this.tools.initialize(t.name,12021,()=>{this.tools.check_addresses(t.name,c=>{let d=Object.keys(c),m=[];for(let p=0,S=d.length;p<S;p++)m=[...m,...c[d[p]].ipv4Addresses];this.weblink.initialize({from:"mobile",pid:t.client,addresses:m})})},o)}go_to_chatroom(t){this.lock_chatroom||(this.lock_chatroom=!0,this.modalCtrl.create({component:x.P,componentProps:{info:t}}).then(n=>{this.nakama.go_to_chatroom_without_admob_act(n),this.lock_chatroom=!1}))}check_notifications(t){let n=this.nakama.notifications_rearrange[t].server;this.nakama.check_notifications(this.nakama.notifications_rearrange[t],n.isOfficial,n.target)}ionViewWillLeave(){this.nakama.subscribe_lock=!1,this.nakama.removeBanner()}}return i.\u0275fac=function(t){return new(t||i)(e.Y36(h.IN),e.Y36(b.m),e.Y36(C.F),e.Y36(A),e.Y36(O),e.Y36(M.a),e.Y36(P.g),e.Y36(Z.Z),e.Y36(y.b))},i.\u0275cmp=e.Xpm({type:i,selectors:[["app-subscribes"]],decls:12,vars:6,consts:[["value","colors","expand","inset",3,"value",4,"ngIf"],[4,"ngIf"],["button","","disabled","",4,"ngIf"],["value","colors","expand","inset",3,"value"],["accordionGroup",""],["value","colors"],["slot","header"],["slot","content"],[4,"ngFor","ngForOf"],["button","",3,"click",4,"ngIf"],["button","",3,"click"],[1,"ion-text-center"],["button","","disabled",""],["button","",3,"click",4,"ngFor","ngForOf"],[1,"additional_form","status_bar_double"],["class","new_circle",4,"ngIf"],[1,"additional_form","bg_img_form"],["class","bg_img",3,"style","src",4,"ngIf"],[1,"form_margin","header"],[1,"server_target"],[1,"form_margin","content"],[1,"new_circle"],[1,"bg_img",3,"src"]],template:function(t,n){1&t&&(e.TgZ(0,"ion-header")(1,"ion-toolbar")(2,"ion-title"),e._uU(3),e.qZA()()(),e.TgZ(4,"ion-content"),e.YNc(5,E,8,4,"ion-accordion-group",0),e.YNc(6,B,7,2,"div",1),e.TgZ(7,"ion-item-divider")(8,"ion-label"),e._uU(9),e.qZA()(),e.YNc(10,I,3,1,"ion-item",2),e.YNc(11,U,2,1,"div",1),e.qZA()),2&t&&(e.xp6(3),e.Oqu(n.lang.text.Subscribes.Title),e.xp6(2),e.Q6J("ngIf",n.nakama.notifications_rearrange.length),e.xp6(1),e.Q6J("ngIf",!n.cant_scan),e.xp6(3),e.Oqu(n.lang.text.Subscribes.Chat),e.xp6(1),e.Q6J("ngIf",!n.nakama.channels.length),e.xp6(1),e.Q6J("ngIf",n.nakama.channels.length))},directives:[h.Gu,h.sr,h.wd,h.W2,s.O5,h.eh,h.We,h.Ie,h.Q$,h.q_,s.sg,h.rH],styles:[".header[_ngcontent-%COMP%]{padding-bottom:4px}.content[_ngcontent-%COMP%]{color:#888;height:24px;display:table-cell;vertical-align:middle;padding:0 16px}.status_bar[_ngcontent-%COMP%]{width:5px;height:76%}.server_target[_ngcontent-%COMP%]{color:#888;padding-left:4px}.new_circle[_ngcontent-%COMP%]{position:relative;top:-5px;left:9px;width:8px;height:8px;border-radius:4px;background:#ff4961}"]}),i})()},{path:"chat-room",loadChildren:()=>a.e(9340).then(a.bind(a,9340)).then(i=>i.ChatRoomPageModule)},{path:"qrelse",loadChildren:()=>a.e(1388).then(a.bind(a,1388)).then(i=>i.QRelsePageModule)}];let W=(()=>{class i{}return i.\u0275fac=function(t){return new(t||i)},i.\u0275mod=e.oAB({type:i}),i.\u0275inj=e.cJS({imports:[[f.Bz.forChild(Y)],f.Bz]}),i})(),D=(()=>{class i{}return i.\u0275fac=function(t){return new(t||i)},i.\u0275mod=e.oAB({type:i}),i.\u0275inj=e.cJS({imports:[[s.ez,g.u5,h.Pc,W]]}),i})()}}]);