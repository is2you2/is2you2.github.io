"use strict";(self.webpackChunkapp=self.webpackChunkapp||[]).push([[542],{1186:(F,k,c)=>{c.d(k,{M:()=>_});const _=(0,c(2726).fo)("SpeechRecognition",{web:()=>c.e(4850).then(c.bind(c,7554)).then(A=>new A.SpeechRecognitionWeb)})},5961:(F,k,c)=>{c.d(k,{GW:()=>_,dk:()=>A,oK:()=>p});var p=function(i){return i.Prompt="PROMPT",i.Camera="CAMERA",i.Photos="PHOTOS",i}(p||{}),_=function(i){return i.Rear="REAR",i.Front="FRONT",i}(_||{}),A=function(i){return i.Uri="uri",i.Base64="base64",i.DataUrl="dataUrl",i}(A||{})},8162:(F,k,c)=>{c.d(k,{V1:()=>A,dk:()=>_.dk,oK:()=>_.oK});var p=c(2726),_=c(5961);const A=(0,p.fo)("Camera",{web:()=>c.e(6468).then(c.bind(c,6468)).then(i=>new i.CameraWeb)})},477:(F,k,c)=>{c.d(k,{$:()=>ce});var p=c(5861),_=c(9868),i=c(9468),ae=c(3857),y=c(1325),re=c(6052),se=c(797);let ce=(()=>{var I;class Q{constructor(o,a,g,e,h,d,T){this.lang=o,this.modalCtrl=a,this.alertCtrl=g,this.loadingCtrl=e,this.global=h,this.navParams=d,this.indexed=T,this.EventListenerAct=C=>{C.detail.register(130,P=>{})},this.WithoutSave=!0}ngOnInit(){}ionViewDidEnter(){var o=this;return(0,p.Z)(function*(){o.global.p5key.KeyShortCut.HistoryAct=a=>{switch(a){case"Z":o.p5voidDraw.history_act(-1);break;case"X":o.p5voidDraw.history_act(1);break;case"C":o.p5voidDraw.change_color();break;case"V":o.p5voidDraw.set_line_weight()}},o.global.p5key.KeyShortCut.AddAct=()=>{o.new_image()},o.global.p5key.KeyShortCut.DeleteAct=()=>{o.dismiss_draw()},o.global.p5key.KeyShortCut.SKeyAct=()=>{o.open_crop_tool()},document.addEventListener("ionBackButton",o.EventListenerAct),o.mainLoading=yield o.loadingCtrl.create({message:o.lang.text.voidDraw.UseThisImage}),o.create_new_canvas({width:o.navParams.data.width,height:o.navParams.data.height,path:o.navParams.data.path})})()}create_new_canvas(o){o.width=o.width||432,o.height=o.height||432,this.p5voidDraw&&this.p5voidDraw.remove(),this.create_p5voidDraw(o)}create_p5voidDraw(o){var a=this;let g=document.getElementById("voidDraw");this.p5voidDraw=new _(e=>{let h,d,T,C,P,O,U,ee=e.createColorPicker("#000"),G=!1,te=e.min(o.width,o.heigth),D=e.createSlider(1,te/10,te/100);e.setup=(0,p.Z)(function*(){D.parent(g),D.hide(),e.pixelDensity(1),e.noLoop(),e.noFill(),e.imageMode(e.CENTER),T=e.createCanvas(g.clientWidth,g.clientHeight),T.elt.addEventListener("contextmenu",r=>r.preventDefault()),T.parent(g),w.x=e.width/2,w.y=e.height/2,e.set_line_weight=()=>{G=!G,G?D.show():D.hide()},e.change_color=()=>{console.log("change_color")},e.save_image=()=>{new _(r=>{r.setup=()=>{r.createCanvas(h.width,h.height),r.pixelDensity(1),d&&r.image(d,0,0),h&&r.image(h,0,0),r.saveFrames("","png",1,1,L=>{let S=L[0].imageData.replace(/"|=|\\/g,"");a.modalCtrl.dismiss({name:`voidDraw_${r.year()}-${r.nf(r.month(),2)}-${r.nf(r.day(),2)}_${r.nf(r.hour(),2)}-${r.nf(r.minute(),2)}-${r.nf(r.second(),2)}.png`,img:S,loadingCtrl:a.mainLoading}),r.remove()})}})},e.history_act=r=>{switch(b=e.min(e.max(0,b+r),E.length),r){case 1:O.style.fill="var(--ion-color-dark)",b==E.length&&(U.style.fill="var(--ion-color-medium)"),K(h,E[b-1]);break;case-1:U.style.fill="var(--ion-color-dark)",b<1?(O.style.fill="var(--ion-color-medium)",h.background(255,0),e.redraw()):de()}},e.open_crop_tool=()=>{},C=e.createElement("table"),C.style("position: absolute; top: 0px;"),C.style(`width: 100%; height: ${m}px;`),C.style("background-color: var(--voidDraw-menu-background);"),C.parent(g);let t=C.elt.insertRow(0),n=t.insertCell(0);n.innerHTML='<ion-icon style="width: 27px; height: 27px" name="add"></ion-icon>',n.style.textAlign="center",n.style.cursor="pointer",n.onclick=()=>{a.new_image()};let l=t.insertCell(1);l.innerHTML='<ion-icon id="CropToolNotReady" style="width: 27px; height: 27px" name="crop"></ion-icon>',document.getElementById("CropToolNotReady").style.fill="var(--ion-color-medium)",l.style.textAlign="center",l.style.cursor="pointer",l.onclick=()=>{a.open_crop_tool()};let v=t.insertCell(2);v.innerHTML='<ion-icon style="width: 27px; height: 27px" name="checkmark"></ion-icon>',v.style.textAlign="center",v.style.cursor="pointer",v.onclick=()=>{a.dismiss_draw()},P=e.createElement("table"),P.style("position: absolute; bottom: 0px;"),P.style(`width: 100%; height: ${m}px;`),P.style("background-color: var(--voidDraw-menu-background);"),P.parent(g);let Y=P.elt.insertRow(0),Z=Y.insertCell(0);Z.innerHTML='<ion-icon id="undoIcon" style="width: 27px; height: 27px" name="arrow-undo"></ion-icon>',O=document.getElementById("undoIcon"),O.style.fill="var(--ion-color-medium)",Z.style.textAlign="center",Z.style.cursor="pointer",Z.onclick=()=>{a.p5voidDraw.history_act(-1)};let N=Y.insertCell(1);N.innerHTML='<ion-icon id="redoIcon" style="width: 27px; height: 27px" name="arrow-redo"></ion-icon>',U=document.getElementById("redoIcon"),U.style.fill="var(--ion-color-medium)",N.style.textAlign="center",N.style.cursor="pointer",N.onclick=()=>{a.p5voidDraw.history_act(1)};let J=Y.insertCell(2);ee.parent(J),J.style.textAlign="center",J.style.cursor="pointer";let $=Y.insertCell(3);if($.innerHTML='<ion-icon style="width: 27px; height: 27px" name="pencil"></ion-icon>',$.style.textAlign="center",$.style.cursor="pointer",$.onclick=()=>{a.change_line_weight()},e.SetCanvasViewportInit=()=>{T.hide(),e.resizeCanvas(g.clientWidth,g.clientHeight),V.x=e.width/2,V.y=e.height/2,w.x=0,w.y=0;let r=g.clientHeight-112;f=g.clientWidth/r<h.width/h.height?g.clientWidth/h.width:r/h.height,T.show(),D.position(e.width-D.width,e.height-D.height-m),e.redraw()},h=e.createGraphics(o.width,o.height,e.WEBGL),h.pixelDensity(1),h.noLoop(),h.noFill(),d=e.createGraphics(o.width,o.height,e.WEBGL),d.pixelDensity(1),d.noLoop(),d.noFill(),d.background(255),d.imageMode(e.CENTER),o.path){let r=yield a.indexed.loadBlobFromUserPath(o.path,""),L=URL.createObjectURL(r);e.loadImage(L,S=>{d.image(S,0,0),d.redraw(),URL.revokeObjectURL(L),e.SetCanvasViewportInit(),e.redraw()},S=>{console.error("\uadf8\ub9bc\ud310 \ubc30\uacbd \uc774\ubbf8\uc9c0 \ubd88\ub7ec\uc624\uae30 \uc624\ub958: ",S),d.redraw(),URL.revokeObjectURL(L)})}else d.redraw(),e.SetCanvasViewportInit(),e.redraw()});let w=e.createVector(),f=1,V=e.createVector(0,0),oe=e.createVector();e.draw=()=>{if(e.clear(255,255,255,255),e.push(),e.translate(V),e.scale(f),e.translate(w),d&&(d.push(),d.translate(oe),e.image(d,0,0),d.pop()),h&&(h.push(),h.translate(oe),e.image(h,0,0),h.pop()),s&&s.pos&&s.pos.length){e.push(),e.stroke(s.color),e.strokeWeight(s.weight),e.beginShape();for(let t=0,n=s.pos.length;t<n;t++)e.curveVertex(s.pos[t].x,s.pos[t].y);e.endShape(),e.pop()}e.pop()};let E=[],b=0,de=()=>{h.background(255,0);for(let t=b-1;t>=0;t--)K(h,E[t])},K=(t,n=s)=>{t.push(),t.stroke(n.color),t.strokeWeight(n.weight),t.beginShape();for(let l=0,v=n.pos.length;l<v;l++)t.curveVertex(n.pos[l].x,n.pos[l].y);t.endShape(),t.pop(),t.redraw(),e.redraw()};e.windowResized=()=>{setTimeout(()=>{e.SetCanvasViewportInit()},0)};let s={};const m=56;let j,R,ie,W,z=0,x=!1;e.mousePressed=t=>{if(e.mouseY<m||e.mouseY>e.height-m)x=!0;else switch(t.which){case 1:ne();break;case 3:R=e.createVector(e.mouseX,e.mouseY),W=w.copy(),j=e.createVector(e.mouseX,e.mouseY);break;case 2:e.SetCanvasViewportInit()}};let ne=(t,n)=>{O.style.fill="var(--ion-color-dark)",U.style.fill="var(--ion-color-medium)";let l=M(t,n),v={x:l.x,y:l.y};s={pos:[],color:ee.color(),weight:Number(D.value())},s.pos.push(v),s.pos.push(v),e.redraw()};e.mouseDragged=t=>{switch(t.which){case 1:let n=M();s&&s.pos.push({x:n.x,y:n.y}),e.redraw();break;case 3:j=e.createVector(e.mouseX,e.mouseY),w=W.copy().add(j.sub(R).div(f)),e.redraw()}},e.mouseWheel=t=>{e.mouseY<m||e.mouseY>e.height-m?x=!0:(ue(M()),f*=t.deltaY<0?1.1:.9,e.redraw())},e.mouseReleased=t=>{if(1===t.which&&!x){let n=M(),l={x:n.x,y:n.y};s&&(s.pos.push(l),s.pos.push(l)),le()}x=!1};let ue=t=>{V=e.createVector(e.mouseX,e.mouseY),w=t.mult(-1)},M=(t,n)=>{let l=e.createVector(t||e.mouseX,n||e.mouseY);return l.sub(V),l.div(f),l.sub(w),l},u=[],X=!1;e.touchStarted=t=>{if(u=t.touches,t.changedTouches[0].clientY<m||t.changedTouches[0].clientY>e.height-m)x=!0;else switch(X=!0,u.length){case 1:ne(t.changedTouches[0].clientX,t.changedTouches[0].clientY-m);break;case 2:let n=e.createVector(u[0].clientX,u[0].clientY-56),l=e.createVector(u[1].clientX,u[1].clientY-56);z=n.dist(l),R=n.copy().add(l).div(2),W=w.copy(),ie=f,s=void 0;break;default:X=!1,e.SetCanvasViewportInit()}},e.touchMoved=t=>{switch(u=t.touches,u.length){case 1:{let n=M(t.changedTouches[0].clientX,t.changedTouches[0].clientY-m);s&&s.pos.push({x:n.x,y:n.y}),e.redraw()}break;case 2:{let n=e.createVector(u[0].clientX,u[0].clientY-56),l=e.createVector(u[1].clientX,u[1].clientY-56),v=n.copy().add(l).div(2);f=n.dist(l)/z*ie,w=W.copy().add(v.sub(R).div(f)),e.redraw()}}return!1},e.touchEnded=t=>{if(t.changedTouches){switch(u=t.touches,X=!1,u.length){case 0:if(!x&&s){let n=M(t.changedTouches[0].clientX,t.changedTouches[0].clientY-m),l={x:n.x,y:n.y};s.pos.push(l),s.pos.push(l),le()}break;case 1:if(!X)return;ge(),z=0,s=void 0}x=!1}};let ge=()=>{R=e.createVector(u[0].clientX,u[0].clientY-56),W=w.copy()},le=()=>{if(E.length=b,E.push(s),K(h,s),E.length>16){let t=E.shift();K(d,t)}b=E.length,R=void 0,x=!1,s=void 0,e.redraw()}})}change_color(){this.p5voidDraw.change_color()}new_image(){this.alertCtrl.create({header:this.lang.text.voidDraw.newDraw,inputs:[{name:"width",type:"number",placeholder:`${this.lang.text.voidDraw.width} (${this.lang.text.voidDraw.default_size}: 432)`},{name:"height",type:"number",placeholder:`${this.lang.text.voidDraw.height} (${this.lang.text.voidDraw.default_size}: 432)`}],buttons:[{text:this.lang.text.voidDraw.CreateNew,handler:a=>{a.width=a.width?Number(a.width):432,a.height=a.height?Number(a.height):432,this.create_new_canvas(a)}}]}).then(a=>a.present())}change_line_weight(){this.p5voidDraw.set_line_weight()}open_crop_tool(){this.p5voidDraw.open_crop_tool()}dismiss_draw(){this.mainLoading.present(),this.WithoutSave=!1,this.p5voidDraw.save_image()}ionViewWillLeave(){delete this.global.p5key.KeyShortCut.HistoryAct,delete this.global.p5key.KeyShortCut.AddAct,delete this.global.p5key.KeyShortCut.DeleteAct,delete this.global.p5key.KeyShortCut.SKeyAct,this.p5voidDraw&&this.p5voidDraw.remove()}ionViewDidLeave(){document.removeEventListener("ionBackButton",this.EventListenerAct),this.WithoutSave&&this.mainLoading.remove()}}return(I=Q).\u0275fac=function(o){return new(o||I)(i.Y36(ae.b),i.Y36(y.IN),i.Y36(y.Br),i.Y36(y.HT),i.Y36(re.AN),i.Y36(y.X1),i.Y36(se.H))},I.\u0275cmp=i.Xpm({type:I,selectors:[["app-void-draw"]],decls:8,vars:1,consts:[[1,"ion-no-border"],["slot","start",3,"click"],["defaultHref",""],["id","voidDraw",1,"full_screen",2,"display","flex","overflow","hidden"]],template:function(o,a){1&o&&(i.TgZ(0,"ion-header",0)(1,"ion-toolbar")(2,"ion-title"),i._uU(3),i.qZA(),i.TgZ(4,"ion-buttons",1),i.NdJ("click",function(){return a.modalCtrl.dismiss()}),i._UZ(5,"ion-back-button",2),i.qZA()()(),i.TgZ(6,"ion-content"),i._UZ(7,"div",3),i.qZA()),2&o&&(i.xp6(3),i.Oqu(a.lang.text.ChatRoom.voidDraw))},dependencies:[y.oU,y.Sm,y.W2,y.Gu,y.wd,y.sr,y.cs]}),Q})()}}]);