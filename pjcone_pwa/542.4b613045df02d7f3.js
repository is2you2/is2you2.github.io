"use strict";(self.webpackChunkapp=self.webpackChunkapp||[]).push([[542],{1186:(z,A,s)=>{s.d(A,{M:()=>v});const v=(0,s(2726).fo)("SpeechRecognition",{web:()=>s.e(4850).then(s.bind(s,7554)).then(L=>new L.SpeechRecognitionWeb)})},5961:(z,A,s)=>{s.d(A,{GW:()=>v,dk:()=>L,oK:()=>D});var D=function(h){return h.Prompt="PROMPT",h.Camera="CAMERA",h.Photos="PHOTOS",h}(D||{}),v=function(h){return h.Rear="REAR",h.Front="FRONT",h}(v||{}),L=function(h){return h.Uri="uri",h.Base64="base64",h.DataUrl="dataUrl",h}(L||{})},8162:(z,A,s)=>{s.d(A,{V1:()=>L,dk:()=>v.dk,oK:()=>v.oK});var D=s(2726),v=s(5961);const L=(0,D.fo)("Camera",{web:()=>s.e(6468).then(s.bind(s,6468)).then(h=>new h.CameraWeb)})},477:(z,A,s)=>{s.d(A,{$:()=>se});var D=s(5861),v=s(9868),h=s(3641),c=s(9468),ae=s(3857),y=s(1325),re=s(6052),le=s(797);let se=(()=>{var O;class Q{constructor(t,n,m,e,o,d,p){this.lang=t,this.modalCtrl=n,this.alertCtrl=m,this.loadingCtrl=e,this.global=o,this.navParams=d,this.indexed=p,this.initialized=!1,this.EventListenerAct=T=>{T.detail.register(130,M=>{})},this.WithoutSave=!0}ngOnInit(){}ionViewDidEnter(){var t=this;return(0,D.Z)(function*(){t.global.p5key.KeyShortCut.HistoryAct=n=>{switch(n){case"Z":t.act_history(-1);break;case"X":t.act_history(1);break;case"C":t.p5voidDraw.change_color();break;case"V":t.p5voidDraw.set_line_weight()}},t.global.p5key.KeyShortCut.AddAct=()=>{t.new_image()},t.global.p5key.KeyShortCut.DeleteAct=()=>{t.dismiss_draw()},t.global.p5key.KeyShortCut.SKeyAct=()=>{t.open_crop_tool()},document.addEventListener("ionBackButton",t.EventListenerAct),t.mainLoading=yield t.loadingCtrl.create({message:t.lang.text.voidDraw.UseThisImage}),t.create_new_canvas({width:t.navParams.data.width,height:t.navParams.data.height,path:t.navParams.data.path})})()}create_new_canvas(t){t.width=t.width||432,t.height=t.height||432,this.p5voidDraw&&this.p5voidDraw.remove(),this.create_p5voidDraw(t)}create_p5voidDraw(t){var n=this;let m=document.getElementById("voidDraw");this.p5voidDraw=new v(e=>{let o,d,p,T,M,I,U,ee=e.createColorPicker("#000"),G=!1,te=e.min(t.width,t.heigth),P=e.createSlider(1,te/10,te/100);const ce="Android"==h.n$||"iOS"==h.n$?.6:1;e.setup=(0,D.Z)(function*(){P.parent(m),P.hide(),e.pixelDensity(ce),e.smooth(),e.noLoop(),e.imageMode(e.CENTER),d=void 0,o&&o.remove(),o=void 0,p&&e.remove(),p=e.createCanvas(m.clientWidth,m.clientHeight),p.elt.addEventListener("contextmenu",l=>l.preventDefault()),w.x=e.width/2,w.y=e.height/2,p.parent(m),e.set_line_weight=()=>{G=!G,G?P.show():P.hide()},e.change_color=()=>{console.log("change_color")},e.save_image=()=>{new v(l=>{l.setup=()=>{l.createCanvas(o.width,o.height),d&&l.image(d,0,0),o&&l.image(o,0,0),l.saveFrames("","png",1,1,C=>{let _=C[0].imageData.replace(/"|=|\\/g,"");n.modalCtrl.dismiss({name:`voidDraw_${l.year()}-${l.nf(l.month(),2)}-${l.nf(l.day(),2)}_${l.nf(l.hour(),2)}-${l.nf(l.minute(),2)}-${l.nf(l.second(),2)}.png`,img:_,loadingCtrl:n.mainLoading}),l.remove()})}})},e.history_act=l=>{switch(b=e.min(e.max(0,b+l),f.length),l){case 1:I.style.fill="var(--ion-color-dark)",b==f.length&&(U.style.fill="var(--ion-color-medium)");for(let C=0,_=f[b-1].pos.length-W+1;C<_;C++)Y(f[b-1],C);break;case-1:U.style.fill="var(--ion-color-dark)",b<1?(I.style.fill="var(--ion-color-medium)",o.background(255,0),e.redraw()):he()}},e.open_crop_tool=()=>{},T=e.createElement("table"),T.style("position: absolute; top: 0px;"),T.style(`width: 100%; height: ${u}px;`),T.style("background-color: var(--voidDraw-menu-background);"),T.parent(m);let i=T.elt.insertRow(0),r=i.insertCell(0);r.innerHTML='<ion-icon style="width: 27px; height: 27px" name="add"></ion-icon>',r.style.textAlign="center",r.style.cursor="pointer",r.onclick=()=>{n.new_image()};let a=i.insertCell(1);a.innerHTML='<ion-icon id="CropToolNotReady" style="width: 27px; height: 27px" name="crop"></ion-icon>',document.getElementById("CropToolNotReady").style.fill="var(--ion-color-medium)",a.style.textAlign="center",a.style.cursor="pointer",a.onclick=()=>{n.open_crop_tool()};let k=i.insertCell(2);k.innerHTML='<ion-icon style="width: 27px; height: 27px" name="checkmark"></ion-icon>',k.style.textAlign="center",k.style.cursor="pointer",k.onclick=()=>{n.dismiss_draw()},M=e.createElement("table"),M.style("position: absolute; bottom: 0px;"),M.style(`width: 100%; height: ${u}px;`),M.style("background-color: var(--voidDraw-menu-background);"),M.parent(m);let x=M.elt.insertRow(0),$=x.insertCell(0);$.innerHTML='<ion-icon id="undoIcon" style="width: 27px; height: 27px" name="arrow-undo"></ion-icon>',I=document.getElementById("undoIcon"),I.style.fill="var(--ion-color-medium)",$.style.textAlign="center",$.style.cursor="pointer",$.onclick=()=>{n.act_history(-1)};let X=x.insertCell(1);X.innerHTML='<ion-icon id="redoIcon" style="width: 27px; height: 27px" name="arrow-redo"></ion-icon>',U=document.getElementById("redoIcon"),U.style.fill="var(--ion-color-medium)",X.style.textAlign="center",X.style.cursor="pointer",X.onclick=()=>{n.act_history(1)};let J=x.insertCell(2);ee.parent(J),J.style.textAlign="center",J.style.cursor="pointer";let Z=x.insertCell(3);if(Z.innerHTML='<ion-icon style="width: 27px; height: 27px" name="pencil"></ion-icon>',Z.style.textAlign="center",Z.style.cursor="pointer",Z.onclick=()=>{n.change_line_weight()},e.SetCanvasViewportInit=()=>{p.hide(),e.resizeCanvas(m.clientWidth,m.clientHeight),B.x=e.width/2,B.y=e.height/2,w.x=0,w.y=0;let l=m.clientHeight-112;E=m.clientWidth/l<o.width/o.height?m.clientWidth/o.width:l/o.height,p.show(),P.position(e.width-P.width,e.height-P.height-u),e.redraw()},o=e.createGraphics(t.width,t.height,e.WEBGL),o.smooth(),o.noLoop(),o.noFill(),t.path){let l=yield n.indexed.loadBlobFromUserPath(t.path,""),C=URL.createObjectURL(l);e.loadImage(C,_=>{o.resizeCanvas(_.width,_.height),d=e.createGraphics(_.width,_.height,e.WEBGL),d.noLoop(),d.background(255),d.imageMode(e.CENTER),d.image(_,0,0),URL.revokeObjectURL(C),e.SetCanvasViewportInit(),e.redraw()},_=>{console.error("\uadf8\ub9bc\ud310 \ubc30\uacbd \uc774\ubbf8\uc9c0 \ubd88\ub7ec\uc624\uae30 \uc624\ub958: ",_),URL.revokeObjectURL(C)})}else d=e.createGraphics(t.width,t.height,e.WEBGL),d.noLoop(),d.background(255),e.SetCanvasViewportInit(),e.redraw();n.initialized=!0});let w=e.createVector(),E=1,B=e.createVector(0,0),ie=e.createVector();e.draw=()=>{e.clear(255,255,255,255),e.push(),e.translate(B),e.scale(E),e.translate(w),d&&(d.push(),d.translate(ie),e.image(d,0,0),d.pop()),o&&(o.push(),o.translate(ie),e.image(o,0,0),o.pop()),e.pop()};let f=[],b=0,he=()=>{o.background(255,0);for(let i=b-1;i>=0;i--)for(let r=0,a=f[i].pos.length-W+1;r<a;r++)Y(f[i],r)};const W=2;let Y=(i=R,r=i.pos.length-W)=>{let a=i.pos.slice(r,r+W);o.push(),o.stroke(i.color),o.strokeWeight(i.weight),o.line(a[0].x,a[0].y,a[1].x,a[1].y),o.pop(),o.redraw(),e.redraw()};e.windowResized=()=>{setTimeout(()=>{e.SetCanvasViewportInit()},0)};let R={};const u=56;let F,S,oe,V,j=0;e.mousePressed=i=>{if(!(e.mouseY<u||e.mouseY>e.height-u))switch(i.which){case 1:ne();break;case 3:S=e.createVector(e.mouseX,e.mouseY),V=w.copy(),F=e.createVector(e.mouseX,e.mouseY);break;case 2:e.SetCanvasViewportInit()}};let ne=(i,r)=>{f.length>b&&(f.length=b),I.style.fill="var(--ion-color-dark)",U.style.fill="var(--ion-color-medium)";let a=N(i,r),k={x:a.x,y:a.y};R={pos:[],color:ee.color(),weight:Number(P.value())};for(let x=0;x<W;x++)R.pos.push(k);f.push(R),b=f.length,Y()};e.mouseDragged=i=>{if(!(e.mouseY<u||e.mouseY>e.height-u))switch(i.which){case 1:let r=N();R.pos.push({x:r.x,y:r.y}),Y();break;case 3:F=e.createVector(e.mouseX,e.mouseY),w=V.copy().add(F.sub(S).div(E)),e.redraw()}},e.mouseWheel=i=>{e.mouseY<u||e.mouseY>e.height-u||(de(N()),E*=i.deltaY<0?1.1:.9,e.redraw())};let de=i=>{B=e.createVector(e.mouseX,e.mouseY),w=i.mult(-1)},N=(i,r)=>{let a=e.createVector(i||e.mouseX,r||e.mouseY);return a.sub(B),a.div(E),a.sub(w),a},g=[],K=!1;e.touchStarted=i=>{if(g=i.touches,!(i.changedTouches[0].clientY<u||i.changedTouches[0].clientY>e.height-u))switch(K=!0,g.length){case 1:ne(i.changedTouches[0].clientX,i.changedTouches[0].clientY-u);break;case 2:let r=e.createVector(g[0].clientX,g[0].clientY-56),a=e.createVector(g[1].clientX,g[1].clientY-56);j=r.dist(a),S=r.copy().add(a).div(2),V=w.copy(),oe=E,f.pop();break;default:K=!1,e.SetCanvasViewportInit()}},e.touchMoved=i=>{if(g=i.touches,!(!K||i.changedTouches[0].clientY<u||i.changedTouches[0].clientY>e.height-u)){switch(g.length){case 1:{let r=N(i.changedTouches[0].clientX,i.changedTouches[0].clientY-u);R.pos.push({x:r.x,y:r.y}),Y()}break;case 2:{let r=e.createVector(g[0].clientX,g[0].clientY-56),a=e.createVector(g[1].clientX,g[1].clientY-56),k=r.copy().add(a).div(2);E=r.dist(a)/j*oe,w=V.copy().add(k.sub(S).div(E)),e.redraw()}}return!1}},e.touchEnded=i=>{if(i.changedTouches)switch(g=i.touches,K=!1,g.length){case 0:ue();break;case 1:if(!K)return;ge(),j=0}};let ge=()=>{S=e.createVector(g[0].clientX,g[0].clientY-56),V=w.copy()},ue=()=>{S=void 0}})}change_color(){this.initialized&&this.p5voidDraw.change_color()}new_image(){if(!this.initialized)return;this.alertCtrl.create({header:this.lang.text.voidDraw.newDraw,inputs:[{name:"width",type:"number",placeholder:`${this.lang.text.voidDraw.width} (${this.lang.text.voidDraw.default_size}: 432)`},{name:"height",type:"number",placeholder:`${this.lang.text.voidDraw.height} (${this.lang.text.voidDraw.default_size}: 432)`}],buttons:[{text:this.lang.text.voidDraw.CreateNew,handler:n=>{n.width=n.width?Number(n.width):432,n.height=n.height?Number(n.height):432,this.create_new_canvas(n)}}]}).then(n=>n.present())}change_line_weight(){this.initialized&&this.p5voidDraw.set_line_weight()}act_history(t){this.p5voidDraw.history_act(t)}open_crop_tool(){this.initialized&&this.p5voidDraw.open_crop_tool()}dismiss_draw(){this.mainLoading.present(),this.WithoutSave=!1,this.p5voidDraw.save_image()}ionViewWillLeave(){delete this.global.p5key.KeyShortCut.HistoryAct,delete this.global.p5key.KeyShortCut.AddAct,delete this.global.p5key.KeyShortCut.DeleteAct,delete this.global.p5key.KeyShortCut.SKeyAct,this.p5voidDraw&&this.p5voidDraw.remove()}ionViewDidLeave(){document.removeEventListener("ionBackButton",this.EventListenerAct),this.indexed.removeFileFromUserPath("tmp_files/modify_image.png"),this.WithoutSave&&this.mainLoading.remove()}}return(O=Q).\u0275fac=function(t){return new(t||O)(c.Y36(ae.b),c.Y36(y.IN),c.Y36(y.Br),c.Y36(y.HT),c.Y36(re.AN),c.Y36(y.X1),c.Y36(le.H))},O.\u0275cmp=c.Xpm({type:O,selectors:[["app-void-draw"]],decls:8,vars:1,consts:[[1,"ion-no-border"],["slot","start",3,"click"],["defaultHref",""],["id","voidDraw",1,"full_screen",2,"display","flex","overflow","hidden"]],template:function(t,n){1&t&&(c.TgZ(0,"ion-header",0)(1,"ion-toolbar")(2,"ion-title"),c._uU(3),c.qZA(),c.TgZ(4,"ion-buttons",1),c.NdJ("click",function(){return n.modalCtrl.dismiss()}),c._UZ(5,"ion-back-button",2),c.qZA()()(),c.TgZ(6,"ion-content"),c._UZ(7,"div",3),c.qZA()),2&t&&(c.xp6(3),c.Oqu(n.lang.text.ChatRoom.voidDraw))},dependencies:[y.oU,y.Sm,y.W2,y.Gu,y.wd,y.sr,y.cs]}),Q})()}}]);